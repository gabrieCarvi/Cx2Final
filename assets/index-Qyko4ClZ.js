import{i as ja,g as Hs,a as fa,r as a,o as Na,j as e,c as va,s as Ws,G as Js,b as Ys,u as Zs,d as ya,L as Te,N as wa,P as is,e as W,f as He,h as ve,k as re,q as _e,w as Oe,l as Pe,m as Ve,n as ye,p as Ge,t as B,v as De,x as le,y as Ie,z as Me,A as Re,B as je,C as Ne,D as cs,E as ds,F as ms,H as us,I as Qs,J as hs,K as xs,M as Xs,O as bs,Q as ps,S as Ks,R as gs,T as es,U as js,V as fs,W as Be,X as Ca,Y as Ps,Z as Sa,_ as ka,$ as fe,a0 as _a}from"./vendor-CBz41kXd.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const Ea={apiKey:"AIzaSyDtO6GisGJP6gtbtTz3Gmdz0cGyp-id46w",authDomain:"tics-cc-2024.firebaseapp.com",projectId:"tics-cc-2024",storageBucket:"tics-cc-2024.appspot.com",messagingSenderId:"345093255804",appId:"1:345093255804:web:9c763d8852934fef7a8ff9"},Ns=ja(Ea),Xe=Hs(Ns),D=fa(Ns),ss=a.createContext(),Fa=({children:s})=>{const[l,t]=a.useState(null),[n,i]=a.useState(!0);return a.useEffect(()=>{const r=localStorage.getItem("user");r&&(t(JSON.parse(r)),i(!1));const o=Na(Xe,d=>{if(d){const g={email:d.email};localStorage.setItem("user",JSON.stringify(g)),t(g)}else localStorage.removeItem("user"),t(null);i(!1)});return()=>o()},[]),e.jsx(ss.Provider,{value:{currentUser:l,loading:n},children:s})},Da=()=>a.useContext(ss),oe=({leyendaSet:s="Cx2"})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"spinner-overlay d-flex flex-column justify-content-center align-items-center",children:[e.jsx("p",{className:"text-white display-4 mb-4",children:s}),e.jsxs("div",{className:"loader-bars",children:[e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{})]})]})});function Aa({setIsLogin:s}){const l=Hs(Ns),[t,n]=a.useState(""),[i,r]=a.useState(!1),[o,d]=a.useState(""),[g,x]=a.useState("");function m(b){const h=["gmail.com","hotmail.com","outlook.com","live.com","msn.com","santafe.gov.ar"],f=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,v=b.split("@")[1];return f.test(b)&&h.includes(v)}function j(b){return b.length>=6}async function u(b){if(b.preventDefault(),!m(o)){n("Por favor, utiliza un correo válido de Gmail o Microsoft (Outlook, Hotmail, Live, Santa fe ).");return}if(!j(g)){n("La contraseña debe tener al menos 6 caracteres.");return}r(!0);try{const f=(await va(l,o,g)).user;console.log("Registro exitoso:",f),alert("Registro exitoso"),d(""),x(""),n(""),await Ws(l),console.log("Sesión cerrada después del registro."),s(!0)}catch(h){p(h)}finally{r(!1)}}function p(b){switch(b.code){case"auth/email-already-in-use":n("La dirección de correo electrónico ya está en uso.");break;case"auth/invalid-email":n("Tu dirección de correo electrónico no es válida.");break;case"auth/weak-password":n("Tu contraseña es muy débil - debe tener al menos 6 caracteres.");break;default:n("Oooops, algo salió mal :(")}}const c=async()=>{r(!0);const b=new Js;try{const f=(await Ys(l,b)).user;alert(`Inicio de sesión con Google exitoso. Bienvenido ${f.displayName||f.email}`),navigate("/dashboard")}catch(h){console.error("Error al iniciar sesión con Google:",h),n("No se pudo iniciar sesión con Google.")}finally{r(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:u,className:"form-container  my-2",action:"#!",id:"registerForm",children:[i&&e.jsx(oe,{}),e.jsxs("div",{className:"row gy-3 gy-md-4 my-4",children:[e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{htmlFor:"registerEmail",className:"form-label text-capitalize",children:["Ingresa tu correo electrónico ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",id:"registerEmail",name:"email",className:"form-control",value:o,onChange:b=>d(b.target.value),autoComplete:"off",required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{htmlFor:"registerPassword",className:"form-label text-capitalize",children:["Ingresa tu Contraseña ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"password",id:"registerPassword",name:"password",className:"form-control text-capitalize",value:g,onChange:b=>x(b.target.value),autoComplete:"off",required:!0})]}),e.jsx("div",{className:"col-12 text-center",children:t&&e.jsx("span",{className:"error text-danger",role:"alert","aria-live":"assertive",children:t})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"d-grid",children:e.jsx("button",{className:"btn btn-purpleUi fw-semibold fs-6 rounded-3 shadow",type:"submit",id:"submitBtnRegistrar",disabled:i,children:"Registrar usuario"})})})]})]}),e.jsxs("div",{className:"col-12 mb-5",children:[e.jsx("hr",{className:"border-purple border-2 rounded-3"}),e.jsxs("div",{className:"d-flex gap-2 gap-md-4 flex-column flex-md-row justify-content-md-center",children:[e.jsx("button",{type:"button",className:"btn bg-secondaryMuiRed bg-opacity-75 fs-6 rounded-3 shadow-sm text-light",onClick:()=>s(!0),children:"Regresar"}),e.jsx("button",{type:"button",className:"btn bg-dark bg-opacity-50 fs-6 rounded-3 text-light ",onClick:c,children:"Iniciar sesión con Google"})]})]})]})}function Ma({setIsLogin:s}){const{currentUser:l,loading:t}=a.useContext(ss),n=Zs(),[i,r]=a.useState(""),[o,d]=a.useState(""),[g,x]=a.useState(""),[m,j]=a.useState(!1);a.useEffect(()=>{l&&setTimeout(()=>{n("/dashboard")},1e3)},[l,n]);const u=async h=>{if(h.preventDefault(),!i||!o){x("Por favor, complete todos los campos.");return}if(!p(i)){x("Por favor, ingrese un correo electrónico válido.");return}if(o.length<6){x("La contraseña debe tener al menos 6 caracteres.");return}j(!0);try{const v=(await ya(Xe,i,o)).user;alert(`Inicio de sesión exitoso. Bienvenido ${v.email}`)}catch(f){c(f)}finally{j(!1)}};function p(h){const f=["gmail.com","hotmail.com","outlook.com","live.com","msn.com","santafe.gov.ar"],v=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,N=h.split("@")[1];return v.test(h)&&f.includes(N)}const c=h=>{switch(h.code){case"auth/wrong-password":x("La contraseña es incorrecta.");break;case"auth/user-not-found":x("No hay usuario registrado con este correo.");break;case"auth/invalid-email":x("El correo electrónico no es válido.");break;default:x("Oooops, algo salió mal :(")}},b=async()=>{j(!0);const h=new Js;try{const v=(await Ys(Xe,h)).user;alert(`Inicio de sesión con Google exitoso. Bienvenido ${v.displayName||v.email}`),n("/dashboard")}catch(f){console.error("Error al iniciar sesión con Google:",f),x("No se pudo iniciar sesión con Google.")}finally{j(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:u,className:"form-container  my-4",children:[m&&e.jsx(oe,{leyendaSet:"Cx2"}),e.jsxs("div",{className:"row gy-3 gy-md-4 my-1",children:[e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{htmlFor:"username",className:"form-label text-capitalize",children:["Usuario ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",id:"username",className:"form-control",name:"username",value:i,onChange:h=>r(h.target.value),autoComplete:"off",required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("label",{htmlFor:"password",className:"form-label",children:["Contraseña ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"password",id:"password",className:"form-control",name:"password",value:o,onChange:h=>d(h.target.value),autoComplete:"off",required:!0})]}),e.jsx("div",{className:"col-12 text-center",children:g&&e.jsx("span",{className:"error text-danger",role:"alert","aria-live":"assertive",children:g})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"d-grid",children:e.jsx("button",{className:"btn btn-purpleUi fw-semibold fs-6 rounded-3 shadow ",type:"submit",disabled:m,children:m?"Cargando...":"Iniciar sesión"})})})]})]}),e.jsxs("div",{className:"col-12 mb-5",children:[e.jsx("hr",{className:" border-purple border-2 rounded-3"}),e.jsxs("div",{className:"d-flex gap-2 gap-md-4 flex-column flex-md-row justify-content-md-center",children:[e.jsx("button",{type:"button",className:"btn bg-primary bg-opacity-75 fs-6 rounded-3 shadow-sm text-light",onClick:()=>s(!1),children:"Crear Cuenta"}),e.jsxs("button",{type:"button",className:"btn bg-dark bg-opacity-50 fs-6 rounded-3 text-light ",onClick:b,children:["Iniciar sesión con Google ",e.jsx("i",{className:"bi bi-google text-ligt mx-1"})]})]})]})]})}const Pa=()=>{const[s,l]=a.useState(!0);return e.jsx("div",{className:"d-flex justify-content-center align-items-center vh-100",children:e.jsx("div",{className:"container px-2",children:e.jsx("div",{className:"card border-1 border-secondary shadow-sm rounded-4 overflow-hidden",children:e.jsxs("div",{className:"row ",children:[e.jsx("div",{className:"col-12 col-md-6 gradient-login p-4 d-flex align-items-center justify-content-center flex-column position-relative",children:e.jsxs("div",{className:"text-center animate__animated animate__fadeInDown",children:[e.jsx("div",{className:"d-flex justify-content-center d-none d-md-flex ",children:e.jsx("div",{className:"phone-frame bg-black rounded-4 p-2 shadow",children:e.jsxs("div",{className:"bg-white rounded-4 d-flex flex-column align-items-center pt-4 position-relative",style:{height:"100%"},children:[e.jsx("div",{className:"rounded-circle bg-gradiante2 d-flex align-items-center justify-content-center text-white fw-bold fs-3",style:{width:"80px",height:"80px"},children:e.jsx("span",{className:"shake fs-1  ",children:"🔍"})}),e.jsx("div",{className:"mt-1 fw-semibold text-dark",children:"Iniciar App"}),e.jsx("div",{className:"card text-center shadow-sm border-0 mt-5",style:{width:"14rem",borderRadius:"1rem"},children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title mb-2 p-2 text-light bg-indigo bg-opacity-75 rounded-4 shadow",style:{fontSize:"1.5rem"},children:["Cx2 App ",e.jsx("span",{className:"titilar",children:"_"})]}),e.jsx("p",{className:"card-text text-muted",style:{fontSize:"0.75rem"},children:"Direccion General OJO UR II"})]})}),e.jsxs("div",{className:"position-absolute text-center text-muted",style:{bottom:"40px",padding:"0 1rem",fontSize:"0.75rem"},children:[e.jsx("img",{className:"pt-3 my-1",loading:"lazy",src:"/img/logo-login-2024.png",width:"85",height:"45",alt:"Marca fondo blanco"}),e.jsx("div",{style:{fontSize:"0.65rem"},children:'"La seguridad se construye con datos."'})]})]})})}),e.jsxs("div",{className:"d-none d-md-block",children:[e.jsx("p",{className:"text-center fs-6 animate__animated animate__fadeIn text-light mb-1 mt-3",children:e.jsx("span",{children:"Policía de la Provincia de Santa Fe"})}),e.jsxs("div",{className:"text-center text-light small mb-2",children:[e.jsx("small",{children:"Versión: 1.0.0"})," | ",e.jsx("small",{children:"Fecha: 20/05/2025"})," | ",e.jsx("small",{children:"Desktop"})]})]}),e.jsxs("div",{className:"d-block d-md-none text-center text-light mt-3 mb-2",children:[e.jsxs("h1",{className:"fw-bold display-1 p-3 text-light bg-dark bg-opacity-50 rounded-4 shadow",children:[" Cx2  ",e.jsx("span",{className:"titilar",children:" _"})]}),e.jsxs("div",{className:"text-center text-light small mb-2",children:[e.jsx("small",{children:"Versión: 1.0.0"})," | ",e.jsx("small",{children:"Fecha: 20/05/2025"})," | ",e.jsx("small",{children:"Movil"})]})]})]})}),e.jsx("div",{className:"col-12  col-md-6 bg-white",children:e.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center h-100 w-100 w-md-75 mx-auto px-3 mt-4 mt-md-5",children:[e.jsx("h2",{className:"text-center fw-bold ",children:s?"Iniciar Sesión":"Crear Cuenta"}),s?e.jsx(Ma,{setIsLogin:l}):e.jsx(Aa,{setIsLogin:l})]})})]})})})})};function Ia(){return e.jsx("div",{id:"loginShowDivId",className:"d-flex justify-content-center align-items-center h-100",style:{minHeight:"100vh"},children:e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"login-rectangulo w-100",children:e.jsxs("div",{className:"login-texto-p p-5",children:[e.jsx("p",{className:"login-texto-p-parrafo1 lh-1 pt-5 text-white m-0",children:"Santa Fe"}),e.jsx("p",{className:"login-texto-p-parrafo2 lh-1 text-white m-0",children:"Provincia"})]})})})})}const La=()=>{const[s,l]=a.useState(!0);return a.useEffect(()=>{const t=setTimeout(()=>{l(!1)},3e3);return()=>clearTimeout(t)},[]),e.jsx(e.Fragment,{children:s?e.jsx(Ia,{}):e.jsx("div",{className:"container-lg",id:"homeContainer",children:e.jsx(Pa,{})})})},$a=()=>e.jsx("div",{className:"bg-primary Gradiante25 min-vh-100 d-flex justify-content-center align-items-center text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("h1",{className:"display-4 fw-bold",children:"Bienvenido a Santa Fe"}),e.jsx("p",{className:"lead",children:"Descubrí todo lo que nuestra provincia tiene para ofrecer, ¡explorá nuestras funcionalidades y novedades!"}),e.jsx(Te,{to:"/about",className:"btn btn-outline-light mt-3",children:"Saber más"})]})}),Se=({children:s})=>{const{currentUser:l,loading:t}=Da();return t?e.jsx(oe,{}):l?s:e.jsx(wa,{to:"/"})},Ra=()=>e.jsx("div",{className:"container-fluid d-flex align-items-center justify-content-center text-center py-5 bg-white",style:{height:"100vh"},children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-capitalize text-secondary fs-1 fw-semibold",children:"Error 404"}),e.jsx("h5",{className:"text-capitalize text-secondary",children:"La página solicitada no funciona"}),e.jsx("img",{src:"/gif/dribbble_1.gif",alt:"error",className:"img-fluid my-3",style:{maxHeight:"700px"}})]})}),we=({data1:s,data2:l,data3:t})=>{const n=s||"© 2025 Tics | Dg OJO",i=l||"Cx2",r=t||"Policía de Santa Fe";return e.jsx("div",{className:"container-lg text-center py-5",children:e.jsxs("footer",{className:"d-flex flex-wrap justify-content-between align-items-center pt-3 border-top",children:[e.jsx("p",{className:"col-md-4 mb-0 text-white",children:n}),e.jsx("a",{href:"/",className:"col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto text-decoration-none d-none d-md-block","aria-label":"Inicio",children:e.jsx("img",{className:"opacity-50",src:"/img/Escudo Pol SF Color Original_BN.png",width:"35",height:"32",alt:"Escudo Policía Santa Fe"})}),e.jsx("ul",{className:"nav col-md-4 justify-content-center text-light",children:e.jsxs("li",{className:"nav-item",children:[e.jsx("strong",{children:i})," / ",e.jsx("strong",{children:r})]})})]})})};we.propTypes={data1:is.string,data2:is.string,data3:is.string};const za={nombre:"Santa Fe Tema",valor:"linear-gradient(45deg, #ec4899, #8b5cf6, #0d6efd)",tipo:"gradiente"},Ta=[{nombre:"🎨 Santa Fe Theme",valor:"linear-gradient(45deg, #ec4899, #8b5cf6, #0d6efd)"},{nombre:"🎨 Santa Fe Theme 2",valor:"linear-gradient(135deg, #ec4899, #8b5cf6)"},{nombre:"🎨 Santa Fe Theme 3",valor:"linear-gradient(45deg, #ec4899, #8b5cf6,rgba(0, 204, 255, 0.7), #0d6efd)"},{nombre:"🪵 Rustic Tones",valor:"linear-gradient(135deg, #c79081 0%, #dfa579 100%)"},{nombre:"🦄 Unicorn Light",valor:"linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%)"},{nombre:"☀️ Amanecer",valor:"linear-gradient(135deg, #f6d365, #fda085)"},{nombre:"🌌 Noche Estrellada",valor:"linear-gradient(135deg, #2c3e50, #4ca1af)"},{nombre:"🌿 Bosque Vivo",valor:"linear-gradient(135deg, #56ab2f, #a8e063)"},{nombre:"🔥 Fuego Solar",valor:"linear-gradient(135deg, #ff416c, #ff4b2b)"},{nombre:"💧 Azul Oceánico",valor:"linear-gradient(135deg, #2193b0, #6dd5ed)"},{nombre:"🌇 Atardecer",valor:"linear-gradient(135deg, #e96443, #904e95)"},{nombre:"🌈 Prisma",valor:"linear-gradient(135deg, #f953c6, #b91d73)"},{nombre:"🧊 Hielo Azul",valor:"linear-gradient(135deg, #83a4d4, #b6fbff)"},{nombre:"☕ Café Tostado",valor:"linear-gradient(135deg, #b79891, #94716b)"},{nombre:"🌻 Campo Amarillo",valor:"linear-gradient(135deg, #f7971e, #ffd200)"},{nombre:"🌪 Tormenta Gris",valor:"linear-gradient(135deg, #bdc3c7, #2c3e50)"},{nombre:"🌸 Flor de Cerezo",valor:"linear-gradient(135deg, #fbc2eb, #a6c1ee)"},{nombre:"🌊 Costa Brava",valor:"linear-gradient(135deg, #00c6ff, #0072ff)"},{nombre:"🍂 Otoño Cálido",valor:"linear-gradient(135deg, #d38312, #a83279)"},{nombre:"🪐 Galaxia",valor:"linear-gradient(135deg, #654ea3, #eaafc8)"},{nombre:"🌟 Estrella Dorada",valor:"linear-gradient(135deg, #f6d365, #fda085)"},{nombre:"🏔 Rocas Frías",valor:"linear-gradient(135deg, #e0eafc, #cfdef3)"},{nombre:"🎆 Noche Festiva",valor:"linear-gradient(135deg, #fc466b, #3f5efb)"},{nombre:"🍃 Naturaleza",valor:"linear-gradient(135deg, #11998e, #38ef7d)"},{nombre:"💦 Celeste Aqua",valor:"#16B1FF"},{nombre:"🔮 Violeta Mágico",valor:"#8C57FF"},{nombre:"🍊 Naranja Fuego",valor:"#ff8f00"},{nombre:"🍇 Púrpura Uva",valor:"#7e57c2"},{nombre:"💙 Azul Profundo",valor:"#3c3ae5"},{nombre:"🌿 Verde Menta",valor:"#03dac6"},{nombre:"🍵 Verde Té",valor:"#20c997"},{nombre:"🧪 Verde Neón",valor:"#05F2D4"},{nombre:"🚨 Rojo Alerta",valor:"#f50057"},{nombre:"🪨 Gris Urbano",valor:"#757575"},{nombre:"🌫️ Gris Niebla",valor:"#f9f9f983"},{nombre:"🌌 Negro Noche",valor:"#212121"}],Ee=({setThemeBackgroundColor:s})=>{const[l,t]=a.useState(!1),[n,i]=a.useState(()=>localStorage.getItem("theme")==="dark"),[r,o]=a.useState(()=>localStorage.getItem("bgColor")||za.valor),d=x=>{t(!0),i(x==="dark"),localStorage.setItem("theme",x),setTimeout(()=>t(!1),500)},g=x=>{o(x),s(x),localStorage.setItem("bgColor",x)};return a.useEffect(()=>{const x=n?"dark":"light";document.body.setAttribute("data-bs-theme",x)},[n]),a.useEffect(()=>{s(r)},[r,s]),e.jsxs("div",{children:[l&&e.jsx(oe,{}),e.jsxs("div",{className:"dropdown position-fixed bottom-0 end-0 mb-3 me-3 bd-mode-toggle",children:[e.jsxs("button",{className:"btn btn-greenUi py-2 dropdown-toggle d-flex align-items-center rounded-4",id:"bd-theme",type:"button","aria-expanded":"false","data-bs-toggle":"dropdown","aria-label":"Toggle theme",children:[e.jsx("i",{className:n?"bi bi-moon-stars-fill":"bi bi-brightness-high-fill"}),e.jsx("span",{className:"visually-hidden",id:"bd-theme-text",children:"Toggle theme"})]}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end shadow","aria-labelledby":"bd-theme-text",children:[e.jsx("li",{children:e.jsxs("button",{type:"button",className:`dropdown-item d-flex align-items-center ${n?"":"active"}`,onClick:()=>d("light"),children:[e.jsx("i",{className:"bi bi-brightness-high-fill me-2 opacity-50"}),"Modo Luz"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",className:`dropdown-item d-flex align-items-center ${n?"active":""}`,onClick:()=>d("dark"),children:[e.jsx("i",{className:"bi bi-moon-stars-fill me-2 opacity-50"}),"Modo Nocturno"]})}),e.jsx("li",{children:e.jsx("hr",{className:"dropdown-divider"})}),e.jsx("li",{className:"px-3",children:e.jsx("div",{className:"d-flex flex-wrap gap-2",children:Ta.map(({nombre:x,valor:m})=>e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>g(m),className:"rounded-circle border-0",style:{background:m,width:"24px",height:"24px",outline:m===r?"2px solid white":"none",cursor:"pointer"},title:x,"aria-label":x})},x))})})]})]})]})},Fe=({Promp:s,Promp2:l})=>e.jsx("div",{className:"col-12 d-none d-md-flex justify-content-center align-items-center ",children:e.jsx("div",{className:"w-75 text-white",children:e.jsx("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h1",{className:"display-5 fw-bold",children:s}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:l})})]})})})}),Is=()=>{const{currentUser:s}=a.useContext(ss),l=Zs(),[t,n]=a.useState(!1),i=async()=>{try{await Ws(Xe),l("/")}catch(o){console.error("Error al cerrar sesión:",o)}},r=()=>{n(!1)};return s&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:o=>{o.stopPropagation(),n(!0)},className:"btn text-secondaryMuiRed fw-semibold",children:[e.jsx("i",{className:"bi bi-box-arrow-right me-2 text-danger "})," Cerrar Sesión"]}),e.jsx("div",{className:`modal bg-dark fade ${t?"show":""}`,style:{display:t?"block":"none"},tabIndex:"-1","aria-labelledby":"logoutModalLabel","aria-hidden":!t,children:e.jsx("div",{className:"modal-dialog ",children:e.jsxs("div",{className:"modal-content   border border-white",children:[e.jsxs("div",{className:"modal-header bg-gradiante2 ",children:[e.jsx("h5",{className:"modal-title text-white  ",id:"logoutModalLabel",children:"Confirmar Cierre de Sesión"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:r,"aria-label":"Close"})]}),e.jsx("div",{className:"modal-body text-center  fw-semibold text-uppercase lh-lg",children:"¿Está seguro de que desea cerrar sesión?"}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,children:"Cancelar"}),e.jsx("button",{type:"button",className:"btn btn-purpleUi ",onClick:()=>{i(),r()},children:"Cerrar Sesión"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})};function ls(){const[s,l]=a.useState(0),[t,n]=a.useState(()=>{const i=localStorage.getItem("leidas");return i?JSON.parse(i):{}});return a.useEffect(()=>{const i=W(D,"db_notificaciones"),r=He(i,o=>{const g=o.docs.map(x=>({id:x.id,...x.data()})).filter(x=>!t[x.id]);l(g.length)});return()=>r()},[t]),s===0?null:e.jsx(e.Fragment,{children:s>99?"99+":s})}const ke=()=>{var n;const l=(()=>{const i=localStorage.getItem("user");return i?JSON.parse(i):null})(),t=((n=l==null?void 0:l.email)==null?void 0:n.split("@")[0])||"Usuario Sin Registro";return e.jsx("nav",{className:"navbar navbar-expand-lg navbar-dark bg-transparent position-sticky top-0 top-0 w-100 z-3",children:e.jsxs("div",{className:"container-fluid",children:[e.jsx(Te,{className:"navbar-brand fw-bold text-white",to:"/dashboard",children:e.jsx("img",{src:"/img/marca-fondo-blanco-2024.png",height:"30",width:"100",alt:"Logo",className:"m-1"})}),e.jsx("div",{className:"position-relative",children:e.jsxs("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:[e.jsx("span",{className:"navbar-toggler-icon"}),e.jsx("span",{className:"position-absolute top-0 start-90 mt-1 translate-middle badge rounded-pill bg-danger",children:e.jsx(ls,{})})]})}),e.jsxs("div",{className:"collapse navbar-collapse",id:"navbarNav",children:[e.jsxs("ul",{className:"navbar-nav ms-auto d-none d-md-flex flex-row flex-wrap justify-content-end w-100",children:[e.jsx("li",{className:"nav-item",children:e.jsxs("div",{className:"nav-link text-white",children:[e.jsx("i",{className:"bi bi-person-circle me-2"}),t]})}),e.jsx("li",{className:"nav-item",children:e.jsxs(ve,{to:"/notificaciones",className:"nav-link text-white",children:[e.jsx("i",{className:"bi bi-megaphone-fill me-2"}),e.jsx("span",{className:"position-absolute top-1 start-75 translate-middle badge rounded-pill bg-danger",children:e.jsx(ls,{})})]})}),e.jsxs("li",{className:"nav-item dropdown",children:[e.jsxs("a",{className:"nav-link dropdown-toggle text-white",href:"#",id:"navbarDropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:[e.jsx("i",{className:"bi bi-grid-fill me-2 ms-2"}),e.jsx("span",{className:"d-none d-md-inline",children:"Más"})]}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end text-center mb-3 shadow border-0",children:[e.jsxs(ve,{to:"/FormularioPageDev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-ui-checks-grid me-2 textG2"}),e.jsx("span",{children:"Formulario Personas"})]}),e.jsxs(ve,{to:"/Formulariovehiculo",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-ui-checks-grid me-2 textG2"}),e.jsx("span",{children:"Formulario Vehiculos"})]}),e.jsxs(ve,{to:"/Formulariobuscados",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-ui-checks-grid me-2 textG2"}),e.jsx("span",{children:"Formulario Buscados SF"})]}),e.jsxs(ve,{to:"/notificaionesNew",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-megaphone me-2 textG2"}),e.jsx("span",{children:"Notificación"}),e.jsx("span",{className:"badge text-bg-orangeDb mx-1 text-white",children:"Crear"})]}),e.jsxs(ve,{to:"/informes",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-braces-asterisk me-2 textG2"}),e.jsx("span",{children:"Noticias"}),e.jsx("span",{className:"badge text-bg-primary mx-1 text-white",children:"Crear"})]}),e.jsxs(ve,{to:"/panelcontrol10dev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-file-earmark-lock2-fill me-2 textG2"}),e.jsx("span",{children:"10 bis"}),e.jsx("span",{className:"badge text-bg-secondaryM mx-1 text-white",children:"Panel"})]}),e.jsxs(ve,{to:"/panelcontroldev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-camera-fill me-2 textG2"}),e.jsx("span",{children:"Capturas "}),e.jsx("span",{className:"badge text-bg-indigoMui text-white",children:"Panel"})]}),e.jsxs(ve,{to:"/panelcontrolvehiculos",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-car-front-fill me-2 textG2"}),e.jsx("span",{children:"Vehiculos "}),e.jsx("span",{className:"badge text-bg-pink text-white",children:"Panel"})]}),e.jsxs(ve,{to:"/panelcontrolbuscados",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-cash-coin me-2 textG2"}),e.jsx("span",{children:"Buscados "}),e.jsx("span",{className:"badge text-bg-cyan text-white",children:"Panel"})]}),e.jsx("li",{children:e.jsx("hr",{className:"dropdown-divider bg-indigo "})}),e.jsx("li",{children:e.jsx(Is,{})})]})]})]}),e.jsxs("ul",{className:"navbar-nav ms-auto d-flex d-md-none flex-row flex-wrap justify-content-between w-100",children:[e.jsx("li",{className:"nav-item",children:e.jsxs("div",{className:"nav-link text-white",children:[e.jsx("i",{className:"bi bi-person-fill me-2"}),t]})}),e.jsx("li",{className:"nav-item",children:e.jsx(ve,{to:"/dashboard",className:"nav-link text-white",children:e.jsx("i",{className:"bi bi-house-door-fill me-2"})})}),e.jsx("li",{className:"nav-item",children:e.jsxs(ve,{to:"/notificaciones",className:"nav-link text-white",children:[e.jsx("i",{className:"bi bi-megaphone-fill me-2"}),e.jsx("span",{className:"position-absolute top-1 start-75 translate-middle badge rounded-pill bg-danger",children:e.jsx(ls,{})})]})}),e.jsxs("li",{className:"nav-item dropdown",children:[e.jsxs("a",{className:"nav-link dropdown-toggle text-white",href:"#",id:"navbarDropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:[e.jsx("i",{className:"bi bi-grid-fill me-2 ms-2"}),e.jsx("span",{className:"d-none d-md-inline",children:"Más"})]}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end text-center mb-3 shadow border-0",children:[e.jsxs(ve,{to:"/FormularioPageDev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-ui-checks-grid me-2 textG2"}),e.jsx("span",{children:"Formulario Personas"})]}),e.jsxs(ve,{to:"/Formulariovehiculo",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-ui-checks-grid me-2 textG2"}),e.jsx("span",{children:"Formulario Vehiculos"})]}),e.jsxs(ve,{to:"/Formulariobuscados",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-ui-checks-grid me-2 textG2"}),e.jsx("span",{children:"Formulario Buscados SF"})]}),e.jsxs(ve,{to:"/notificaionesNew",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-megaphone me-2 textG2"}),e.jsx("span",{children:"Notificación"}),e.jsx("span",{className:"badge text-bg-orangeDb mx-1 text-white",children:"Crear"})]}),e.jsxs(ve,{to:"/informes",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-braces-asterisk me-2 textG2"}),e.jsx("span",{children:"Noticias"}),e.jsx("span",{className:"badge text-bg-primary mx-1 text-white",children:"Crear"})]}),e.jsxs(ve,{to:"/panelcontrol10dev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-file-earmark-lock2-fill me-2 textG2"}),e.jsx("span",{children:"10 bis"}),e.jsx("span",{className:"badge text-bg-secondaryM mx-1 text-white",children:"Panel"})]}),e.jsxs(ve,{to:"/panelcontroldev2",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-camera-fill me-2 textG2"}),e.jsx("span",{children:"Capturas "}),e.jsx("span",{className:"badge text-bg-indigoMui text-white",children:"Panel"})]}),e.jsxs(ve,{to:"/panelcontrolvehiculos",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-car-front-fill me-2 textG2"}),e.jsx("span",{children:"Vehiculos "}),e.jsx("span",{className:"badge text-bg-pink text-white",children:"Panel"})]}),e.jsxs(ve,{to:"/panelcontrolbuscados",className:"dropdown-item",children:[e.jsx("i",{className:"bi bi-cash-coin me-2 textG2"}),e.jsx("span",{children:"Buscados "}),e.jsx("span",{className:"badge text-bg-cyan text-white",children:"Panel"})]}),e.jsx("li",{children:e.jsx("hr",{className:"dropdown-divider bg-indigo "})}),e.jsx("li",{children:e.jsx(Is,{})})]})]})]})]})]})})},Ba=({toggleRendimiento:s})=>{const[l,t]=a.useState({personalEntrega:[],salidasArtUsuarioMap:[]});a.useEffect(()=>{(async()=>{const o=(await re(W(D,"db_art_diez_bis_desactivados"))).docs.map(d=>d.data());n(o)})()},[]);const n=i=>{const r={},o={};i.forEach(x=>{x.personal_entrega.forEach(m=>{const j=m.nombre.split(" ")[0],u=`${m.ni} - ${j}`;r[u]=(r[u]||0)+1}),x.salida_art_usuario&&(o[x.salida_art_usuario]=(o[x.salida_art_usuario]||0)+1)});const d=Object.entries(r).map(([x,m])=>({key:x,value:m})).sort((x,m)=>m.value-x.value),g=Object.entries(o).map(([x,m])=>({usuario:x,cantidad:m})).sort((x,m)=>m.cantidad-x.cantidad);t({personalEntrega:d,salidasArtUsuarioMap:g})};return e.jsxs("div",{className:"container  ",children:[e.jsx("div",{className:"modal-header border border-0 ",children:e.jsx("button",{type:"button",className:"btn-close bg-white my-2",onClick:s})}),e.jsxs("div",{className:"card bg-transparent border-1 p-3  border-5",children:[e.jsxs("h5",{className:"card-title text-center  bg-gradiante2  text-white rounded p-2 m-2",children:["Rendimiento en  Entrega ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsx("div",{className:"card-body  ",children:e.jsxs("table",{className:"table table-striped text-center table-primary  ",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Posición"}),e.jsx("th",{scope:"col ",children:"Personal"}),e.jsx("th",{scope:"col",children:"Distinción"})]})}),e.jsx("tbody",{children:l.personalEntrega.length>0?l.personalEntrega.map(({key:i,value:r},o)=>e.jsxs("tr",{className:o===0?"table-warning":"",children:[e.jsx("td",{children:o===0?"👑 1":o===1?"🥈 2":o===2?"🥉 3":o+1}),e.jsx("td",{children:i}),e.jsx("td",{children:o===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):o===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):o===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},i)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:"No hay datos disponibles"})})})]})})]})]})},Oa=({notif:s})=>e.jsxs("div",{className:"list-group-item d-flex justify-content-between align-items-center my-2 py-3 shadow",children:[e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-person-arms-up me-3 text-primary"}),e.jsx("strong",{children:s.nombre_apellido||"Nombre desconocido"}),e.jsxs("span",{children:[" - ",s.dni||"DNI no disponible"]})]}),e.jsx("span",{className:"badge bg-primary",children:s.comisaria||"Sin fecha"})]}),Ua=({toggleBusqueda:s})=>{const[l,t]=a.useState([]),[n,i]=a.useState([]),[r,o]=a.useState(""),[d,g]=a.useState(!1),x=async()=>{try{g(!0);const j=_e(W(D,"db_art_diez_bis"),Oe("visualidad","==",!0)),p=(await re(j)).docs.map(c=>({id:c.id,...c.data()}));t(p),i(p)}catch(j){console.error("Error al obtener las notificaciones: ",j)}finally{g(!1)}};a.useEffect(()=>{x()},[]),a.useEffect(()=>{const j=l.filter(u=>u.nombre_apellido&&u.nombre_apellido.toLowerCase().includes(r.toLowerCase())||u.dni&&u.dni.toString().includes(r));i(j)},[r,l]);const m=()=>{o("")};return e.jsxs("div",{className:"container ",children:[e.jsx("div",{className:"modal-header border border-0 ",children:e.jsx("button",{type:"button",className:"btn-close bg-white my-2",onClick:s})}),e.jsxs("div",{className:"card bg-transparent border-1 p-3 border-5",children:[e.jsxs("h5",{className:"card-title text-center bg-gradiante2 text-white rounded p-2 m-2",style:{backdropFilter:"blur(5px)",backgroundColor:"rgba(0,0,0,0.4)"},children:["Buscar Persona ",e.jsx("i",{className:"ms-2 bi bi-search"})]}),e.jsxs("div",{className:"input-group my-4",children:[e.jsx("span",{className:"input-group-text bg-indigoMui ",children:e.jsx("i",{className:"bi bi-search text-white "})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar por DNI o nombre...",value:r,onChange:j=>o(j.target.value)}),r&&e.jsx("button",{className:"btn btn-outline-pink bg-secondaryMuiRed",onClick:m,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash3-fill text-white"})})]}),d?e.jsx("div",{className:"text-center my-4",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e.jsx("ul",{className:"list-group",children:n.length>0?n.map(j=>e.jsx(Oa,{notif:j},j.id)):e.jsx("li",{className:"list-group-item text-center text-danger p-4",children:r?`No se encontraron resultados para "${r}"`:"No hay personas disponibles"})})]})]})},qa=({togglePlazas:s})=>{const[l,t]=a.useState([]),[n,i]=a.useState([]),[r,o]=a.useState([]),[d,g]=a.useState("nombre"),x=async()=>{try{const h=(await re(W(D,"db_comisarias"))).docs.map(f=>({id:f.id,...f.data()})).filter(f=>f.disponibilidad===!0);t(h)}catch(b){console.error("Error al obtener las comisarías: ",b)}},m=async()=>{try{const h=(await re(W(D,"db_art_diez_bis"))).docs.map(N=>({id:N.id,...N.data()})),f=h.filter(N=>N.visualidad===!0&&N.comisaria_recibe===!0),v=h.filter(N=>N.visualidad===!1&&N.comisaria_recibe===!1);i(f),o(v)}catch(b){console.error("Error al obtener las notificaciones: ",b)}};a.useEffect(()=>{x(),m()},[]);const j=n.reduce((b,h)=>{const f=h.comisaria;return f&&(b[f]=(b[f]||0)+1),b},{}),u=r.reduce((b,h)=>{const f=h.comisaria;return f&&(b[f]=(b[f]||0)+1),b},{}),p=b=>{const h=l.find(f=>f.comisaria===b);if(h){const f=h.plazas_art_10_bis||0;return(j[b]||0)>=f?{estado:"Llena",clase:"badge bg-danger"}:{estado:"Disponible",clase:"badge bg-info"}}return{estado:"Desconocido",clase:"badge bg-secondary"}},c=()=>d==="nombre"?[...l].sort((b,h)=>b.comisaria.localeCompare(h.comisaria)):d==="plaza"?[...l].sort((b,h)=>(h.plazas_art_10_bis||0)-(b.plazas_art_10_bis||0)):l;return e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"modal-header border border-0 ",children:e.jsx("button",{type:"button",className:"btn-close bg-white my-2",onClick:s})}),e.jsxs("div",{className:"card bg-transparent border-1 p-3  border-5",children:[e.jsxs("h5",{className:"card-title text-center  bg-gradiante2  text-white rounded p-2 m-2",children:["Plazas Art 10 Bis ",e.jsx("i",{className:"ms-2 bi bi-shield-lock"})]}),e.jsxs("div",{className:"form-floating my-3",children:[e.jsxs("select",{className:"form-select",id:"filtroOrden",value:d,onChange:b=>g(b.target.value),"aria-label":"Ordenar por",children:[e.jsx("option",{value:"nombre",children:"Nombre (A-Z)"}),e.jsx("option",{value:"plaza",children:"Plazas Disponibles"})]}),e.jsx("label",{htmlFor:"filtroOrden",children:"Ordenar por"})]}),e.jsx("div",{className:"list-group",children:c().map(b=>{const{estado:h,clase:f}=p(b.comisaria),v=j[b.comisaria]||0,N=u[b.comisaria]||0;return e.jsx("div",{className:"list-group-item mb-3 shadow  ",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center ",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary",style:{fontSize:"1.5rem"}}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-capitalize",children:b.comisaria}),e.jsxs("div",{children:[e.jsx("small",{className:f,children:`${v} / ${b.plazas_art_10_bis||0} Plazas - ${h}`}),e.jsx("div",{children:e.jsx("small",{className:"badge bg-primary",children:`${N} Pendientes ( Por Validar )`})})]})]})]})},b.comisaria)})})]})]})},Va=({notif:s})=>e.jsxs("div",{className:"list-group-item d-flex justify-content-between align-items-center my-2 py-3 shadow",children:[e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-person-arms-up me-3 text-primary"}),e.jsx("strong",{children:s.nombre_apellido||"Nombre desconocido"}),e.jsxs("span",{children:[" - ",s.dni||"DNI no disponible"]})]}),e.jsx("span",{className:"badge bg-primary",children:s.comisaria||"Sin fecha"})]}),Ga=({toggleBusqueda:s})=>{const[l,t]=a.useState([]),[n,i]=a.useState([]),[r,o]=a.useState(""),[d,g]=a.useState(!1),x=async()=>{try{g(!0);const j=_e(W(D,"db_art_diez_bis"),Oe("visualidad","==",!0)),p=(await re(j)).docs.map(c=>({id:c.id,...c.data()}));t(p),i(p)}catch(j){console.error("Error al obtener las notificaciones: ",j)}finally{g(!1)}};a.useEffect(()=>{x()},[]),a.useEffect(()=>{const j=l.filter(u=>u.nombre_apellido&&u.nombre_apellido.toLowerCase().includes(r.toLowerCase())||u.dni&&u.dni.toString().includes(r));i(j)},[r,l]);const m=()=>{o("")};return e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"modal-header border border-0 m-0",children:e.jsx("button",{type:"button",className:"btn-close bg-white",onClick:s})}),e.jsxs("h5",{className:"text-center  bg-primary text-white rounded p-2",children:["Ingreso Articulo 10 Bis ",e.jsx("i",{className:"ms-2 bi bi-search"})]}),e.jsxs("div",{className:"input-group mb-4",children:[e.jsx("span",{className:"input-group-text bg-blueW",children:e.jsx("i",{className:"bi bi-search text-primary "})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar por DNI o nombre...",value:r,onChange:j=>o(j.target.value)}),r&&e.jsx("button",{className:"btn btn-outline-pink bg-secondaryMuiRed",onClick:m,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash3-fill text-white"})})]}),d?e.jsx("div",{className:"text-center my-4",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e.jsx("ul",{className:"list-group",children:n.length>0?n.map(j=>e.jsx(Va,{notif:j},j.id)):e.jsx("li",{className:"list-group-item text-center text-danger",children:r?`No se encontraron resultados para "${r}"`:"No hay notificaciones disponibles"})})]})},Ha=({comisariaSeleccionada:s,cantidadDemorados:l,close:t,closeModalRaiz:n})=>{const i=["CRE Rosario","CRE Baigorria","BOU","BOP","AUOP","MOTORIZADA","CGI","PAT","CYP","VIAL","PUMAS","OTROS"],[r,o]=a.useState("Rosario"),[d,g]=a.useState(s),[x,m]=a.useState(""),[j,u]=a.useState(""),[p,c]=a.useState(""),[b,h]=a.useState(""),[f,v]=a.useState(""),[N,S]=a.useState(""),[k,y]=a.useState(!1),w=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/,[C,E]=a.useState(!0),[F,_]=a.useState([]),[I,P]=a.useState(""),[U,K]=a.useState(""),[G,A]=a.useState([]),V=new Date().toLocaleString(),H=L=>w.test(L),Z=()=>{if(G.length>=l){alert(`Ya agregaste la cantidad máxima de ${l} personas.`);return}if(!H(j)){v("El nombre y apellido solo deben contener letras y espacios.");return}if(p.length!==8||isNaN(p)){v("El DNI debe ser un número de 8 caracteres.");return}A([...G,{nombreApellido:j,dni:p}]),u(""),c(""),v("")},z=()=>{if(F.some(Q=>Q.ni===U)){S("El N.I. ya está registrado en la lista de integrantes.");return}if(U.length!==6||isNaN(U)){S("El N.I debe ser un número de 6 caracteres.");return}if(!H(I)){S("El nombre no debe contener números.");return}_([...F,{nombre:I,ni:U}]),E(!1),P(""),K(""),S("")},R=()=>{E(!C)},J=async L=>{if(L.preventDefault(),!d){h("Por favor, selecciona una comisaría.");return}if(!x){h("Por favor, selecciona una unidad.");return}if(G.length===0){h("Debes agregar al menos una persona.");return}if(F.length===0){h("Debes agregar al menos una persona para la entrega.");return}if(!window.confirm("¿Estás seguro de que deseas agregar Art. 10 Bis?")){alert("La operación fue cancelada.");return}h(""),y(!0);try{const X=JSON.parse(localStorage.getItem("user"));for(let se=0;se<G.length;se++){const M=G[se];await Pe(W(D,"db_art_diez_bis"),{nombre_apellido:M.nombreApellido,dni:M.dni,selectedLocalidad:r,comisaria:s,unidad:x,timestamp:V,usuario:(X==null?void 0:X.email)||"Usuario desconocido",visualidad:!1,comisaria_recibe:!1,personal_entrega:F})}alert("Se agregaron las personas con Art. 10 Bis."),o("Rosario"),g(""),m(""),u(""),_(""),c(""),K(""),n(),t()}catch(X){console.error("Error al enviar notificación: ",X),h("Error al enviar la notificación. Inténtalo de nuevo.")}finally{y(!1)}},ne=L=>{const Q=G.filter((X,se)=>se!==L);A(Q)},me=L=>{const Q=F.filter((X,se)=>se!==L);_(Q),F.length<2&&E(!0)},he=G.length>0,ae=x&&x.trim().length>0,T=F.length>0;return e.jsx("form",{onSubmit:J,children:e.jsxs("div",{className:"container ",children:[G.length>0&&e.jsxs("div",{className:"text-center my-2",children:[e.jsx("hr",{className:"text-light mb-3"}),e.jsxs("h6",{className:"fw-semibold text-white ",children:["Personas Agregadas "," ",e.jsx("span",{className:"badge bg-indigo",children:G.length})]})]}),e.jsx("ul",{className:"list-group mb-4",children:G.map((L,Q)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center my-2 p-2 rounded shadow-sm bg-light",children:[e.jsx("i",{className:"bi bi-person-circle text-primary me-3 titilar"}),L.nombreApellido," - ",L.dni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>ne(Q),children:e.jsx("i",{className:"bi bi-trash"})})]},Q))}),e.jsxs("div",{className:"mb-3 text-center",children:[x?e.jsx("div",{children:e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("hr",{className:"text-light mb-3"}),e.jsxs("h6",{className:"fw-semibold text-white",children:["Unidad Operacional "," ",e.jsx("span",{className:"badge bg-indigo",children:x}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>m(""),children:e.jsx("i",{className:"bi bi-trash"})})]})]})}):e.jsxs("div",{children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-gradiante2 fw-semibold shadow-sm text-white py-2 rounded",children:"Unidad Procede a la Entrega"}),e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{id:"unidad",className:`form-select ${b&&!x?"is-invalid":""}`,value:x,onChange:L=>m(L.target.value),children:[e.jsx("option",{value:"",className:"text-center mt-1",children:"Seleccionar Unidad"}),i.map(L=>e.jsx("option",{value:L,children:L},L))]}),e.jsx("label",{htmlFor:"unidad",children:"Unidad Procede a la Entrega"}),b&&!x&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una unidad."})]})]}),e.jsx("div",{className:"mb-3 text-center",children:b&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),b]})})]}),F.length>0&&e.jsxs("div",{className:"text-center  mt-4",children:[e.jsx("hr",{className:"text-light mb-3"}),e.jsxs("h6",{className:"fw-semibold text-white ",children:["integrantes Unidad"," ",e.jsx("span",{className:"badge bg-indigo ",children:F.length})]}),e.jsx("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:e.jsxs("button",{type:"button",className:"btn border-light text-light my-1",onClick:R,children:[e.jsx("i",{className:"bi bi-car-front-fill mx-1"}),C?" Cerrar":" Agregar"]})})]}),e.jsx("ul",{className:"list-group mb-3 ",children:F.map((L,Q)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center mb-2 p-2 rounded shadow-sm bg-light mt-3",children:[e.jsx("i",{className:"bi bi-car-front-fill text-primary me-3 titilar "}),L.nombre," - ",L.ni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>me(Q),children:e.jsx("i",{className:"bi bi-trash"})})]},Q))}),e.jsx("hr",{className:"text-light mb-5"}),G.length<l&&e.jsxs("div",{className:"row g-2 mb-4 mt-4 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center border border-3 fw-semibold shadow-sm text-white py-2 rounded",children:"Agregar personas 10 Bis"}),f&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),f]}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${f&&!w.test(j)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:j,onChange:L=>u(L.target.value)}),e.jsx("label",{htmlFor:"nombreApellido",children:"Nombre y Apellido"}),f&&!w.test(j)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${f&&(p.length!==8||isNaN(Number(p)))?"is-invalid":""}`,maxLength:"8",placeholder:"DNI",value:p,onChange:L=>c(L.target.value.replace(/[^\d]/g,""))}),e.jsx("label",{htmlFor:"dni",children:"DNI"}),f&&(p.length!==8||isNaN(Number(p)))&&e.jsx("div",{className:"invalid-feedback",children:"El DNI debe ser un número de hasta 8 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",onClick:()=>Z(),children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})})})]}),C?e.jsxs("div",{className:"mb-3 text-center mt-5",children:[e.jsxs("h6",{className:"fw-semibold text-capitalize text-center border border-3 fw-semibold shadow-sm text-white py-2 rounded",children:["Mi Unidad ",e.jsx("span",{className:"badge text-bg-indigo mx-1",children:" Integrantes"})]}),N&&e.jsxs("div",{className:"alert alert-light text-danger shadow my-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar"}),N]}),e.jsxs("div",{className:"row g-2 my-2",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${N&&!w.test(I)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:I,onChange:L=>P(L.target.value)}),e.jsx("label",{htmlFor:"nombreEntrega",children:"Nombre y Apellido"}),N&&!w.test(I)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${N&&(U.length!==6||isNaN(U))?"is-invalid":""}`,placeholder:"N.I",maxLength:"6",value:U,onChange:L=>K(L.target.value)}),e.jsx("label",{htmlFor:"niEntrega",children:"N.I"}),N&&(U.length!==6||isNaN(U))&&e.jsx("div",{className:"invalid-feedback",children:"El N.I debe ser un número de 6 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",onClick:()=>z(),children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})})})]})]}):null,e.jsx("div",{className:"card  bg-transparent mt-5",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title mb-3",children:"Asistente de Estados "}),he&&ae&&T&&e.jsx("div",{className:"text-start",children:e.jsx("button",{type:"submit",className:"btn btn-primary shadow",disabled:k,children:k?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-arrow-repeat me-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-check-circle me-2"}),"Confirmar Envio"]})})}),e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:`btn btn-${he?"teal":"secondaryMuiRed"} btn-sm text-white rounded-circle ms-3`,title:he?"Condición cumplida":"Falta agregar persona",children:e.jsx("i",{className:"bi bi-person-fill"})}),e.jsx("button",{type:"button",className:`btn btn-${ae?"teal":"secondaryMuiRed"} btn-sm text-white rounded-circle ms-3`,title:ae?"Condición cumplida":"Falta seleccionar unidad",children:e.jsx("i",{className:"bi bi-shield-fill"})}),e.jsx("button",{type:"button",className:`btn btn-${T?"teal":"secondaryMuiRed"} btn-sm text-white rounded-circle ms-3`,title:T?"Condición cumplida":"Falta agregar persona para la entrega",children:e.jsx("i",{className:"bi bi-car-front-fill"})})]})]})})]})})},Wa=({comisariaSeleccionada:s,cantidadDemorados:l,closeModalRaiz:t})=>{const[n,i]=a.useState(!1),r=()=>{i(!0),window.history.pushState({modalOpen:!0},"")},o=()=>{var d;i(!1),(d=window.history.state)!=null&&d.modalOpen&&window.history.back()};return a.useEffect(()=>{const d=g=>{n&&i(!1)};return window.addEventListener("popstate",d),()=>{window.removeEventListener("popstate",d)}},[n]),!s||!l?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-3",children:e.jsxs("button",{className:"btn btn-primary w-100",onClick:r,children:[e.jsx("i",{className:"bi bi-file-earmark-plus-fill me-2"})," Crear Formulario"]})}),n&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",style:{background:"linear-gradient(135deg, #6e7fdb, #4e5b9a ,#633D88,#8C57FF)",animation:n?"fadeIn 0.5s":"none"},children:[e.jsxs("div",{className:"modal-header border border-0 bg-gradiante2 text-white",children:[e.jsx("h5",{className:"modal-title",children:"Formulario de Ingreso"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:o})]}),e.jsx("hr",{className:"border-2 text-white opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row text-center text-white text-capitalize",children:[e.jsx("div",{className:"col",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Destino :"})," ",e.jsxs("span",{className:"badge text-bg-indigo",children:[" ",s," "]})]})}),e.jsx("div",{className:"col",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Demorados :"})," ",e.jsx("span",{className:"badge text-bg-primary",children:l})]})})]}),e.jsx(Ha,{comisariaSeleccionada:s,cantidadDemorados:l,close:o,closeModalRaiz:t})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs("button",{className:"btn btn-outline-light",onClick:o,children:[e.jsx("i",{className:"bi bi-backspace"})," Regresar"]}),e.jsxs("button",{className:"btn btn-outline-light",onClick:t,children:[e.jsx("i",{className:"bi bi-x-circle"})," Cancelar"]})]})]})})}),n&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Ja=({comisariaSeleccionada:s,cantidadDemorados:l,closeModalRaiz:t})=>{const n=s&&l>0;return e.jsxs("div",{className:"alert alert-info mt-3 ",children:[e.jsx("strong",{className:"text-center ",children:"Resumen de Selección"}),e.jsxs("p",{className:"my-2",children:["Comisaría Seleccionada:"," ",e.jsx("strong",{className:"text-capitalize",children:s?e.jsxs(e.Fragment,{children:[s," ",e.jsx("i",{className:"bi bi-building-fill-check text-primary"})]}):e.jsx("span",{className:"text-pink titilar ",children:"Ninguna"})})]}),e.jsxs("p",{className:"mb-0",children:["Cantidad de Demorados:"," ",e.jsx("strong",{children:l?e.jsxs(e.Fragment,{children:[l," ",e.jsx("i",{className:"bi bi-person-add text-primary"})]}):0})]}),n&&e.jsx(Wa,{comisariaSeleccionada:s,cantidadDemorados:l,closeModalRaiz:t})]})},Ya=({togglePlazas:s,cantidadDemorados:l,closeModalRaiz:t})=>{const[n,i]=a.useState([]),[r,o]=a.useState([]),[d,g]=a.useState([]),[x,m]=a.useState(""),[j,u]=a.useState("nombre"),[p,c]=a.useState(!0);a.useEffect(()=>{b(),h()},[]);const b=async()=>{try{const w=(await re(W(D,"db_comisarias"))).docs.map(C=>({id:C.id,...C.data()})).filter(C=>C.disponibilidad===!0);i(w),c(!1)}catch(y){console.error("Error al obtener comisarías:",y),c(!1)}},h=async()=>{try{const w=(await re(W(D,"db_art_diez_bis"))).docs.map(C=>({id:C.id,...C.data()}));o(w.filter(C=>C.visualidad===!0&&C.comisaria_recibe===!0)),g(w.filter(C=>C.visualidad===!1&&C.comisaria_recibe===!1))}catch(y){console.error("Error al obtener notificaciones:",y)}},f=r.reduce((y,w)=>{const C=w.comisaria;return C&&(y[C]=(y[C]||0)+1),y},{}),v=d.reduce((y,w)=>{const C=w.comisaria;return C&&(y[C]=(y[C]||0)+1),y},{}),N=y=>{const w=n.find(C=>C.comisaria===y);if(w){const C=w.plazas_art_10_bis||0,E=f[y]||0,F=C-E;return E>=C?{estado:"Llena",clase:"badge bg-danger"}:{estado:`Disponible (${F} libres)`,clase:"badge bg-secondaryM"}}return{estado:"Desconocido",clase:"badge bg-secondary"}},S=()=>j==="nombre"?[...n].sort((y,w)=>y.comisaria.localeCompare(w.comisaria)):j==="plaza"?[...n].sort((y,w)=>(w.plazas_art_10_bis||0)-(y.plazas_art_10_bis||0)):n,k=y=>l?y.filter(w=>{const C=f[w.comisaria]||0;return(w.plazas_art_10_bis||0)-C>=l}):y;return e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center my-4",children:[e.jsx("strong",{children:"Comisarías con plazas disponibles"}),e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:s,children:e.jsx("i",{className:"bi bi-trash3-fill"})})]}),p?e.jsx("div",{className:"d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})}):e.jsxs("div",{className:"list-group",children:[k(S()).map(y=>{const{estado:w,clase:C}=N(y.comisaria),E=f[y.comisaria]||0,F=v[y.comisaria]||0;return e.jsx("div",{className:"list-group-item mb-3 shadow",onClick:()=>{m(y.comisaria)},style:{cursor:"pointer"},children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary",style:{fontSize:"1.5rem"}}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-capitalize",children:y.comisaria}),e.jsxs("div",{children:[e.jsx("small",{className:C,children:`${E} / ${y.plazas_art_10_bis||0} Plazas `}),e.jsx("div",{children:e.jsx("small",{className:"badge bg-primary mt-1",children:`${F} Pendientes (por validar)`})})]})]})]})},y.comisaria)}),e.jsx("div",{className:"container mt-1",children:e.jsx(Ja,{cantidadDemorados:l,comisariaSeleccionada:x,closeModalRaiz:t})})]})]})},Za=({show:s,onClose:l,onConfirm:t,closeModalRaiz:n})=>{const[i,r]=a.useState(1),[o,d]=a.useState(!1),[g,x]=a.useState(null);if(!s)return null;const m=()=>{const j=parseInt(i,10);x(j),d(!0)};return e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",children:e.jsxs("div",{className:"modal-content ",style:{background:"linear-gradient(135deg, #6e7fdb, #4e5b9a ,#633D88,#8C57FF)",animation:s?"fadeIn 0.5s":"none"},children:[e.jsxs("div",{className:"modal-header border border-0 bg-gradiante2 text-white",children:[e.jsx("h5",{className:"modal-title text-capitalize ",children:"Cuantas Plazas Necesitas ?"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:l})]}),"   ",e.jsx("hr",{className:" border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"input-group ",children:[e.jsx("span",{className:"input-group-text  fw-semibold bg-transparent text-light",children:"Plaza/s"}),e.jsx("input",{type:"number",className:"form-control text-center",value:i,onChange:j=>r(j.target.value),min:"1",max:"10","aria-describedby":"cantidadAddon","aria-label":"Cantidad"}),e.jsx("button",{className:"btn btn-outline-light",type:"button",id:"cantidadAddon",onClick:m,children:"Aceptar"})]}),o&&e.jsx(Ya,{togglePlazas:()=>d(!1),cantidadDemorados:g,closeModalRaiz:n})]}),e.jsx("div",{className:"modal-footer",children:e.jsxs("button",{className:"btn btn-outline-light",onClick:l,children:[e.jsx("i",{className:"bi bi-backspace"}),"   Regresar"]})})]})})})},Qa=({showModal:s,closeModal:l})=>{const[t,n]=a.useState(!1),[i,r]=a.useState(!1),[o,d]=a.useState(!1),[g,x]=a.useState(!1),[m,j]=a.useState(!1),[u,p]=a.useState(!1),[c,b]=a.useState([]),h=Ve(),f=F=>{console.log(`Se demorarán ${F} personas`),n(!1)},v=()=>{r(!1),d(!1),p(!1),j(!1),x(!1),l()},N=()=>j(F=>!F),S=()=>x(F=>!F),k=()=>p(F=>!F),y=()=>d(F=>!F);a.useEffect(()=>{b([{id:"preformulario",component:e.jsx(Ga,{togglePreFormulario:y}),visible:o},{id:"busqueda",component:e.jsx(Ua,{toggleBusqueda:N}),visible:m},{id:"plazas",component:e.jsx(qa,{togglePlazas:S}),visible:g},{id:"rendimiento",component:e.jsx(Ba,{toggleRendimiento:k}),visible:u}])},[m,g,u,o]);const w=(F,_)=>{F.dataTransfer.setData("index",_)},C=(F,_)=>{F.preventDefault();const I=F.dataTransfer.getData("index");if(I!==null){const P=[...c],[U]=P.splice(I,1);P.splice(_,0,U),b(P)}},E=F=>F.preventDefault();return a.useEffect(()=>{if(h.pathname==="/dashboard"){const F=()=>v();return window.history.pushState(null,document.title),window.addEventListener("popstate",F),()=>window.removeEventListener("popstate",F)}},[]),a.useEffect(()=>{if(s){window.history.pushState({modalOpen:!0},"");const F=_=>{v()};return window.addEventListener("popstate",F),()=>{window.removeEventListener("popstate",F)}}},[s]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog",style:{display:"block",transition:"opacity 0.4s ease-in-out"},children:e.jsx("div",{className:"modal-dialog modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content bg-blueW2",style:{background:"linear-gradient(135deg, #4e5b9a , #633D88, #8C57FF)",animation:s?"fadeIn 0.5s":"none"},children:[e.jsxs("div",{className:"modal-header border-0 bg-gradiante2",children:[e.jsx("h5",{className:"modal-title ",children:"Menú Artículo 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close bg-prima btn-close-white",onClick:v})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-3 my-3 ",children:[e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:`btn rounded-circle shadow-sm border-2 px-3 py-2  ${t?"btn-light ":"btn-outline-light "}`,onClick:()=>{j(!1),p(!1),x(!1),r(!1),n(!0)},children:e.jsx("i",{className:"bi bi-person-lines-fill fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:t?"Ocultar":"Personas"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:`btn rounded-circle shadow-sm border-2 px-3 py-2 ${m?"btn-light":"btn-outline-light"}`,onClick:N,children:e.jsx("i",{className:"bi bi-search fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:m?"Ocultar":"Búsqueda"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:`btn rounded-circle shadow-sm border-2 px-3 py-2 ${g?"btn-light":"btn-outline-light"}`,onClick:S,children:e.jsx("i",{className:"bi bi-shield-lock fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:g?"Ocultar":"Plazas"})]}),e.jsxs("div",{className:"text-center me-2",children:[e.jsx("button",{className:`btn rounded-circle shadow-sm border-2 px-3 py-2 ${u?"btn-light":"btn-outline-light"}`,onClick:k,children:e.jsx("i",{className:"bi bi-bar-chart fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:u?"Ocultar":"Rendimiento"})]})]}),e.jsx("div",{className:"mt-3",children:c.map((F,_)=>F.visible&&e.jsx("div",{draggable:!0,onDragStart:I=>w(I,_),onDragOver:E,onDrop:I=>C(I,_),className:"border border-0 p-1 m-1 mt-3 text-white bg-transparent ",style:{cursor:"grab"},children:F.component},F.id))}),e.jsx("div",{className:"container my-4",children:e.jsx(Za,{show:t,onClose:()=>n(!1),onConfirm:f,closeModalRaiz:l})})]})]})})}):null},Xa=()=>{const[s,l]=a.useState(!1),t=()=>l(!1);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3",children:[e.jsxs("div",{className:"text-center mx-2",children:[e.jsx(Te,{onClick:()=>l(!0),className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})}),e.jsx("div",{className:"mt-1 small",children:"Nuevo"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx(Te,{to:"/validaringreso10Bis",className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",children:e.jsx("i",{className:"bi bi-box-arrow-in-right fs-5"})}),e.jsx("div",{className:"mt-1 small",children:"Validar"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx(Te,{to:"/validarsalida10Bis",className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",children:e.jsx("i",{className:"bi bi-box-arrow-left fs-5"})}),e.jsx("div",{className:"mt-1 small",children:"Salida"})]})]}),e.jsx(Qa,{showModal:s,closeModal:t})]})},Ls=32e3,Ka=["db_art_diez_bis_descativados","db_buscados","db_formulario_diez_bis","db_informes","db_notificaciones","db_personas","db_personas_desactivados","db_vehiculos"],et=({titulo:s="Exportar Datos"})=>{const[l,t]=a.useState("db_buscados"),[n,i]=a.useState(!1),[r,o]=a.useState(!1);a.useEffect(()=>{document.body.style.overflow=r?"hidden":"auto"},[r]);const d=async()=>{const m=await re(W(D,l)),j=[];return m.forEach(u=>{const p=u.data();Object.keys(p).forEach(c=>{var b;(b=p[c])!=null&&b.toDate&&(p[c]=p[c].toDate().toLocaleString())}),Object.keys(p).forEach(c=>{typeof p[c]=="string"&&p[c].length>Ls&&(p[c]=p[c].substring(0,Ls)+"...")}),j.push({id:u.id,...p})}),j},g=async()=>{i(!0);try{const m=await d();if(m.length===0){alert("No hay datos para exportar.");return}const j=ye.json_to_sheet(m),u=ye.book_new();ye.book_append_sheet(u,j,l),Ge(u,`${l}.xlsx`)}catch(m){console.error("Error exportando a Excel:",m),alert("Ocurrió un error al exportar a Excel.")}finally{i(!1)}},x=async()=>{i(!0);try{const m=await d();if(m.length===0){alert("No hay datos para exportar.");return}const j=new Blob([JSON.stringify(m,null,2)],{type:"application/json"}),u=URL.createObjectURL(j),p=document.createElement("a");p.href=u,p.download=`${l}.json`,p.click(),URL.revokeObjectURL(u)}catch(m){console.error("Error exportando a JSON:",m),alert("Ocurrió un error al exportar a JSON.")}finally{i(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"badge bg-white bg-opacity-75 text-dark fw-semibold px-3 py-1 my-2  mx-3",onClick:()=>o(!0),children:s}),r&&e.jsx("div",{className:"modal show fade d-block text-dark bg-dark bg-opacity-50  ",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered ",role:"document",children:e.jsxs("div",{className:"modal-content ",children:[e.jsxs("div",{className:"modal-header border border-0",children:[e.jsx("h5",{className:"modal-title",children:"Exportar Colección"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>o(!1)})]}),e.jsxs("div",{className:"modal-body ",children:[e.jsx("label",{className:"form-label",children:"Seleccione colección:"}),e.jsx("select",{className:"form-select mb-3",value:l,onChange:m=>t(m.target.value),children:Ka.map(m=>e.jsx("option",{value:m,children:m},m))}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{onClick:g,className:"btn btn-green",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Exportando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-file-earmark-excel-fill me-2"}),"Exportar a Excel"]})}),e.jsx("button",{onClick:x,className:"btn btn-primary2",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Exportando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-filetype-json me-2"}),"Exportar a JSON"]})})]})]}),e.jsx("div",{className:"modal-footer border border-0",children:e.jsx("button",{className:"btn btn-secondary",onClick:()=>o(!1),children:"Cerrar"})})]})})})]})},st=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-6   d-none d-md-block ",children:[e.jsxs("div",{className:"p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg my-4 ",children:[e.jsxs("h1",{className:"fw-bold display-1 animate__animated  animate__rotateInDownLeft ",children:["Cx2 App",e.jsx("span",{className:"titilar",children:"_"})]}),e.jsx("h2",{className:"fw-semibold fs-4 animate__fadeInUp animate__animated",children:"Santa Fe - Datos + Comunicación"}),e.jsx("div",{className:"badge bg-white text-dark fw-semibold px-3 py-1 my-2 animate__animated  animate__rotateInDownLeft ",children:"Datos precisos. Acción directa.   "}),e.jsx(et,{})]}),e.jsx("div",{className:"p-4 bg-dark bg-opacity-25 rounded-4 shadow-lg",children:e.jsx("p",{className:"fs-5 mt-3 text-center animate__fadeInUp animate__animated",children:"Tu herramienta ágil para controlar, organizar y comunicar información de forma simple y eficiente."})}),e.jsxs("div",{className:"mt-5 small d-flex flex-column align-items-end  animate__flipInX animate__animated",children:[e.jsx("p",{className:"mb-1",children:"Versión: 1.0.0 | Actualización: 1.0.0"}),e.jsxs("p",{className:"mb-0",children:["Soporte: ",e.jsx("a",{href:"mailto:ticsdesarrollo2024@gmail.com",className:"text-white text-decoration-underline",children:"ticsdesarrollo2024@gmail.com"})]})]})]}),e.jsxs("div",{className:" col-12 col-md-6  ",children:[e.jsxs("div",{className:"position-relative overflow-hidden rounded-4 shadow-lg  ",children:[e.jsx("div",{className:"d-flex",children:e.jsx("img",{src:"/img/gif/sirena.gif",className:"w-100 object-fit-cover opacity-50",alt:"Ciudad nocturna",style:{height:"300px",objectFit:"cover"}})}),e.jsxs("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex flex-column justify-content-center align-items-center text-white bg-dark bg-opacity-50",children:[e.jsxs("h1",{className:"fw-bold display-1 animate__fadeInUp animate__animated",children:["Art 10 Bis ",e.jsx("i",{className:"bi bi-people-fill"})]}),e.jsx("p",{className:"lead text-center px-3",children:"Datos precisos. Acción directa."}),e.jsx(Xa,{})]})]}),e.jsxs("div",{className:"position-relative overflow-hidden rounded-4 shadow-lg my-4 ",children:[e.jsx("div",{className:"d-flex",children:e.jsx("img",{src:"/img/splash/concept5.jpeg",className:"w-100 object-fit-cover opacity-50",alt:"Ciudad nocturna",style:{height:"300px",objectFit:"cover"}})}),e.jsxs("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex flex-column justify-content-center align-items-center text-white bg-dark bg-opacity-50",children:[e.jsxs("h1",{className:"fw-bold display-1  animate__animated  animate__rotateInDownRight",children:["Galeria ",e.jsx("i",{className:"bi bi-camera-fill mx-3"})]}),e.jsx("p",{className:"lead text-center px-3",children:"Información clara y eficaz, al instante."}),e.jsx(Te,{className:"btn btn-outline-light mt-3",to:"/galeriacx2",children:"Explorar Galería"})]})]}),e.jsxs("div",{className:"position-relative overflow-hidden rounded-4 shadow-lg my-4  ",children:[e.jsx("div",{className:"d-flex",children:e.jsx("img",{src:"/img/splash/concept8.gif",className:"w-100 object-fit-cover opacity-50",alt:"Ciudad nocturna",style:{height:"300px",objectFit:"cover"}})}),e.jsxs("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex flex-column justify-content-center align-items-center text-white bg-dark bg-opacity-50",children:[e.jsxs("h1",{className:"fw-bold display-1",children:["Vehiculos ",e.jsx("i",{className:"bi bi-car-front mx-3"})]}),e.jsx("p",{className:"lead text-center px-3",children:"Verifica en tiempo real, su captura."}),e.jsx(Te,{className:"btn btn-outline-light mt-3",to:"/galeriavehiculos",children:"Explorar Capturas"})]})]}),e.jsxs("div",{className:"position-relative overflow-hidden rounded-4 shadow-lg my-4  ",children:[e.jsx("img",{src:"/img/splash/concept9.gif",className:"w-100 object-fit-cover opacity-50",alt:"Ciudad nocturna",style:{height:"300px",objectFit:"cover"}}),e.jsxs("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex flex-column justify-content-center align-items-center text-white bg-dark bg-opacity-50",children:[e.jsxs("h1",{className:"fw-bold display-1 text-center ",children:["Buscados ",e.jsx("i",{className:"bi bi-currency-exchange mx-3"})]}),e.jsx("p",{className:"lead text-center px-3",children:"Recompensa por Información."}),e.jsx(Te,{to:"/GaleriaBuscados",className:"btn btn-outline-light mt-3 px-4 py-2 rounded-pill",children:"Explorar Recompensa"})]})]}),e.jsxs("div",{className:"position-relative overflow-hidden rounded-4 shadow-lg my-4",children:[e.jsx("div",{className:"d-flex",children:e.jsx("img",{src:"/img/splash/concept3.jpeg",className:"w-100 object-fit-cover opacity-50",alt:"Ciudad nocturna",style:{height:"300px",objectFit:"cover"}})}),e.jsxs("div",{className:"position-absolute top-0 start-0 w-100 h-100 d-flex flex-column justify-content-center align-items-center text-white bg-dark bg-opacity-50",children:[e.jsxs("h1",{className:"fw-bold display-1",children:["Noticias ",e.jsx("i",{className:"bi bi-braces-asterisk mx-3"})]}),e.jsx("p",{className:"lead text-center px-3",children:"Noticias útiles, justo cuando las necesitás."}),e.jsx(Te,{className:"btn btn-outline-light mt-3",to:"/informespost",children:"Explorar Informes"})]})]})]})]})})}),at=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),a.useEffect(()=>{const i=r=>{r.preventDefault(),r.returnValue="Estás a punto de dejar la página. ¿Quieres continuar?"};return window.addEventListener("beforeunload",i),()=>{window.removeEventListener("beforeunload",i)}},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Menu Inicio - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5",children:["  ",e.jsx(Fe,{Promp:"Menu de Incio App ",Promp2:"bi bi-code-slash fs-4 "}),"   "]}),e.jsxs("div",{className:" d-flexjustify-content-center  text-white gap-5",children:[e.jsx(st,{}),e.jsx(we,{})]})]}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},tt=()=>e.jsx(e.Fragment,{children:e.jsx(at,{})}),$e="/svg/undraw_male_avatar_g98dG.svg",it=({show:s,onClose:l,datos:t})=>{a.useState(!1);const[n,i]=a.useState(!1);a.useEffect(()=>{if(s){window.history.pushState({modalOpen:!0},"");const o=d=>{l()};return window.addEventListener("popstate",o),()=>{window.removeEventListener("popstate",o)}}},[s]);const r=o=>{if(!o)return;/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?window.location.href=`tel:${o}`:alert(`Tu dispositivo no puede realizar llamadas. Número: ${o}`)};return s?e.jsxs("div",{className:"modal fade show bg-dark",style:{display:"block"},"aria-labelledby":"captureDetailsModalLabel","aria-hidden":"false",children:[e.jsx("div",{className:"modal-dialog   ",children:e.jsxs("div",{className:"modal-content  bg-light  border-0",children:[e.jsx("div",{className:"modal-header",children:e.jsx("button",{type:"button",className:"btn-close ",onClick:l})}),e.jsxs("div",{className:"modal-body text-center ",children:[e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:()=>i(!0),children:[e.jsx("div",{className:"fs-4 position-absolute top-0 start-50 translate-middle-x bg-secondary  text-center w-100 rounded-top small",style:{opacity:.8},children:t.documento}),e.jsx("img",{src:t.base64&&t.base64.trim()!==""&&t.base64.trim()!=="null"?t.base64:"https://via.placeholder.com/150",className:"img-fluid mb-3 shadow-lg rounded-2 ",alt:t.nombre_apellido||"Imagen no disponible",style:{width:"500px",height:"auto"},loading:"lazy"}),e.jsx("div",{className:"display-6 position-absolute text-capitalize bottom-0 start-50 translate-middle-x bg-primary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:t.nombre_apellido})]}),e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 text-dark",children:["Datos de la Solicitud ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-primary border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2",children:"Motivo Captura"})}),t.motivo_captura&&t.motivo_captura.trim()!==""?e.jsx("p",{className:"form-control bg-blueW2 text-dark",style:{minHeight:"auto"},children:t.motivo_captura}):null,(!t.motivo_captura||t.motivo_captura.trim()==="")&&e.jsxs("button",{className:"btn btn-sm btn-outline-secondary  mx-4",onClick:()=>alert("Solicitud enviada. La información que requirió se le informará a los cargadores de captura para su carga. 🏤"),children:["Solicitar Información ",e.jsx("i",{className:"bi bi-person-raised-hand"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary2 text-white me-2",children:"Información Adicional"})}),t.descripcion_fisica&&t.descripcion_fisica.trim()!==""?e.jsx("p",{className:"form-control bg-blueW2 text-dark",style:{minHeight:"auto"},children:t.descripcion_fisica}):null,(!t.descripcion_fisica||t.descripcion_fisica.trim()==="")&&e.jsxs("button",{className:"btn btn-sm btn-outline-secondary  mx-4",onClick:()=>alert("Solicitud enviada. La información que requirió se le informará a los cargadores de captura para su carga. 🏤"),children:["Solicitar Información ",e.jsx("i",{className:"bi bi-person-raised-hand"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("hr",{className:"border border-white border-1 opacity-75"}),t.entidad&&t.entidad.trim()!==""&&e.jsxs("span",{className:"badge text-bg-primaryM text-white my-1 text-capitalize mx-3 p-2",children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill me-2"}),"Solicita - ",t.entidad]}),t.numero_contacto&&t.numero_contacto.trim()!==""&&e.jsx("div",{className:"d-flex justify-content-center my-3",children:e.jsxs("button",{className:"badge btn text-bg-primaryMuiBlue text-white text-capitalize p-2 d-flex align-items-center gap-2 mx-auto",onClick:()=>r(t.numero_contacto),children:[e.jsx("i",{className:"bi bi-telephone-forward-fill"}),"Contactar ",t.numero_contacto]})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed rounded-circle text-white",onClick:l,children:e.jsx("i",{className:"bi bi-x-lg"})})})]})}),n&&e.jsx("div",{className:"modal fade show d-flex align-items-center justify-content-center bg-dark ",style:{display:"block",width:"100vw",height:"100vh",position:"fixed",top:0,left:0,zIndex:1050},onClick:()=>i(!1),children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:o=>o.stopPropagation(),children:e.jsxs("div",{className:"modal-content bg-transparent border-0 text-center",children:[e.jsx("button",{type:"button",className:"btn-close btn-close-dark position-absolute top-0 end-0 m-3 bg-red",onClick:()=>i(!1)}),e.jsx("img",{src:t.base64||"https://via.placeholder.com/40",alt:"Imagen Ampliada",className:"img-fluid rounded shadow-lg",style:{maxWidth:"200vw",maxHeight:"200vh",objectFit:"contain"}})]})})})]}):null},lt=({show:s,onClose:l,datos:t})=>{var d;const[n,i]=a.useState(!1),[r,o]=a.useState(!1);return a.useEffect(()=>{if(location.pathname==="/dashboard"){const g=()=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",g),()=>{window.removeEventListener("popstate",g)}}},[l]),s?e.jsxs("div",{className:"modal fade show bg-dark",style:{display:"block"},"aria-labelledby":"captureDetailsModalLabel","aria-hidden":"false",children:[e.jsx("div",{className:"modal-dialog modal-dialog-centered ",children:e.jsxs("div",{className:"modal-content bg-gradiante2 border-0",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{className:"modal-title text-center text-white fw-semibold",children:"Detalles de la Captura 👮"}),e.jsx("button",{type:"button",className:"btn-close btn-close-dark",onClick:l})]}),e.jsxs("div",{className:"modal-body text-white",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 d-flex justify-content-center align-items-start mb-3",children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:()=>o(!0),children:[e.jsx("img",{src:t.base64||"https://via.placeholder.com/150",alt:t.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle shadow mt-2",style:{width:"130px",height:"130px",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:"Capturado"})]})}),e.jsxs("div",{className:"col-md-8",children:[e.jsxs("small",{className:"d-flex gap-2 justify-content-end mb-1",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-white border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control text-center text-capitalize",value:t.nombre_apellido,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control text-center",value:t.documento,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Documento"})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end",children:["Detalles de la Captura ",e.jsx("i",{className:"bi bi-journal-text"})]}),e.jsx("hr",{className:"border border-white border-1 opacity-75"}),((d=t.capturas_informacion_estados)==null?void 0:d.length)>0?e.jsxs(e.Fragment,{children:[t.capturas_informacion_estados.slice().reverse().slice(0,n?t.capturas_informacion_estados.length:1).map((g,x)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:`rounded-pill px-3 py-2 text-white ${g.captura_fecha?"bg-primary":"bg-secondaryMuiRed"}`,children:[e.jsx("strong",{className:"me-3",children:g.captura_autor||"Sistema"}),g.captura_fecha||g.captura_quita_fecha]}),g.captura_fecha&&e.jsxs("p",{children:["Relato: ",e.jsx("span",{className:"fw-semibold",children:g.captura_descripcion||"Sin relato"})]})]},x)),t.capturas_informacion_estados.length>1&&e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"btn btn-link text-white text-decoration-none",onClick:()=>i(!n),children:n?"Ver menos":"Ver historial completo"})})]}):e.jsx("p",{className:"text-center",children:"No hay detalles de captura disponibles."})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed rounded-circle text-white",onClick:l,children:e.jsx("i",{className:"bi bi-x-lg"})})})]})}),r&&e.jsx("div",{className:"modal fade show d-flex align-items-center justify-content-center bg-dark",style:{display:"block",width:"100vw",height:"100vh",position:"fixed",top:0,left:0,zIndex:1050},onClick:()=>o(!1),children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:g=>g.stopPropagation(),children:e.jsxs("div",{className:"modal-content bg-transparent border-0 text-center",children:[e.jsx("button",{type:"button",className:"btn-close btn-close-dark position-absolute top-0 end-0 m-3 bg-red",onClick:()=>o(!1)}),e.jsx("img",{src:t.base64||"https://via.placeholder.com/150",alt:"Imagen Ampliada",className:"img-fluid rounded shadow-lg",style:{maxWidth:"90vw",maxHeight:"90vh",objectFit:"contain"}})]})})})]}):null};function rt({setGridView:s,gridView:l,sortOrder:t,setSortOrder:n,sortBy:i,setSortBy:r,searchTerm:o,setSearchTerm:d,priorityFilter:g,setPriorityFilter:x,currentPage:m,handlePriorityChange:j,entidadSeleccionada:u,setEntidadSeleccionada:p,entidades:c}){const[b,h]=a.useState(!1),f=()=>{h(!1),r("fecha"),n("desc"),x([])};return e.jsx("div",{className:"container-lg  ",children:e.jsx("div",{className:"d-flex justify-content-center align-items-center ",children:e.jsx("div",{className:"w-100 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h1",{className:"display-5 fw-bold",children:"Personas"}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:"bi bi-people-fill fs-4 text-dark"})})]}),e.jsx("form",{className:"d-flex justify-content-center my-4",onSubmit:v=>v.preventDefault(),children:e.jsxs("div",{className:"input-group input-group-lg w-100",style:{maxWidth:"600px"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar en Rosario...","aria-label":"Buscar",value:o,onChange:v=>d(v.target.value)}),e.jsx("button",{className:"btn btn-outline-light",type:"submit",children:e.jsx("i",{className:"bi bi-search"})})]})}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3",children:[e.jsx("button",{type:"button",onClick:()=>s(!0),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${l?"active":""}`,title:"Vista en cuadrícula",children:e.jsx("i",{className:`bi bi-grid-3x3-gap-fill fs-5 ${l?"titilar":""}`})}),e.jsx("button",{type:"button",onClick:()=>s(!1),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${l?"":"active"}`,title:"Vista en lista",children:e.jsx("i",{className:`bi bi-list fs-5 ${l?"":"titilar"}`})}),e.jsx("button",{type:"button",onClick:()=>h(!b),className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",title:"Mostrar/Ocultar filtros",children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})})]}),b&&e.jsxs("div",{className:"card shadow  bg-dark p-4 bg-opacity-25  rounded-4 shadow-lg text-white",style:{backgroundColor:"transparent",color:"white"},children:[e.jsxs("div",{className:"card-header fw-semibold  bg-light bg-opacity-25 rounded-4  p-3 text-ligh d-flex justify-content-between align-items-center ",children:[e.jsxs("span",{children:[e.jsx("i",{className:"bi bi-sort-alpha-down mx-1"})," Filtros de Galería"]}),e.jsx("i",{className:"bi bi-x-lg cursor-pointer",onClick:f,style:{cursor:"pointer"}})]}),e.jsxs("div",{className:"card-body ",children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-12 col-md-6 mb-3",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select   border-white shadow-sm text-center ",value:i,onChange:v=>r(v.target.value),children:[e.jsx("option",{value:"fecha",children:"Fecha"}),e.jsx("option",{value:"nombreApellido",children:"Nombre"})]}),e.jsx("label",{className:" p-2",children:"Filtrar por"})]})}),e.jsx("div",{className:"col-12 col-md-6 mb-3",children:e.jsxs("div",{className:"form-floating ",children:[e.jsx("select",{className:"form-select  border-white shadow-sm text-center",value:t,onChange:v=>n(v.target.value),children:i==="fecha"?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"asc",children:"Antiguo - Reciente"}),e.jsx("option",{value:"desc",children:"Reciente - Antiguo"})]}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"asc",children:"A - Z"}),e.jsx("option",{value:"desc",children:"Z - A"})]})}),e.jsx("label",{className:" p-2",children:"Ordenar Prioridad"})]})})]}),e.jsx("div",{className:"border border-white shadow-sm rounded-4 p-4 mb-4 text-white",children:e.jsxs("div",{className:"d-flex flex-wrap justify-content-center mb-3",children:[["No Prioritarias","Paradero","Evadidos","Prioritarias"].map((v,N)=>e.jsxs("div",{className:"form-check form-check-inline mb-2",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",value:N+1,checked:g.includes((N+1).toString()),onChange:j,disabled:m!==1,style:{cursor:m===1?"pointer":"not-allowed"}}),e.jsx("label",{className:"form-check-label text-white",children:v})]},N)),g.length>0&&e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed rounded-circle text-white shadow-sm mx-2",onClick:()=>x([]),children:e.jsx("i",{className:"bi bi-trash"})})]})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12 col-md-12 mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select bg-light rounded-4 shadow-sm text-center pe-5",value:u,onChange:v=>p(v.target.value),children:[e.jsx("option",{value:"",children:"Todas las Entidades"}),c.map((v,N)=>e.jsx("option",{value:v,children:v},N))]}),e.jsx("label",{className:"p-2 m-2",children:"Filtrar por Entidad"})]}),u&&e.jsx("button",{type:"button",className:"btn btn-sm btn-danger text-white position-absolute top-50 end-0 translate-middle-y me-3 shadow-sm rounded-circle",onClick:()=>p(""),title:"Quitar filtro",children:e.jsx("i",{className:"bi bi-x-lg"})})]})})})]})]})]})})})})}const nt=({informeId:s})=>{const[l,t]=a.useState(null),[n,i]=a.useState(!1),[r,o]=a.useState(0);a.useEffect(()=>{const x=localStorage.getItem("user");if(x){const m=JSON.parse(x);t(m.email),d(m.email)}},[s]);const d=async x=>{var u,p;const m=B(D,"db_personas",s),j=await De(m);if(j.exists()){const c=j.data();o(((u=c.me_sirve)==null?void 0:u.length)||0),i((p=c.me_sirve)==null?void 0:p.includes(x))}},g=async()=>{if(!l)return;const x=B(D,"db_personas",s);await le(x,{me_sirve:n?Ie(l):Me(l)}),i(!n),o(m=>n?m-1:m+1)};return e.jsxs("button",{onClick:g,className:`btn btn-outline-light bg-dark bg-opacity-50 px-4 py-2 d-flex align-items-center gap-2 ${n?"text-secondaryM":""}`,children:[e.jsx("i",{className:`bi ${n?"bi-hand-thumbs-up-fill text-secondaryM":"bi-hand-thumbs-up"}`}),"Me sirve",r>0&&` (${r})`]})},rs=15;function $s(s){const[l,t,n]=s.split("/").map(Number),i=2e3+n;return new Date(i,t-1,l)}const ot=()=>{const[s,l]=a.useState(!1),[t,n]=a.useState(!1),[i,r]=a.useState(!1),[o,d]=a.useState([]),[g,x]=a.useState(1),[m,j]=a.useState(0),[u,p]=a.useState(null),[c,b]=a.useState(null),[h,f]=a.useState(null),[v,N]=a.useState(null),[S,k]=a.useState(!0),[y,w]=a.useState(!1),[C,E]=a.useState(null),[F,_]=a.useState("fecha"),[I,P]=a.useState("desc"),[U,K]=a.useState(""),[G,A]=a.useState(!0),[V,H]=a.useState(""),[Z,z]=a.useState(!0),[R,J]=a.useState([]),[ne,me]=a.useState(""),he=async()=>{try{k(!0);const q=await re(W(D,"db_personas")),de=[],O=new Set;q.forEach(ce=>{const be={id:ce.id,...ce.data()};de.push(be),be.entidad&&O.add(be.entidad)}),d(de),J(Array.from(O)),j(Math.ceil(de.length/rs))}catch(q){console.error("Error obteniendo documentos: ",q),E("No se pudieron cargar los documentos.")}finally{k(!1)}};a.useEffect(()=>{he()},[]);const ae=q=>{const de=q.target.value;H(O=>O.includes(de)?O.filter(ce=>ce!==de):[...O,de])},T=a.useMemo(()=>o.filter(q=>{var be;const de=(be=q.nombre_apellido)==null?void 0:be.toLowerCase().includes(U.toLowerCase()),O=V.length===0||V.includes(String(q.prioridad)),ce=!ne||q.entidad===ne;return de&&O&&ce}),[o,U,V,ne]),L=a.useMemo(()=>T.sort((q,de)=>{if(q.prioridad===3&&de.prioridad!==3)return-1;if(de.prioridad===3&&q.prioridad!==3)return 1;if(q.prioridad===4&&de.prioridad!==4)return-1;if(de.prioridad===4&&q.prioridad!==4)return 1;if(F==="fecha"){const O=$s(q.date)||0,ce=$s(de.date)||0;return I==="asc"?O-ce:ce-O}else return I==="asc"?q.nombre_apellido.localeCompare(de.nombre_apellido):de.nombre_apellido.localeCompare(q.nombre_apellido)}),[T,F,I]),Q=(g-1)*rs,X=L.slice(Q,Q+rs),se=()=>{g<m&&(w(!0),x(q=>q+1),setTimeout(()=>w(!1),500))},M=()=>{g>1&&(w(!0),x(q=>q-1),setTimeout(()=>w(!1),500))},ee=q=>{N(!0),b(q)},te=()=>{p(null),N(null)},$=q=>{f(!0),b(q)},ie=()=>f(!1);return e.jsxs(e.Fragment,{children:[e.jsx(rt,{setGridView:A,gridView:G,sortOrder:I,sortBy:F,setSortOrder:P,setSortBy:_,searchTerm:U,setSearchTerm:K,showFilters:Z,priorityFilter:V,setPriorityFilter:H,currentPage:g,handlePriorityChange:ae,entidadSeleccionada:ne,setEntidadSeleccionada:me,entidades:R}),e.jsxs("div",{className:"container-lg",children:[S&&e.jsx(oe,{leyendaSet:"Cargado Base - Cx2"}),C&&e.jsx("div",{className:"alert alert-danger",children:C}),y?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(oe,{})}):e.jsx("div",{className:G?"row mt-5":"d-flex flex-column align-items-center mt-5",children:X.map(q=>e.jsx("div",{className:G?"col-6 col-sm-6 col-md-4 mb-4":"col-12 col-sm-6 col-md-6 mb-4",children:e.jsx("div",{className:"card py-4  shadow-sm text-center bg-dark bg-opacity-50  rounded-4",children:e.jsxs("div",{className:"position-relative",children:[q.alerta&&!q.captura&&e.jsx("div",{onClick:()=>n(!t),children:t?e.jsx("div",{className:"position-absolute top-1  start-50 translate-middle text-center d-flex justify-content-center align-items-center bg-redUi1  p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark  fw-semibold text-white ",children:[e.jsx("i",{className:" bi bi-exclamation-triangle-fill me-2 text-white titilar fs-5 shadow-sm "}),"Evadido ",q.date," "]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-redUi1   p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-exclamation-triangle-fill fs-5 mx-1 text-white titilar "})})}),q.paradero&&e.jsx("div",{onClick:()=>l(!s),children:s?e.jsx("div",{className:"position-absolute top-1 bg-blueMui start-50 translate-middle text-center d-flex justify-content-center align-items-center bg-redUi1  p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark  fw-semibold text-white ",children:[e.jsx("i",{className:" bi bi-search fs-5 mx-2 text-white  "}),"Paradero "]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-blueMui   p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-search fs-5 mx-1 text-white "})})}),q.prioridad===4&&e.jsx("div",{onClick:()=>r(!i),children:i?e.jsx("div",{className:"position-absolute top-1 bg-yellowMui start-50 translate-middle text-center d-flex justify-content-center align-items-center bg-redUi1  p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark  fw-semibold text-white ",children:[e.jsx("i",{className:"bi bi-star-fill fs-5 mx-2 text-white "}),"Prioritaria"]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-yellowMui   p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-star-fill fs-5 mx-1 text-white "})})}),q.captura&&e.jsxs("div",{className:"captura-cinta d-flex flex-column flex-md-row justify-content-between align-items-center p-2",style:{maxWidth:"100%",cursor:"pointer"},onClick:()=>$(q),children:[e.jsx("span",{className:"text-white fw-bold",children:"Capturado"}),e.jsx("button",{className:"btn btn-link p-0 text-white ms-md-2 mt-2 mt-md-0",onClick:de=>{de.stopPropagation(),$(q)},children:"Ver Detalles"})]}),e.jsx("div",{}),e.jsx("img",{src:q.base64&&q.base64.trim()!==""&&q.base64.trim()!=="null"?q.base64:$e,className:`card-img-top img-fluid  ${q.captura?"grayscale":""}`,alt:q.nombre_apellido||"Imagen no disponible",loading:"lazy",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"cover"},onClick:()=>ee(q)}),e.jsx("h5",{className:"card-title text-white text-capitalize mt-4",children:q.nombre_apellido}),e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-2 mt-3",children:[e.jsx("button",{onClick:()=>ee(q),className:"btn btn-outline-light bg-dark bg-opacity-50 px-4 py-2",children:"Ver detalles"}),e.jsx(nt,{informeId:q.id})]})]})})},q.id))}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center mt-4",children:[g>1&&e.jsx("button",{className:"btn btn rounded-pill shadow-sm text-center bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",onClick:M,children:e.jsx("i",{className:"bi bi-arrow-left fw-semibold fs-3 titilar"})}),e.jsxs("span",{className:"fs-6 mx-3  text-light",children:["Página ",g," de ",m]}),g<m&&e.jsx("button",{className:"btn rounded-pill shadow-sm text-center bg-dark bg-opacity-50 rounded-4 shadow-lg text-white ",onClick:se,children:e.jsx("i",{className:"bi bi-arrow-right fw-semibold fs-3 titilar"})})]})]}),e.jsx(it,{show:v,datos:c,onClose:te}),e.jsx(lt,{show:h,datos:c,onClose:ie})]})},ct=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Galeria - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsx("div",{className:"my-5 ",children:e.jsx(Fe,{Promp:"Geleria de Capturas ",Promp2:"bi bi-code-slash fs-4 "})}),e.jsx(ot,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},dt=()=>e.jsx(e.Fragment,{children:e.jsx(ct,{})}),mt=({recepciones:s,loading:l})=>e.jsx("div",{className:" text-center ",children:l?e.jsx("div",{className:"spinner-border text-white",role:"status"}):Object.keys(s).length>0?e.jsxs("div",{className:"text-center p-4 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("strong",{className:"text-light fs-6 text-capitalize",children:"Recepciones pendientes por comisaría:"}),e.jsx("ul",{className:"list-group mt-3",children:Object.entries(s).map(([t,n],i)=>e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"spinner-grow text-primaryMuiBlue spinner-grow-sm",role:"status"}),e.jsx("span",{children:t}),e.jsxs("span",{className:"badge bg-primaryMuiBlue",children:[n," pendientes"]})]},i))})]}):e.jsx("div",{className:"alert bg-light  bg-opacity-75  text-capitalize shadow",role:"alert",children:e.jsx("strong",{children:"No hay recepciones pendientes en este momento."})})}),as={"comisaria 1":"1111","comisaria 2":"2222","comisaria 3":"3333","comisaria 4":"4444","comisaria 5":"5555","comisaria 6":"6666","comisaria 7":"7777","Comisaria 8":"8888"},ut=({notificaciones:s,loading:l,aceptarRecepcion:t,rechazarRecepcion:n})=>{const[i,r]=a.useState(""),[o,d]=a.useState(!1),[g,x]=a.useState(null),[m,j]=a.useState(""),[u,p]=a.useState(!1),c=async()=>{if(!g)return;p(!0);const{id:h,comisaria:f}=g,v=as[f];setTimeout(()=>{m&&m===v?(t(h),r(""),d(!1),j("")):r(`El código ingresado "${m}" es incorrecto.`),p(!1)},1e3)},b=h=>{x(h),d(!0),r(""),j("")};return e.jsxs("div",{className:"container-lg text-center",children:[e.jsxs("div",{className:"row justify-content-center",children:[e.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"w-100 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-25 rounded-4 shadow-lg ",children:[e.jsxs("h1",{className:"display-4 fw-bold",children:["Ingreso 10 Bis ",e.jsx("i",{className:"bi bi-people-fill  ms-3 fs-1 "})]}),e.jsx("p",{className:"lead",children:"Administra las recepciones de este  articulo."})]})})}),e.jsx("div",{className:"col-12 col-md-12 col-lg-12 mt-5",children:e.jsx("div",{className:"position-relative",children:l?e.jsxs("div",{className:"text-primary",children:["      ",e.jsx("div",{className:"spinner-border text-white ",role:"status","aria-label":"Cargando...",children:" "})]}):e.jsxs("div",{className:"list-group",children:[i&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:i}),s&&s.length>0?s.map(h=>e.jsxs("div",{className:"list-group-item mb-3 shadow bg-light bg-opacity-75",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex flex-column w-100 text-truncate",children:[e.jsx("strong",{className:"text-truncate",children:h.nombre_apellido}),e.jsx("span",{className:"text-truncate",children:h.dni})]}),e.jsxs("div",{className:"d-flex flex-wrap justify-content-end row",children:[e.jsx("div",{className:"col mb-1",children:e.jsxs("button",{className:"btn btn-primary btn-sm me-2 mb-2 mb-md-0 w-100 w-md-auto",onClick:()=>b(h),"aria-label":`Aceptar recepción para ${h.nombre_apellido} en la Comisaría ${h.comisaria}`,children:["Aceptar ",e.jsx("i",{className:"bi bi-check-all ms-2"})]})}),e.jsx("div",{className:"col",children:e.jsxs("button",{className:"btn btn-pink btn-sm mb-2 mb-md-0 w-100 w-md-auto",onClick:()=>n(h.id),"aria-label":`Cancelar recepción para ${h.nombre_apellido}`,children:["Cancelar ",e.jsx("i",{className:"bi bi-trash ms-2"})]})})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{children:e.jsxs("small",{children:[h.selectedLocalidad," -"," ",e.jsx("span",{className:"badge bg-pink",children:h.comisaria})," -"," ",h.timestamp," -"," ",e.jsx("span",{className:"badge bg-primary",children:h.unidad})]})})})]},h.id)):e.jsxs("div",{className:"alert bg-light  bg-opacity-75  text-capitalize shadow",role:"alert",children:["No se encontraron Personas en dependencias.",e.jsx("i",{className:"bi bi-hand-thumbs-up ms-2"})]})]})})})]}),o&&g&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Ingresar Código"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>d(!1),"aria-label":"Cerrar"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["Ingresa el código para la Comisaría ",e.jsx("strong",{children:g.comisaria}),":"]}),e.jsx("input",{type:"text",className:"form-control",value:m,onChange:h=>j(h.target.value),placeholder:"Código"}),i&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:i})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:c,disabled:!m||u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Validando..."]}):"Aceptar"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>d(!1),children:"Cancelar"})]})]})})})]})},ht=()=>{const[s,l]=a.useState([]),[t,n]=a.useState(!1),[i,r]=a.useState(""),o=async()=>{try{n(!0);const j=_e(W(D,"db_art_diez_bis"),Oe("comisaria_recibe","==",!1)),p=(await re(j)).docs.map(c=>({id:c.id,...c.data()}));l(p)}catch(j){console.error("Error al obtener las recepciones pendientes: ",j)}finally{n(!1)}};a.useEffect(()=>{o()},[]);const d=async j=>{try{const u=JSON.parse(localStorage.getItem("user")),p=B(D,"db_art_diez_bis",j);await le(p,{comisaria_recibe:!0,visualidad:!0,fecha_ingreso_validado:Re(),usuario_validado_ingreso:u.email}),l(c=>c.filter(b=>b.id!==j)),alert("Recepción aceptada correctamente.")}catch(u){console.error("Error al aceptar la recepción: ",u),alert("Hubo un error al aceptar la recepción.")}},g=async j=>{if(window.confirm("¿Estás seguro de que deseas rechazar esta recepción?"))try{const p=B(D,"db_art_diez_bis",j);await je(p),l(c=>c.filter(b=>b.id!==j)),alert("Recepción rechazada correctamente.")}catch(p){console.error("Error al rechazar la recepción: ",p),alert("Hubo un error al rechazar la recepción.")}},x=s.reduce((j,u)=>{const p=u.comisaria||"Comisaría desconocida";return j[p]=(j[p]||0)+1,j},{}),m=i?s.filter(j=>j.comisaria===i):s;return e.jsx("div",{className:"container-lg ",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-4 mb-4",children:[e.jsx(mt,{recepciones:x,loading:t}),e.jsxs("div",{className:"mt-2 p-3  text-center p-4 bg-transparent bg-opacity-50 rounded-4 shadow-lg mt-5",children:[e.jsx("label",{htmlFor:"filtroComisaria",className:"form-label text-center text-capitalize  text-white ",children:"Filtrar por comisaría"}),e.jsxs("select",{id:"filtroComisaria",className:"form-select fw-light",value:i,onChange:j=>r(j.target.value),children:[e.jsx("option",{value:"",className:"fw-light",children:"Todas"}),Object.keys(x).map((j,u)=>e.jsx("option",{value:j,children:j},u))]})]})]}),e.jsx("div",{className:"col-12 col-md-8 mt-2 mt-md-0",children:e.jsx(ut,{notificaciones:m,loading:t,aceptarRecepcion:d,rechazarRecepcion:g})})]})})},xt=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Recepción Art. 10 Bis"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5",children:["  ",e.jsx(Fe,{Promp:"Recepción Art 10 bis",Promp2:"bi bi-code-slash fs-4 "}),"   "]}),e.jsx(ht,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},bt=()=>e.jsx(e.Fragment,{children:e.jsx(xt,{})}),pt=({recepciones:s,loading:l})=>e.jsx("div",{className:" text-center ",children:l?e.jsx("div",{className:"spinner-border text-white",role:"status"}):Object.keys(s).length>0?e.jsxs("div",{className:"text-center p-4 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("strong",{className:"text-light fs-6 text-capitalize",children:"Personas visibles por comisaría:"}),e.jsx("ul",{className:"list-group mt-3",children:Object.entries(s).map(([t,n],i)=>e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"spinner-grow text-teal spinner-grow-sm",role:"status"}),e.jsx("span",{className:"text-truncate",children:t}),e.jsxs("span",{className:"badge bg-teal",children:[n," personas"]})]},i))})]}):e.jsx("div",{className:"alert bg-light  bg-opacity-75  text-capitalize shadow",role:"alert",children:e.jsx("strong",{children:"No hay recepciones pendientes en este momento."})})}),gt=as,jt=({dataInfo:s,loading:l,actualizarListado:t})=>{const[n,i]=a.useState(""),[r,o]=a.useState(null),[d,g]=a.useState(""),[x,m]=a.useState(!1),[j,u]=a.useState(null),[p,c]=a.useState({}),[b,h]=a.useState(!1),f=y=>gt[y]||"",v=(y,w)=>{const C=new Date(w.seconds*1e3).getTime()+216e5,E=setInterval(()=>{const F=Date.now(),_=C-F;if(_<=0){clearInterval(E),c(G=>({...G,[y]:"00:00:00"}));return}const I=Math.floor(_/36e5),P=Math.floor(_%36e5/6e4),U=Math.floor(_%6e4/1e3),K=`${I.toString().padStart(2,"0")}:${P.toString().padStart(2,"0")}:${U.toString().padStart(2,"0")}`;c(G=>({...G,[y]:K}))},1e3);return E},N=async y=>{for(const w of y){const C=w.fecha_ingreso_validado;if(C&&C.seconds){const E=new Date(C.seconds*1e3);if(new Date().getTime()-E.getTime()>36e5){console.log(`Han pasado más de 1 hora desde la salida de ${w.nombre_apellido}`),alert(`Han pasado más de 1 hora el sistema da como salida a  ${w.nombre_apellido} del Articulo 10 bis`);const I=B(D,"db_art_diez_bis",w.id),P=await De(I);if(P.exists()){const U=B(D,"db_art_diez_bis_desactivados",w.id);await Ne(U,P.data()),await je(I),await le(U,{visualidad:!1,salida_art:Re(),salida_art_usuario:"sistema"}),t(),console.log(`Documento copiado, actualizado y eliminado para ${w.nombre_apellido}`)}}}}};a.useEffect(()=>{s&&s.length>0&&(N(s),s.forEach(y=>{y.fecha_ingreso_validado&&y.fecha_ingreso_validado.seconds&&v(y.id,y.fecha_ingreso_validado)}))},[s]);const S=async()=>{if(!j)return;h(!0);const{id:y,comisaria:w}=j,C=f(w);setTimeout(async()=>{if(d&&d===C)try{const E=JSON.parse(localStorage.getItem("user")),F=B(D,"db_art_diez_bis",y),_=await De(F);if(_.exists()){const I=_.data();await Ne(B(D,"db_art_diez_bis_desactivados",y),{...I,visualidad:!1,salida_art:Re(),salida_art_usuario:(E==null?void 0:E.email)||"sistema"}),await je(F),i(""),alert("Recepción aceptada correctamente."),m(!1),g(""),t()}else alert("El documento no existe.")}catch(E){console.error("Error al aceptar la recepción: ",E),alert("Hubo un error al aceptar la recepción.")}finally{h(!1)}else i(`El código ingresado (${d}) es incorrecto.`),h(!1)},1e3)},k=y=>{u(y),m(!0)};return e.jsxs("div",{className:"container-lg text-center",children:[e.jsxs("div",{className:"row justify-content-center",children:[e.jsx("div",{className:"col-12 d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"w-100 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("h1",{className:"display-4 fw-bold",children:["Salida 10 Bis ",e.jsx("i",{className:"bi bi-people-fill  ms-3 fs-1 "})]}),e.jsx("p",{className:"lead",children:"Administra las recepciones de este  articulo."})]})})}),e.jsx("div",{className:"col-12 col-md-12 col-lg-12 mt-5",children:e.jsx("div",{className:"position-relative",children:l?e.jsxs("div",{className:"text-primary",children:["      ",e.jsx("div",{className:"spinner-border text-white ",role:"status","aria-label":"Cargando...",children:" "})]}):e.jsxs("div",{className:"list-group",children:[n&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:n}),s&&s.length>0?s.map(y=>e.jsxs("div",{className:"list-group-item mb-3 shadow bg-light bg-opacity-75",children:[e.jsx("div",{className:"text-end me-2",children:e.jsxs("span",{className:"badge bg-primary",children:[e.jsx("i",{className:"bi bi-clock titilar me-1"})," ",p[y.id]||"Cargando..."]})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex flex-column w-100 text-truncate",children:[e.jsx("strong",{className:"text-truncate",children:y.nombre_apellido}),e.jsx("span",{className:"text-truncate",children:y.dni})]}),e.jsx("button",{className:"btn btn-teal text-white btn-sm w-25",onClick:()=>k(y),disabled:r===y.id,children:r===y.id?"Procesando...":"Finalizar"})]}),e.jsxs("small",{className:"mt-2",children:[y.selectedLocalidad," -"," ",e.jsx("span",{className:"badge bg-pink",children:y.comisaria})," - ",y.timestamp," -"," ",e.jsx("span",{className:"badge bg-primary",children:y.unidad})]})]},y.id)):e.jsxs("div",{className:"alert bg-light  bg-opacity-75  text-capitalize shadow",role:"alert",children:["No se encontraron Personas en dependencias.",e.jsx("i",{className:"bi bi-hand-thumbs-up ms-2"})]})]})})})]}),x&&j&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Ingresar Código"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>m(!1),"aria-label":"Cerrar"})]}),e.jsxs("div",{className:"modal-body text-dark",children:[e.jsxs("p",{children:["Ingresa el código para la Comisaría ",e.jsx("strong",{children:j.comisaria}),":"]}),e.jsx("input",{type:"text",className:"form-control",value:d,onChange:y=>g(y.target.value),placeholder:"Código"}),n&&e.jsx("div",{className:"alert alert-light text-danger mt-3",role:"alert",children:n})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:S,disabled:!d||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Validando..."]}):"Aceptar"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>m(!1),children:"Cancelar"})]})]})})})]})},ft=()=>{const[s,l]=a.useState(!1),[t,n]=a.useState(""),[i,r]=a.useState({}),[o,d]=a.useState([]),g=async()=>{try{l(!0);const m=_e(W(D,"db_art_diez_bis"),Oe("visualidad","==",!0)),u=(await re(m)).docs.map(c=>({id:c.id,...c.data()}));d(u);const p=u.reduce((c,b)=>{const h=b.comisaria||"Comisaría desconocida";return c[h]=(c[h]||0)+1,c},{});r(p)}catch(m){console.error("Error al obtener datos: ",m)}finally{l(!1)}};a.useEffect(()=>{g()},[]);const x=t?o.filter(m=>(m.comisaria||"").toLowerCase()===t.toLowerCase()):o;return e.jsx("div",{className:"container-lg ",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-4 mb-4",children:[e.jsx(pt,{recepciones:i,loading:s}),e.jsxs("div",{className:"mt-4 p-3 fw-light text-center p-4 bg-transparent bg-opacity-50 rounded-4 shadow-lg ",children:[e.jsx("label",{htmlFor:"filtroComisaria",className:"form-label text-center text-capitalize  text-white ",children:"Filtrar por comisaría"}),e.jsxs("select",{id:"filtroComisaria",className:"form-select fw-light",value:t,onChange:m=>n(m.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),Object.keys(i).map((m,j)=>e.jsx("option",{value:m,children:m},j))]})]})]}),e.jsx("div",{className:"col-12 col-md-8 mt-4 mt-md-0",children:e.jsx(jt,{dataInfo:x,loading:s,actualizarListado:g})})]})})},Nt=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Finalizar Art. 10 Bis"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5",children:["  ",e.jsx(Fe,{Promp:"Finalizar Art 10 bis",Promp2:"bi bi-code-slash fs-4 "}),"   "]}),e.jsx(ft,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},vt=()=>e.jsx(e.Fragment,{children:e.jsx(Nt,{})});function yt(){const[s,l]=a.useState([]),[t,n]=a.useState("noLeidas"),[i,r]=a.useState([]),[o,d]=a.useState([]),[g,x]=a.useState([]),[m,j]=a.useState(null),[u,p]=a.useState(()=>{const A=localStorage.getItem("leidas");return A?JSON.parse(A):{}}),[c,b]=a.useState(!0),[h,f]=a.useState(!1),[v,N]=a.useState(!1),[S,k]=a.useState([]),y=()=>{f(!1),k([])},w=A=>{N(!0),j(A)},C=()=>{N(!1),j(null)};a.useEffect(()=>{const A=()=>{if(v){C(),y();return}h&&y()};return(h||v)&&window.history.pushState({modalOrPreviewOpen:!0},""),window.addEventListener("popstate",A),()=>{window.removeEventListener("popstate",A)}},[h,v]),a.useEffect(()=>{const A=He(W(D,"db_notificaciones"),V=>{const H=V.docs.map(Z=>({id:Z.id,...Z.data()})).sort((Z,z)=>{var R,J;return(((R=z.timestamp)==null?void 0:R.seconds)??0)-(((J=Z.timestamp)==null?void 0:J.seconds)??0)});l(H)});return()=>A()},[]),a.useEffect(()=>{(async()=>{const H=(await re(W(D,"db_personas"))).docs.map(Z=>({id:Z.id,...Z.data()}));r(H),b(!1)})()},[]),a.useEffect(()=>{(async()=>{const H=(await re(W(D,"db_buscados"))).docs.map(Z=>({id:Z.id,...Z.data()}));d(H),b(!1)})()},[]),a.useEffect(()=>{(async()=>{const H=(await re(W(D,"db_vehiculos"))).docs.map(Z=>({id:Z.id,...Z.data()}));x(H),b(!1)})()},[]);const E=A=>{if(!A)return;const V=A.personas_asociadas?Object.keys(A.personas_asociadas).map(R=>({tipo:"persona",...i.find(J=>J.id===R)||A.personas_asociadas[R]})):[],H=A.buscados_asociados?Object.keys(A.buscados_asociados).map(R=>({tipo:"buscado",...o.find(J=>J.id===R)||A.buscados_asociados[R]})):[],Z=A.vehiculos_asociados?Object.keys(A.vehiculos_asociados).map(R=>({tipo:"vehiculo",...g.find(J=>J.id===R)||A.vehiculos_asociados[R]})):[],z=[...V,...H,...Z];if(z.length===0){alert("No hay asociaciones en esta notificación.");return}k(z),f(!0)},F=A=>{p(V=>{const H={...V,[A]:!0};return localStorage.setItem("leidas",JSON.stringify(H)),H})},_=A=>({1:"Novedad",2:"Paradero",3:"Evasión",4:"Prioritaria"})[A]||"No definida",I=A=>/^https?:\/\//.test(A)?A:`https://${A}`,P=s.sort((A,V)=>{var z,R;const H=u[A.id]?1:0,Z=u[V.id]?1:0;return H!==Z?H-Z:(((z=V.timestamp)==null?void 0:z.seconds)??0)-(((R=A.timestamp)==null?void 0:R.seconds)??0)}).filter(A=>t==="leidas"?u[A.id]:t==="noLeidas"?!u[A.id]:!0),U=s.length,K=u?Object.keys(u).length:0,G=U-K;return e.jsx("div",{className:"container my-5",children:c?e.jsx(oe,{leyendaSet:"Cargando Notificaciones"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-center mt-4 ",children:e.jsx("div",{className:"d-flex flex-wrap justify-content-center align-items-center gap-1   ",children:["todas","leidas","noLeidas"].map(A=>{const V=A==="todas"?U:A==="leidas"?K:G,H=A==="todas"?"Todas":A==="leidas"?"Leídas":"No Leídas",Z=A==="todas"?"bi-list-ul":A==="leidas"?"bi-check-circle":"bi-bell-fill";return e.jsxs("button",{className:`btn 
            ${t===A?"btn-light text-dark fw-semibold":"btn-outline-light bg-transparent text-white"} 
            ${A==="todas"?"rounded-start-pill":A==="noLeidas"?"rounded-end-pill":""}`,onClick:()=>n(A),children:[e.jsx("i",{className:`bi me-2 ${Z}`}),H," ",e.jsxs("span",{className:"ms-1",children:["(",V,")"]})]},A)})})}),P.length===0?e.jsx("div",{className:"text-muted my-5 alert d-flex justify-content-center text-center",children:e.jsxs("p",{className:"text-white border border-4 p-4 rounded-pill w-100 bg-dark bg-opacity-25 fs-3",children:[e.jsx("i",{className:`bi me-2 ${t==="todas"?"bi-inbox":t==="leidas"?"bi-check-circle":"bi-bell-fill"}`}),t==="todas"&&e.jsxs(e.Fragment,{children:["No hay notificaciones disponibles."," ",e.jsx("span",{className:"ms-2",role:"img","aria-label":"bandeja",children:"📭"}),e.jsx("br",{}),e.jsx("small",{className:"d-block mt-2 text-white-50",children:"Aún no se han generado notificaciones."})]}),t==="leidas"&&e.jsxs(e.Fragment,{children:["No hay notificaciones leídas."," ",e.jsx("span",{className:"ms-2",role:"img","aria-label":"ojo",children:"👀"}),e.jsx("br",{}),e.jsx("small",{className:"d-block mt-2 text-white-50",children:"Aún no marcaste ninguna como leída."})]}),t==="noLeidas"&&e.jsxs(e.Fragment,{children:["No hay notificaciones sin leer."," ",e.jsx("span",{className:"ms-2",role:"img","aria-label":"mano",children:"✋"}),e.jsx("br",{}),e.jsx("small",{className:"d-block mt-2 text-white-50",children:"¡Todo al día, sin novedades pendientes!"})]})]})}):P.map(A=>{var V;return e.jsxs("div",{className:"card shadow position-relative d-flex gap-3 p-4 my-5 mx-3",children:[!u[A.id]&&e.jsx("button",{className:"btn-close position-absolute top-0 end-0 m-2",onClick:()=>F(A.id)}),e.jsx("img",{src:u[A.id]?"img/Alertas/alertRead.png":"img/Alertas/alert1.gif",alt:"Alerta",className:"position-absolute rounded-circle bg-white p-2 shadow",style:{width:u[A.id]?"75px":"80px",height:u[A.id]?"75px":"80px",top:"-20px",left:"-20px",objectFit:"contain"}}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"40px"},children:[e.jsxs("div",{className:"d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center mb-2 mt-2",children:[e.jsx("h5",{className:"mb-1 text-center text-sm-start w-100 w-sm-auto",children:e.jsx("strong",{children:A.titulo||"Nueva Notificación"})}),A.timestamp&&e.jsx("p",{className:"mb-0 text-muted small d-none d-sm-block",children:new Date(A.timestamp.seconds*1e3).toLocaleString()})]}),e.jsxs("p",{children:[u[A.id]&&e.jsxs("i",{className:"badge text-bg-indigoMui text-white bi bi-check-circle-fill",children:[" ","Esta Notificación fue Leída"]})," ",A.caratula&&e.jsxs(e.Fragment,{children:[parseInt(A.caratula)===1&&e.jsx("span",{className:"badge text-bg-teal text-white shadow-sm",children:_(A.caratula)}),parseInt(A.caratula)===2&&e.jsx("span",{className:"badge text-bg-primaryMuiBlue text-white shadow-sm",children:_(A.caratula)}),parseInt(A.caratula)===3&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2 text-danger"}),e.jsx("span",{className:"badge text-bg-danger text-white shadow-sm",children:_(A.caratula)})]}),parseInt(A.caratula)===4&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2 text-orange"}),e.jsx("span",{className:"badge text-bg-orange text-white shadow-sm",children:_(A.caratula)})]})]})]}),A.contenido&&e.jsx("p",{className:"mb-3",children:A.contenido}),((V=A.enlace)==null?void 0:V.length)>0&&e.jsx("p",{className:"text-center mt-3 d-flex justify-content-center flex-wrap align-items-center  ",children:A.enlace.map((H,Z)=>e.jsxs("a",{href:I(H),target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none d-flex align-items-center gap-2 rounded-pill ",style:{maxWidth:"250px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:[e.jsx("i",{className:"bi bi-browser-chrome titilar",style:{fontSize:"20px"}}),H]},Z))}),A.personas_asociadas&&Object.keys(A.personas_asociadas).length>0?e.jsx("div",{className:"mt-3 d-flex justify-content-center flex-wrap align-items-center",children:Object.entries(A.personas_asociadas).map(([H,Z])=>{var R;const z=i.find(J=>J.id===H)||Z;return e.jsx("div",{className:"mx-2  animate__fadeInUp animate__animated",onClick:()=>E(A),style:{cursor:"pointer"},children:e.jsxs("div",{className:"d-flex align-items-center gap-2 border border-light rounded shadow-sm p-2 bg-primary bg-opacity-25",style:{minWidth:"150px"},children:[(z==null?void 0:z.base64)&&e.jsx("img",{src:((R=z.base64)==null?void 0:R.trim())||"svg/undraw_male_avatar_g98dG.svg",alt:z.nombre_apellido,className:"rounded-circle",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize fw-semibold",children:Z.nombre_apellido})]})},`persona-${H}`)})}):e.jsx("span",{className:"text-danger text-center d-block"}),A.buscados_asociados&&Object.keys(A.buscados_asociados).length>0?e.jsx("div",{className:"mt-3 d-flex justify-content-center flex-wrap align-items-center gap-2 ",children:Object.entries(A.buscados_asociados).map(([H,Z])=>{var R;const z=o.find(J=>J.id===H)||Z;return e.jsx("div",{className:"mx-2  animate__fadeInUp animate__animated",onClick:()=>E(A),style:{cursor:"pointer"},children:e.jsxs("div",{className:"d-flex align-items-center gap-2 border border-light rounded shadow-sm p-2 bg-teal bg-opacity-25",style:{minWidth:"160px"},children:[e.jsx("img",{src:((R=z==null?void 0:z.base64)==null?void 0:R.trim())||"svg/undraw_male_avatar_g98dG.svg",alt:(z==null?void 0:z.nombre_apellido)||"Sin nombre",className:"rounded-circle",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize fw-semibold",children:(z==null?void 0:z.nombre_apellido)||"Desconocido"})]})},`buscado-${H}`)})}):e.jsx("span",{className:"text-danger text-center d-block"}),A.vehiculos_asociados&&Object.keys(A.vehiculos_asociados).length>0?e.jsx("div",{className:"mt-3 d-flex justify-content-center flex-wrap align-items-center gap-2",children:Object.entries(A.vehiculos_asociados).map(([H,Z])=>{const z=g.find(J=>J.id===H)||Z,R=J=>{switch(J){case"auto":return"🚗";case"moto":return"🏍️";case"camioneta":return"🚙";case"camion":return"🚚";case"colectivo":return"🚌";case"cuatriciclo":return"🏍️";case"tractor":return"🚜";case"ambulancia":return"🚑";case"policial":return"🚓";case"bomberos":return"🚒";default:return"🚘"}};return e.jsx("div",{className:"mx-2  animate__fadeInUp animate__animated",onClick:()=>E(A),style:{cursor:"pointer"},children:e.jsxs("div",{className:"d-flex align-items-center gap-2 border border-light rounded shadow-sm p-2 bg-orangeDb bg-opacity-25",style:{minWidth:"180px"},children:[e.jsx("div",{className:"rounded-circle bg-light d-flex align-items-center justify-content-center",style:{width:"40px",height:"40px",fontSize:"1.5rem"},children:R(z==null?void 0:z.tipo)}),e.jsxs("div",{className:"d-flex flex-column text-start",children:[e.jsx("span",{className:"fw-semibold text-uppercase",children:(z==null?void 0:z.dominio)||"Sin dominio"}),e.jsxs("small",{className:"text-capitalize",children:[(z==null?void 0:z.marca)||"Marca desconocida"," -"," ",(z==null?void 0:z.modelo)||"Modelo desconocido"]})]})]})},`vehiculo-${H}`)})}):e.jsx("span",{className:"text-danger text-center d-block"})]})]},A.id)}),h&&e.jsx("div",{className:"modal fade show d-block bg-dark animate__animated animate__fadeIn",tabIndex:"-1",role:"dialog","aria-modal":"true",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable",children:e.jsxs("div",{className:"modal-content bg-light text-dark rounded-4 shadow-lg border-0",children:[e.jsxs("div",{style:{position:"absolute",top:"-5px",left:"50%",transform:"translateX(-50%)",color:"white",backgroundColor:"rgba(0,0,0,0.5)",padding:"8px 16px",borderRadius:"12px",fontSize:"0.9rem",zIndex:10,pointerEvents:"none"},children:["Pulsa para Ampliar ",e.jsx("span",{className:"titilar ",children:"👆"})]}),e.jsxs("div",{className:"modal-header border-0 ",children:[e.jsxs("h5",{className:"modal-title fw-bold",children:["Asociaciones (",S.length,")"]}),e.jsx("button",{type:"button",className:"btn-close",onClick:y,"aria-label":"Cerrar"})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"row g-3 justify-content-center",children:S.length>0?S.map((A,V)=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 animate__animated animate__fadeInUp",children:e.jsxs("div",{className:"card border-0 shadow-sm text-center bg-gradiante2 bg-opacity-75 text-light p-2 h-100",children:[e.jsxs("div",{className:"position-relative",children:[A.base64?e.jsx("img",{src:A.base64.trim(),alt:A.nombre_apellido||A.dominio||"Asociado",className:"card-img-top rounded-3",style:{height:"160px",objectFit:"cover"},onClick:()=>w(A.base64.trim())}):A.tipo?e.jsx("div",{className:"d-flex align-items-center justify-content-center rounded-3",style:{height:"160px",backgroundColor:"#f0ebf7",fontSize:"64px",cursor:"pointer"},onClick:()=>j(A),children:(()=>{switch(A.tipo){case"auto":return"🚗";case"moto":return"🏍️";case"camioneta":return"🚙";case"camion":return"🚚";case"colectivo":return"🚌";case"tractor":return"🚜";case"ambulancia":return"🚑";case"policial":return"🚓";case"bomberos":return"🚒";default:return"🚘"}})()}):e.jsx("img",{src:"img/default-user.svg",alt:"Sin imagen",className:"card-img-top rounded-3",style:{height:"160px",objectFit:"cover",backgroundColor:"#8C57FF"},onClick:()=>w("img/default-user.svg")}),e.jsx("span",{className:"badge position-absolute top-0 start-0 m-2 bg-light text-dark fw-semibold text-capitalize",children:A.tipo})]}),e.jsxs("div",{className:"card-body",children:[A.nombre_apellido&&e.jsx("h6",{className:"fw-bold text-orangeUi text-capitalize mb-1",children:A.nombre_apellido}),A.dominio&&e.jsx("h6",{className:"fw-bold text-warning mb-1",children:A.dominio}),A.documento&&e.jsxs("p",{className:"mb-1 small",children:[e.jsx("strong",{children:"Dni:"})," ",A.documento]}),A.marca&&A.modelo&&e.jsxs("p",{className:"mb-1 small",children:[e.jsx("strong",{children:"Vehículo:"})," ",A.marca," - ",A.modelo]})]})]})},`${A.id||V}-${A.tipo}`)):e.jsx("div",{className:"text-center text-muted py-3",children:e.jsx("em",{children:"No hay asociaciones registradas."})})})}),e.jsx("div",{className:"modal-footer border-0",children:e.jsx("button",{className:"btn btn-danger text-white  px-4",onClick:y,children:"Cerrar"})})]})})}),v&&e.jsxs("div",{className:"modal fade show d-block bg-dark  animate__animated animate__zoomIn",onClick:C,style:{cursor:"pointer"},children:["    ",e.jsxs("div",{style:{position:"absolute",top:"20px",left:"50%",transform:"translateX(-50%)",color:"white",backgroundColor:"rgba(0,0,0,0.5)",padding:"8px 16px",borderRadius:"12px",fontSize:"0.9rem",zIndex:10,pointerEvents:"none"},children:["Pulsa cualquier lugar para cerrar ",e.jsx("span",{className:"girar mx-2 titilar",children:"👆🏻"})]}),e.jsx("div",{className:"d-flex align-items-center justify-content-center vh-100 ",children:e.jsx("img",{src:typeof m=="string"?m:"img/default-user.svg",alt:"Vista ampliada",className:"img-fluid rounded shadow-lg ",style:{maxHeight:"90vh",maxWidth:"90vw",objectFit:"contain"}})})]})]})})}const wt=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Notificaciones - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5",children:["  ",e.jsx(Fe,{Promp:"Notificaciones",Promp2:"bi bi-megaphone fs-4 "}),"   "]}),e.jsx(yt,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},Ct=()=>e.jsx(e.Fragment,{children:e.jsx(wt,{})}),Rs=({onImageSave:s})=>{const[l,t]=a.useState(!1),[n,i]=a.useState(null),[r,o]=a.useState(""),d=a.useRef(null),[g,x]=a.useState(!1),[m,j]=a.useState({x:0,y:0}),[u,p]=a.useState({x:0,y:0}),[c,b]=a.useState(1),h=a.useRef(null),f=C=>{x(!0);const{offsetX:E,offsetY:F}=C.nativeEvent;p({x:E,y:F})},v=C=>{if(!g||!n)return;const{offsetX:E,offsetY:F}=C.nativeEvent;j(_=>({x:_.x+(E-u.x),y:_.y+(F-u.y)})),p({x:E,y:F})},N=()=>{x(!1)},S=()=>{t(!1),o(""),i(null),j({x:0,y:0}),b(1);const C=document.getElementById("file-input");C&&(C.value=""),h.current&&(URL.revokeObjectURL(h.current),h.current=null)},k=()=>t(!0),y=C=>{const E=C.target.files[0];if(E){if(!E.type.startsWith("image/")){o("Por favor, selecciona un archivo de imagen.");return}if(E.size>5*1024*1024){o("La imagen debe ser menor de 5 MB.");return}const F=URL.createObjectURL(E);h.current=F,i(F),o("")}},w=()=>{if(!n||!d.current){o("Por favor, selecciona una imagen antes de guardar.");return}const C=d.current,E=C.width,F=C.height,_=document.createElement("canvas");_.width=E,_.height=F;const I=_.getContext("2d"),P=new Image;P.src=n,P.onload=()=>{I.clearRect(0,0,E,F),I.drawImage(P,m.x,m.y,P.width*c,P.height*c);const U=_.toDataURL("image/jpeg",.92);s(U),S()}};return a.useEffect(()=>{if(n&&d.current){const C=d.current,E=C.getContext("2d"),F=new Image;F.src=n,F.onload=()=>{E.clearRect(0,0,C.width,C.height),E.drawImage(F,m.x,m.y,F.width*c,F.height*c)}}},[n,m,c]),a.useEffect(()=>{const C=d.current,E=F=>{if(F.preventDefault(),!n)return;const _=1.1,I=F.deltaY<0?c*_:c/_;b(Math.max(I,.1))};if(C)return C.addEventListener("wheel",E,{passive:!1}),()=>{C.removeEventListener("wheel",E)}},[n,c]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3",children:e.jsx("button",{type:"button",onClick:k,className:"btn shadow-sm text-light  ",title:"Crear nuevo",children:e.jsx("i",{className:"bi bi-plus-circle-fill display-1  "})})}),e.jsx("div",{className:`modal fade  bg-dark ${l?"show":""}`,style:{display:l?"block":"none"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!l,children:e.jsx("div",{className:"modal-dialog modal-lg",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"modal-header bg-gradiante2",children:e.jsx("h5",{className:"modal-title text-light  ",id:"modalLabel ",children:"Selecciona tu imagen  / Edita "})}),e.jsxs("div",{className:"modal-body",children:[e.jsx("input",{id:"file-input",type:"file",className:"form-control",accept:"image/*",onChange:y}),n&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("canvas",{ref:d,className:"shadow",onMouseDown:f,onMouseMove:v,onMouseUp:N,onMouseLeave:N,width:500,height:500,style:{border:"1px solid black",cursor:g?"grabbing":"grab"}})}),e.jsxs("p",{className:"alert alert-light text-redUi1 fs-6 text-center mt-4 d-flex justify-content-center align-items-center gap-2",children:[e.jsx("span",{className:"spinner-grow text-pink",style:{width:"1rem",height:"1rem"},role:"status"}),"Para hacer zoom en la imagen, simplemente usa el scroll (la rueda) de tu mouse. 🖲️"]}),e.jsxs("p",{className:"alert alert-light text-indigoMui fs-6 text-center mt-4 d-flex justify-content-center align-items-center gap-2",children:[e.jsx("span",{className:"spinner-grow text-indigoMui",style:{width:"1rem",height:"1rem"},role:"status"}),"Mantén presionado el botón del mouse para arrastrar la imagen. 🖱️"]})]}),r&&e.jsx("div",{className:"mt-2 text-danger",children:r})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:S,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn text-white bg-indigoMui",onClick:w,children:"Guardar Imagen"})]})]})})}),e.jsx("div",{className:`modal-backdrop fade ${l?"show":""}`,style:{display:l?"block":"none"}})]})},St=({onSubmit:s,savedImage:l,resetImage:t,formRef:n})=>{const[i,r]=a.useState(()=>{const c=localStorage.getItem("formData");return c?JSON.parse(c):{nombreApellido:"",documento:"",sexo:"",entidad:"",numeroContacto:"911",descripcionFisica:"",motivoCaptura:"",imagen:"",alerta:!1,paradero:!1,captura:!1,prioridad:1,alertaParaderoCaptura:""}}),[o,d]=a.useState({}),[g,x]=a.useState(!1);a.useEffect(()=>{localStorage.setItem("formData",JSON.stringify(i))},[i]);const m=({target:{id:c,value:b,type:h,checked:f}})=>{r(v=>{let N={...v,[c]:h==="checkbox"?f:b};if(c==="alertaParaderoCaptura")switch(b){case"paradero":N={...N,prioridad:2,paradero:!0,alerta:!1};break;case"evadido":N={...N,prioridad:3,captura:!0,alerta:!0};break;case"prioritaria":N={...N,prioridad:4,alerta:!1};break;default:N={...N,prioridad:1,paradero:!1,alerta:!1};break}return N}),d(v=>({...v,[c]:""}))},j=()=>{const c={};return l?(i.nombreApellido.match(/[A-Za-zÑñÁáÉéÍíÓóÚú\s]+/)||(c.nombreApellido="Ingrese solo letras y espacios."),i.documento.length<6&&(c.documento="El número de documento debe tener al menos 6 caracteres."),d(c),Object.keys(c).length===0):(alert("Debes cargar una imagen antes de enviar el formulario."),!1)},u=async c=>{if(c.preventDefault(),!j())return;if(!window.confirm("¿Estás seguro de que deseas enviar este formulario?")){alert("El envío ha sido cancelado.");return}x(!0);try{const h={...i,imagen:l};if(typeof s=="function")await s(h),alert("Formulario enviado correctamente.");else throw new Error("onSubmit no es una función válida")}catch(h){console.error(h),alert("Hubo un error al enviar el formulario.")}finally{x(!1),p()}},p=()=>{localStorage.removeItem("formData"),r({nombreApellido:"",documento:"",sexo:"",entidad:"",numeroContacto:"911",descripcionFisica:"",motivoCaptura:"",imagen:"",alerta:!1,paradero:!1,prioridad:1,alertaParaderoCaptura:""}),d({}),t()};return e.jsxs("div",{className:" mt-3",children:[g&&e.jsx(oe,{})," ",e.jsxs("form",{ref:n,onSubmit:u,children:[e.jsx(Ze,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-person-fill text-greenUi me-3 p-1"})," Nombre y Apellido"]}),id:"nombreApellido",type:"text",value:i.nombreApellido,error:o.nombreApellido,onChange:m,required:!0,className:"text-center"}),e.jsxs("div",{className:"row  text-center",children:[e.jsx(Ze,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-file-earmark-person text-greenUi me-3 p-1"})," Número de Documento"]}),id:"documento",type:"number",value:i.documento,error:o.documento,onChange:m,className:"col"}),e.jsx(zs,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-gender-ambiguous text-greenUi me-3 p-1"})," Sexo"]}),id:"sexo",value:i.sexo,options:[{label:"Seleccione",value:""},{label:"Masculino 👨",value:"masculino"},{label:"Femenino 👩",value:"femenino"},{label:"Otros 👭🏻 ",value:"otro"}],onChange:m,className:"col"})]}),e.jsxs("div",{className:"row  text-center",children:[e.jsx(Ze,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-building text-greenUi me-3 p-1"})," Entidad Solicita Captura"]}),id:"entidad",type:"text",value:i.entidad,onChange:m,className:"col"}),e.jsx(Ze,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-telephone text-greenUi me-3 p-1"})," Número de Contacto"]}),id:"numeroContacto",type:"tel",value:i.numeroContacto,error:o.numeroContacto,onChange:m,className:"col"})]}),e.jsx(Ts,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-pencil text-greenUi me-3 p-1"})," Datos de la Persona / Info Adicional"]}),id:"descripcionFisica",value:i.descripcionFisica,onChange:m,className:"text-center"}),e.jsx(Ts,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-pencil-square text-greenUi me-3 p-1"})," Motivo  Captura "]}),id:"motivoCaptura",value:i.motivoCaptura,onChange:m,className:"text-center"}),e.jsx(zs,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill p-1 text-white me-3 titilar "})," Selecciona una Tipo de Alerta"]}),id:"alertaParaderoCaptura",value:i.alertaParaderoCaptura,options:[{label:"Normal",value:"normal"},{label:"Búsqueda Paradero 🔍 ",value:"paradero"},{label:"Alerta Evadido 🚨",value:"evadido"},{label:"Captura Prioritaria ⚠️",value:"prioritaria"}],onChange:m}),e.jsxs("div",{className:"d-flex justify-content-end pt-4  mt-3",children:[e.jsxs("button",{type:"button",onClick:p,className:"btn btn-danger text-light shadow",children:[e.jsx("i",{className:"bi bi-x-circle "})," Limpiar Formulario"]}),e.jsxs("button",{type:"submit",className:"btn btn-primary2 shadow ms-2",disabled:g,children:[e.jsx("i",{className:"bi bi-send"})," Enviar Formulario"]})]})]})]})},Ze=({label:s,id:l,type:t="text",value:n,error:i,onChange:r,className:o="",required:d=!1})=>e.jsxs("div",{className:`mb-4 ${o}`,children:[e.jsx("span",{htmlFor:l,className:"input-group-text bg-light bg-opacity-25 border-white  text-white text-center mb-1",children:s}),e.jsx("input",{type:t,className:`form-control bg-transparent text-white border-white ${i?"is-invalid":""}`,id:l,value:n,onChange:r,required:d}),e.jsx("div",{className:"invalid-feedback text-light",children:i})]}),zs=({label:s,id:l,value:t,options:n,onChange:i,className:r=""})=>e.jsxs("div",{className:`mb-5 ${r} text-center`,children:[e.jsx("span",{htmlFor:l,className:`input-group-text bg-light bg-opacity-25 text-white text-center d-flex justify-content-center shadow ${l==="alertaParaderoCaptura"?"bg-danger text-white":""}`,children:s}),e.jsx("select",{className:"form-select text-center",id:l,value:t,onChange:i,style:{color:"white",backgroundColor:"transparent",borderColor:"white"},children:n.map(({label:o,value:d})=>e.jsx("option",{value:d,style:{backgroundColor:"#5F3F8B",color:"white"},children:o},d))})]}),Ts=({label:s,id:l,value:t,onChange:n,className:i=""})=>e.jsxs("div",{className:`form-floating mb-4 ${i}`,children:[e.jsx("textarea",{className:"form-control bg-transparent text-white border-white",id:l,value:t,onChange:n,style:{height:"100px"},placeholder:" "}),e.jsx("label",{htmlFor:l,className:"text-",children:s})]}),kt=()=>{const[s,l]=a.useState(null),[t,n]=a.useState(!1),[i,r]=a.useState(!1),[o,d]=a.useState(!1),g=a.useRef(null);a.useEffect(()=>{const p=()=>{n(window.innerWidth<576)};return window.addEventListener("resize",p),p(),()=>window.removeEventListener("resize",p)},[]);const x=p=>{l(p),r(!1)},m=async p=>{var v;const c=()=>{const N=new Date,S=String(N.getDate()).padStart(2,"0"),k=String(N.getMonth()+1).padStart(2,"0"),y=String(N.getFullYear()).slice(-2);return`${S}/${k}/${y}`},h=(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null})(),f={documento:p.documento,nombre_apellido:p.nombreApellido.toLowerCase(),sexo:p.sexo,entidad:p.entidad,numero_contacto:p.numeroContacto,descripcion_fisica:p.descripcionFisica,motivo_captura:p.motivoCaptura,base64:s,date:c(),usuario:h?h.email:"Desconocido",prioridad:p.prioridad,alerta:p.alerta||!1,paradero:p.paradero||!1};try{await Pe(W(D,"db_personas"),f),console.log("Datos guardados en Firebase:",f),(v=g.current)==null||v.reset(),j()}catch(N){console.error("Error al guardar los datos en Firebase:",N)}},j=()=>{l(null),r(!1),d(!1)},u=p=>{const c=p.target.files[0];if(c){const b=new FileReader;b.onloadend=()=>{const h=new Image;h.onload=()=>{const f=document.createElement("canvas"),v=f.getContext("2d"),N=500,S=500;let k=h.width,y=h.height;k>y?k>N&&(y*=N/k,k=N):y>S&&(k*=S/y,y=S),f.width=k,f.height=y,v.drawImage(h,0,0,k,y);const w=f.toDataURL("image/jpeg");l(w),r(!1)},h.src=b.result},b.readAsDataURL(c)}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"container-lg",children:o?e.jsx("div",{className:"container",children:e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10 col-lg-8 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h1",{className:"display-5 fw-bold",children:"Formulario"}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:"bi bi-ui-checks fs-4 text-dark"})})]}),e.jsx("p",{className:"mt-2 text-white",children:"Gestioná tus registros de ingreso."}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 col-md-5 mb-4",children:e.jsxs("div",{className:"text-center position-relative",children:[!i&&s&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-secondaryM text-purple position-absolute end-0 top-0 mt-5 m-2","aria-label":"Editar",onClick:()=>{l(null),r(!0)},children:e.jsx("i",{className:"bi bi-pencil-fill"})}),e.jsx("h5",{className:"text-light mt-4",children:"Vista previa  "}),e.jsx("img",{src:s,alt:"Captura subida",className:"img-fluid rounded-4 border border-light shadow mt-2",style:{maxWidth:"100%"}})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("h5",{className:"text-light",children:"Subí una nueva imagen"}),t?e.jsx("div",{className:"mb-3 w-100 px-3",children:e.jsx("input",{type:"file",className:"form-control bg-gradiante2 text-white",onChange:p=>{u(p)}})}):e.jsx(Rs,{onImageSave:p=>{x(p)}})]})]})}),e.jsx("div",{className:"col-12 col-md-7",children:e.jsx(St,{onSubmit:m,savedImage:s,resetImage:j,formRef:g})})]})]})})})}):e.jsx("div",{className:"w-100 text-white",children:e.jsxs("div",{className:"text-center py-5 px-3 bg-dark bg-opacity-25 rounded-4 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 display-5 fw-bold text-white",children:[e.jsx("i",{className:"bi bi-image me-2"}),"Selecciona imagen para comenzar"]}),e.jsx("div",{className:"d-flex justify-content-center align-items-center gap-3 flex-column flex-md-row",children:t?e.jsxs("div",{className:"mb-3 w-100 px-3",children:[e.jsxs("label",{className:"form-label fw-semibold text-white",children:[e.jsx("i",{className:"bi bi-upload me-2"}),"Subir solo imagen"]}),e.jsx("input",{type:"file",className:"form-control bg-light text-dark rounded-3 shadow-sm",onChange:p=>{u(p),d(!0)}})]}):e.jsx("div",{className:"p-3 bg-body bg-opacity-10 rounded-4 shadow-sm",children:e.jsx(Rs,{onImageSave:p=>{x(p),d(!0)}})})})]})})})})},_t=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Formulario - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsx("div",{className:"my-5",children:e.jsx(kt,{})})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},Et=()=>e.jsx(e.Fragment,{children:e.jsx(_t,{})}),Ft=()=>{const[s,l]=a.useState(null),[t,n]=a.useState([]),[i,r]=a.useState([]),o=g=>{const x=g.target.files[0];if(l(null),r([]),x){if(!x.name.endsWith(".csv")){l("Solo se permiten archivos CSV.");return}const m=new FileReader;m.onload=j=>{const u=j.target.result,p=u.includes(";")?";":",",b=u.split(`
`).map(v=>v.trim()).map(v=>v.split(p)),h=[],f=[];b.forEach((v,N)=>{if(v.some(C=>C.trim()===""))return;const k=v[0],y=v[1],w=v[2];isNaN(k)||k.length!==8?f.push({rowIndex:N+1,error:"El primer valor debe ser numérico y tener 8 caracteres."}):typeof y!="string"||y.trim()===""?f.push({rowIndex:N+1,error:"La segunda columna debe ser texto."}):d(w)?h.push(v):f.push({rowIndex:N+1,error:"La tercera columna debe tener formato de correo electrónico."})}),f.length>0&&r(f),h.length===0&&f.length===0&&l("No se encontraron filas válidas."),n(h)},m.onerror=()=>{l("Ocurrió un error al leer el archivo.")},m.readAsText(x)}},d=g=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(g);return e.jsx("div",{className:"container-lg mt-5 mt-sm-5 mt-md-0 mt-lg-0 position-relative min-vh-100",children:e.jsxs("div",{className:"card shadow-lg rounded-4 position-relative",style:{zIndex:10},children:[e.jsx("div",{className:"card-header bg-orangeW text-dark shadow-sm rounded-top-4",children:e.jsxs("h4",{className:"fw-semibold p-2",children:["Subir Archivo CSV ",e.jsx("i",{className:"bi bi-filetype-csv ms-2"})]})}),e.jsxs("div",{className:"card-body bg-light rounded-bottom-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"csvFile",className:"form-label",children:"Selecciona un archivo CSV para subir:"}),e.jsx("input",{type:"file",className:"form-control",id:"csvFile",accept:".csv",onChange:o})]}),s&&e.jsx("div",{className:"alert alert-danger",children:s}),i.length>0&&e.jsxs("div",{className:"alert alert-danger bg-redW shadow my-5",children:[e.jsxs("h6",{children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill me-2"}),"Errores en las siguientes filas:"]}),e.jsx("ul",{children:i.map((g,x)=>e.jsxs("li",{children:["Fila ",g.rowIndex,": ",g.error]},x))})]}),t.length>0&&e.jsxs("div",{className:"my-4",children:[e.jsxs("span",{className:"fw-semibold border border-2 rounded-pill p-2 px-5 border-teal bg-greenW2 text-dark d-inline-flex align-items-center",children:[e.jsx("i",{className:"me-3 bi bi-person-lines-fill"}),"Contenido del archivo:"]}),e.jsx("div",{className:"table-responsive text-center bg-greenW2 mt-3 rounded-3 shadow-sm",children:e.jsxs("table",{className:"table table-striped mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"DNI"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Correo"}),e.jsx("th",{children:"Dependencia"})]})}),e.jsx("tbody",{children:t.map((g,x)=>e.jsx("tr",{children:g.map((m,j)=>e.jsx("td",{children:m},j))},x))})]})})]})]})]})})};cs.register(ds,ms,us,Qs,hs,xs,Xs,bs,ps);const Dt=(s,l)=>{const t=parseInt(s.replace("#",""),16),n=Math.max((t>>16)-l,0),i=Math.max((t>>8&255)-l,0),r=Math.max((t&255)-l,0);return`#${(n<<16|i<<8|r).toString(16).padStart(6,"0")}`},At=({totalCapturas:s,totalPrioridadNormal:l,totalParadero:t,totalEvasiones:n,totalPrioritaria:i,totalEvasionesCapturados:r})=>{const[o,d]=a.useState("bar"),x=["#03dac6","#ffef62","#f73378","#2196f3"],m=()=>{const b={labels:["Capturas Normales","Capturas Prioritarias","Evasiones","Búsqueda Paradero"],datasets:[]};switch(o){case"line":b.datasets.push({label:"Cantidad",data:[l,i,n,t],backgroundColor:"rgba(245, 245, 245, 0.2)",borderColor:"#ffffff",pointBackgroundColor:"#ffffff",pointBorderColor:"#fff",borderWidth:2,tension:.3,fill:!0});break;case"pie":case"doughnut":b.datasets.push({label:"Cantidad",data:[l,i,n,t],backgroundColor:x,borderColor:"#fff",borderWidth:2,hoverOffset:10});break;default:b.datasets.push({label:"Cantidad",data:[l,i,n,t],backgroundColor:x,borderColor:x.map(h=>Dt(h,40)),borderWidth:1});break}return b},j={datasets:[{label:"Capturas y Evasiones",data:[{x:1,y:s},{x:2,y:t},{x:3,y:n},{x:4,y:i},{x:5,y:r}],backgroundColor:"#ffffff"}]},p={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"#ffffff"}},title:{display:!0,text:"Informe Gráfico de Capturas y Evasiones",color:"#ffffff",font:{size:20}},tooltip:{bodyColor:"#ffffff",titleColor:"#ffffff"}},animation:{duration:1e3,easing:"easeOutBounce"},scales:o==="pie"||o==="doughnut"?{}:{x:{ticks:{color:"#ffffff"},grid:{color:"rgba(255, 255, 255, 0.2)"}},y:{beginAtZero:!0,ticks:{color:"#ffffff",stepSize:1},grid:{color:"rgba(255, 255, 255, 0.2)"}}}},c=b=>{d(b.target.value)};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-center my-5 text-light",children:"Estadísticas / Gráficos"}),e.jsx("div",{className:"row justify-content-center mb-4",children:e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"input-group input-group-sm shadow-sm",children:[e.jsx("span",{className:"input-group-text bg-dark bg-opacity-50 text-light",children:"Tipo de gráfico"}),e.jsxs("select",{className:"form-select text-center",onChange:c,value:o,children:[e.jsx("option",{value:"bar",children:"Barra"}),e.jsx("option",{value:"line",children:"Línea"}),e.jsx("option",{value:"pie",children:"Pastel"}),e.jsx("option",{value:"doughnut",children:"Doughnut"}),e.jsx("option",{value:"scatter",children:"Dispersión"})]})]})})}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10",style:{height:"400px"},children:o==="scatter"?e.jsx(Ks,{data:j,options:p}):o==="bar"?e.jsx(gs,{data:m(),options:p}):o==="line"?e.jsx(es,{data:m(),options:p}):o==="pie"?e.jsx(js,{data:m(),options:p}):o==="doughnut"?e.jsx(fs,{data:m(),options:p}):null})})]})},ea=({showModalLink:s,setShowModalLink:l,selectedNotifId:t,setNewLink:n,newLink:i,setNotificaciones:r})=>{const[o,d]=a.useState(!0),[g,x]=a.useState(""),m=()=>{l(!1),n(""),d(!0),x("")},j=async()=>{if(!i){d(!1),x("Por favor, ingresa un enlace.");return}if(!t){d(!1),x("Por favor, selecciona una notificación.");return}try{await le(B(D,"db_notificaciones",t),{enlace:Me(i)}),n(""),d(!0),x(""),alert("Enlace agregado correctamente."),m()}catch(u){console.error("Error al agregar el enlace:",u),alert("Hubo un error al agregar el enlace.")}};return s&&e.jsx("div",{className:"modal fade show bg-dark ",style:{display:"block"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!s,children:e.jsx("div",{className:"modal-dialog ",children:e.jsxs("div",{className:"modal-content p-3 bg-gradient rounded-4 shadow-lg border-0",children:[e.jsxs("div",{className:"modal-header border-0",children:[e.jsx("h5",{className:"modal-title text-dark",id:"modalLabel ",children:"Agregar Enlace a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:m,"aria-label":"Cerrar",disabled:!1})]}),e.jsx("div",{className:"modal-body bg-light rounded-4 p-4 shadow-sm",children:e.jsxs("div",{className:"form-floating text-dark",children:[e.jsx("input",{type:"url",id:"link",className:`form-control ${o?"":"is-invalid"}`,placeholder:"https://example.com",value:i,onChange:u=>n(u.target.value),disabled:!1}),e.jsx("label",{htmlFor:"link",children:"Ingrese el enlace"}),!o&&e.jsx("div",{className:"invalid-feedback",children:g})]})}),e.jsxs("div",{className:"modal-footer bg-light border-0",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:m,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:j,disabled:!1,children:"Guardar Enlace"})]})]})})})},Mt=({showModalNot:s,closeModalNot:l})=>{const t=Ve(),[n,i]=a.useState(""),[r,o]=a.useState(""),[d,g]=a.useState("1"),[x,m]=a.useState(""),[j,u]=a.useState(!1),p=()=>{const h=new Date,f=String(h.getDate()).padStart(2,"0"),v=String(h.getMonth()+1).padStart(2,"0"),N=h.getFullYear().toString().slice(-2);return`${f}/${v}/${N}`};a.useEffect(()=>{if(t.pathname==="/panelcontrol"){const h=()=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",h),()=>{window.removeEventListener("popstate",h)}}},[t,l]);const c=async h=>{if(h.preventDefault(),n.trim()===""){m("El mensaje no puede estar vacío.");return}if(n.length>280){m("El mensaje no puede exceder los 280 caracteres.");return}if(d===""){m("Por favor, selecciona una carátula.");return}m(""),u(!0);try{await Pe(W(D,"db_notificaciones"),{titulo:r,contenido:n,timestamp:Re(),leido:!1,fecha:p(),caratula:d}),o(""),i(""),g("1"),l()}catch(f){console.error("Error al enviar notificación: ",f),m("Error al enviar la notificación. Inténtalo de nuevo.")}finally{u(!1)}},b=()=>{i(""),g("1"),m(""),l()};return e.jsx("div",{className:`modal bg-dark text-white ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header text-center  bg-gradiante2 bg-opacity-50 ",children:[e.jsxs("h3",{className:"modal-title text-center ",id:"modalTitle",children:["Crear Notificación  ",e.jsx("i",{className:"bi bi-envelope-plus ms-2 titilar ",style:{fontSize:"1.8rem"}})]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:b})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsxs("form",{onSubmit:c,children:[e.jsx("div",{className:"mb-3 text-center",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control shadow-sm",placeholder:"Escribe el mensaje aquí",id:"titulo",value:r,onChange:h=>o(h.target.value)}),e.jsx("label",{className:"text-blue",children:"Titulo de la Notificación"})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control shadow-sm",placeholder:"Escribe el mensaje aquí",id:"mensaje",value:n,onChange:h=>i(h.target.value),style:{minHeight:"150px"}}),e.jsx("label",{className:"text-blue",children:"Mensaje"})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsx("div",{className:"col-md",children:e.jsxs("div",{className:"form-floating shadow-sm",children:[e.jsxs("select",{className:"form-select text-center",id:"floatingSelectGrid",value:d,onChange:h=>g(h.target.value),children:[e.jsx("option",{value:"1",children:"Informativa "}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 👮🏻"}),e.jsx("option",{value:"4",children:"Prioritaria ⭐"})]}),e.jsx("label",{className:"text-blue",children:"Selecciona Tipo de Notificación"})]})})}),x&&e.jsx("div",{className:"alert alert-danger mt-5",children:x}),j?e.jsx(oe,{}):e.jsx("div",{className:"d-grid",children:e.jsx("button",{type:"submit",className:"btn bg-primary border-white border-3 text-white rounded-pill position-absolute top-100 start-50 shadow-sm translate-middle",children:e.jsxs("span",{children:["Crear Notificación ",e.jsx("i",{className:"bi bi-send-check-fill ms-2 text-white"})]})})})]})})})]})})})},sa=({Date1:s,Date2:l,onCerrar:t,color:n})=>{const[i,r]=a.useState(!1),o=()=>{r(!0)};return e.jsxs("div",{className:`alert alert-${n} text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-light position-relative d-flex align-items-start gap-3`,children:[e.jsx("button",{type:"button",className:"btn-close  btn-close-white  position-absolute top-0 end-0 m-2","aria-label":"Cerrar",onClick:t}),e.jsx("img",{src:"img/ayuda.gif",alt:"Ayuda",style:{width:"80px",height:"70px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-secondaryM border border-2 d-none d-sm-table-cell"}),e.jsxs("div",{children:[e.jsx("strong",{children:"Hola, soy el asistente de ayuda. Voy a guiarte en el proceso de creación de una notificación."}),e.jsxs("p",{children:["Para comenzar, presiona el botón ",e.jsx("strong",{className:"titilar",children:"'Crear Notificación'"}),". Luego, ingresa el título y el contenido del mensaje, y selecciona el tipo de notificación:"]}),e.jsxs("ul",{children:[e.jsx("p",{children:"Informativa (Normal)"}),e.jsx("p",{children:"Búsqueda de Paradero 🔎 "}),e.jsx("p",{children:"Prioritaria (Importante) ⭐ "}),e.jsx("p",{children:"Evadido (En caso de evasiones) 🚨"})]}),e.jsx("button",{type:"button",className:"btn btn-primary text-white btn-sm mx-2",onClick:o,children:"Continuar"}),e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed text-light btn-sm",onClick:t,children:"Finalizar "}),i&&e.jsxs("div",{children:[e.jsxs("p",{className:"mt-3",children:[e.jsx("i",{className:"bi bi-person-fill-add rounded-circle bg-cyan text-white p-2 mx-2"}),'"Usa este ícono  para asociar personas a tu notificación. Esto permitirá que el usuario vea una tarjeta con la información de la persona asociada."']}),e.jsxs("p",{className:"mt-3",children:[e.jsx("i",{className:"bi bi-link rounded-circle bg-teal text-white p-2 mx-2"}),'"Usa este ícono  para agregar enlaces relacionados con la notificación. Esto permitirá que el usuario se dirija directamente al sitio web indicado."']}),e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed text-light btn-sm",onClick:t,children:"Finalizar "})]})]})]})};function Pt(){const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState(!1),[o,d]=a.useState(!1),[g,x]=a.useState(null),[m,j]=a.useState(null),[u,p]=a.useState(null),[c,b]=a.useState(""),[h,f]=a.useState(!1),[v,N]=a.useState(""),[S,k]=a.useState(""),[y,w]=a.useState(""),[C,E]=a.useState("desc"),[F,_]=a.useState(!1),[I,P]=a.useState(""),U=()=>_(!0),K=()=>_(!1),[G,A]=a.useState(!1),V=M=>{M!=null&&M.asociada_notificacion_id&&Array.isArray(M.asociada_notificacion_id)&&alert(`Esta persona está asociada a las siguientes notificaciones: ${M.asociada_notificacion_id.join(", ")}`)},H=M=>{E(M.target.value),Z(M.target.value)},Z=(M,ee)=>{let te=[...s];M==="asc"?te.sort(($,ie)=>{var q,de;return((q=$.timestamp)==null?void 0:q.seconds)-((de=ie.timestamp)==null?void 0:de.seconds)}):te.sort(($,ie)=>{var q,de;return((q=ie.timestamp)==null?void 0:q.seconds)-((de=$.timestamp)==null?void 0:de.seconds)}),l(te)};a.useEffect(()=>{f(!0);const M=_e(W(D,"db_notificaciones"),Be("timestamp","desc")),ee=He(M,te=>{const $=te.docs.map(ie=>({id:ie.id,...ie.data()}));l($)},te=>{console.error("Error al obtener notificaciones:",te)});return f(!1),()=>ee()},[]),a.useEffect(()=>{(async()=>{const ee=_e(W(D,"db_personas"),Be("nombre_apellido","asc")),$=(await re(ee)).docs.map(ie=>({id:ie.id,...ie.data()}));n($)})()},[]);const z=async(M,ee)=>{try{if(!window.confirm("¿Desea eliminar este enlace?"))return;const $=B(D,"db_notificaciones",ee),ie=await De($);if(ie.exists()){const q=ie.data();if(Array.isArray(q.enlace)){const de=q.enlace.filter((O,ce)=>ce!==M);await le($,{enlace:de}),alert("Enlace eliminado con exito ")}else alert("El campo 'enlace' no existe o no es un array.")}else alert("No se encontró el documento con el ID proporcionado.")}catch(te){alert.error("Error al eliminar el enlace:",te)}},R=async M=>{if(window.confirm("¿Estás seguro de que deseas eliminar esta notificación?")){f(!0);try{await je(B(D,"db_notificaciones",M)),l(te=>te.filter($=>$.id!==M)),alert("Se eliminó la notificación")}catch(te){console.error("Error al eliminar la notificación:",te),alert("Hubo un error al eliminar la notificación.")}finally{f(!1)}}},J=M=>{x(M),r(!0)},ne=()=>{r(!1),x(null),b("")},me=M=>{x(M),d(!0)},he=async()=>{if(g&&c)try{const M=_e(W(D,"db_personas"),Oe("nombre_apellido","==",c)),ee=await re(M);if(ee.empty)alert("No se encontró la persona seleccionada.");else{const te=ee.docs[0];await Promise.all([le(B(D,"db_notificaciones",g),{asociada:Me(c)}),le(B(D,"db_personas",te.id),{asociada_notificacion_id:Me(g)})]),alert(`La persona ${c} se asoció a la notificación.`),ne()}}catch(M){console.error("Error al asociar captura:",M),alert("Hubo un error al asociar la captura.")}else alert("Por favor, selecciona una persona para asociar.")},ae=async(M,ee,te)=>{if(window.confirm(`¿Estás seguro de que deseas eliminar la asociación de la persona ${te} con la notificación?`)){f(!0);try{const ie=B(D,"db_notificaciones",M);await le(ie,{asociada:Ie(te)});const q=B(D,"db_personas",ee);await le(q,{asociada_notificacion_id:Ie(M)}),alert(`Se eliminó la asociación de la persona ${te} con la notificación.`)}catch(ie){console.error("Error al eliminar la asociación:",ie),alert("Hubo un error al eliminar la asociación.")}finally{f(!1)}}else alert(`La asociación de la persona ${te} no fue eliminada.`)},T=M=>{switch(M){case"1":return"Informativa";case"2":return"Paradero 🔎";case"3":return"Evasión 👮🏻";case"4":return"Prioritaria ⭐";default:return"No definida"}},L=M=>{switch(M){case 1:return"Normal";case 2:return"Paradero 🔎";case 3:return"Evasión 👮🏻";case 4:return"Prioritaria ⭐";default:return"No definida"}},Q=M=>/^https?:\/\//.test(M)?M:`https://${M}`,X=async M=>{if(S.trim()){f(!0);try{const ee=B(D,"db_notificaciones",M);await le(ee,{contenido:S}),alert("Contenido actualizado correctamente"),j(null)}catch(ee){console.error("Error al actualizar contenido:",ee),alert("Hubo un error al actualizar el contenido.")}finally{f(!1)}}else alert("El contenido no puede estar vacío")},se=async M=>{if(y.trim()){f(!0);try{const ee=B(D,"db_notificaciones",M);await le(ee,{titulo:y}),alert("titulo actualizado correctamente"),p(null)}catch(ee){console.error("Error al actualizar titulo:",ee),alert("Hubo un error al actualizar el titulo.")}finally{f(!1)}}else alert("El titulo no puede estar vacío")};return e.jsxs("div",{children:[e.jsxs("div",{className:"row g-3 justify-content-center align-items-center mt-1",children:[e.jsxs("div",{className:"container",children:[G&&e.jsx(sa,{Date1:"Ninguno",Date2:"Desactivar Busqueda",onCerrar:()=>A(!1),color:"info"}),!G&&e.jsx("div",{className:"d-flex justify-content-end mb-1  ",children:e.jsxs("button",{className:"btn  fw-semibold",onClick:()=>A(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 titilar text-light"})," ",e.jsx("small",{className:"text-light",children:"Ayuda"})]})})]}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 text-center",children:e.jsxs("button",{className:"btn btn-light bg-opacity-50 fw-semibold px-4 d-flex align-items-center justify-content-center gap-2 shadow-sm border border-primary-subtle rounded-4",onClick:U,children:[e.jsx("span",{children:"Nuevo Notificación"}),e.jsx("i",{className:"bi bi-envelope-plus titilar",style:{fontSize:"1.5rem"}})]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-6 position-relative",children:e.jsxs("div",{className:"form-floating shadow rounded-4 border border-primary-subtle",children:[e.jsx("i",{className:"bi bi-sort-down-alt text-primary position-absolute top-50 start-0 translate-middle-y ms-3",style:{fontSize:"1.4rem",zIndex:2}}),e.jsxs("select",{className:"form-select ps-5 text-center",id:"floatingSelectOrder",value:C,onChange:H,children:[e.jsx("option",{value:"desc",children:"📥 Más recientes primero"}),e.jsx("option",{value:"asc",children:"📤 Más antiguos primero"})]}),e.jsx("label",{htmlFor:"floatingSelectOrder",children:"Ordenar por fecha"})]})})]}),e.jsx("div",{className:"row justify-content-center  ",children:e.jsx("div",{className:"col-12 col-md-10  ",children:e.jsx("div",{className:"list-group",children:s.map(M=>{var ee;return e.jsxs("div",{className:"list-group-item mb-4 shadow mt-5  ",children:[e.jsxs("div",{className:"d-flex align-items-center bg-gradiante2 text-white p-3 rounded",children:[e.jsx("button",{className:"btn bg-primaryMuiBlue px-3 border-white border-3 text-white rounded-pill position-absolute top-0 start-50 shadow-sm translate-middle",children:e.jsxs("span",{children:["Notificación",e.jsx("i",{className:"bi bi-send-check-fill ms-1 text-white"})]})}),e.jsx("span",{className:`badge rounded-pill me-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[M.caratula]||"bg-warning text-dark"}`,children:T(M.caratula)}),e.jsx("div",{className:"flex-grow-1"}),e.jsx("small",{className:"text-end",children:new Date(((ee=M.timestamp)==null?void 0:ee.seconds)*1e3).toLocaleString()})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h6",{className:"text-center bg-secondaryM fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Título"}),M.id===u?e.jsxs("div",{children:[e.jsx("input",{type:"text",value:y,onChange:te=>w(te.target.value),className:"form-control"}),e.jsx("button",{className:"btn btn-primary mt-2",onClick:()=>se(M.id),disabled:h,children:h?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1"})]})})]}):e.jsx("small",{className:"mb-2 text-muted",children:M.titulo}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${M.id===u?"btn-danger":"btn-primary"}`,onClick:()=>{M.id===u?p(null):(w(M.titulo),p(M.id))},children:e.jsx("i",{className:`bi ${M.id===u?"bi-x-circle":"bi-pencil"}`})})}),e.jsx("h6",{className:"text-center bg-primary fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Contenido"}),M.id===m?e.jsxs("div",{children:[e.jsx("textarea",{value:S,onChange:te=>k(te.target.value),className:"form-control",rows:"5"}),e.jsx("button",{className:"btn btn-primary mt-2",onClick:()=>X(M.id),disabled:h,children:h?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1"})]})})]}):e.jsx("small",{className:"mb-2 text-muted",children:M.contenido}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${M.id===m?"btn-danger":"btn-primary"}`,onClick:()=>{M.id===m?j(null):(k(M.contenido),j(M.id))},children:e.jsx("i",{className:`bi ${M.id===m?"bi-x-circle":"bi-pencil"}`})})}),M.enlace&&M.enlace.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-center bg-secondaryM fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Enlaces Asociados"}),e.jsx("ul",{className:"list-unstyled",children:M.enlace.map((te,$)=>e.jsxs("li",{className:"d-flex align-items-center justify-content-center gap-3 p-2 rounded-pill bg-light shadow-sm",children:[e.jsx("i",{className:"bi bi-browser-chrome text-primary girar",style:{fontSize:"20px"}}),e.jsx("a",{href:Q(te),target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none text-primary text-center flex-grow-1",style:{maxWidth:"250px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:te}),e.jsx("button",{className:"btn btn-redUi1 btn-sm rounded-circle",onClick:()=>z($,M.id),children:e.jsx("i",{className:"bi bi-trash text-white"})})]},$))})]}):e.jsx("p",{className:"text-danger mt-3 text-center",children:"No posee enlaces asociados"}),M.asociada&&M.asociada.length>0?e.jsxs("div",{className:"mt-3  ",children:[e.jsx("h6",{className:"text-center bg-primary fw-semibold shadow-sm text-white py-1 rounded",children:"Personas Asociadas"}),M.asociada.map((te,$)=>{var q,de;const ie=t.find(O=>O.nombre_apellido===te);return ie?e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2 p-2  shadow-sm bg-primary rounded-4 bg-opacity-25",children:[e.jsx("img",{src:((q=ie.base64)==null?void 0:q.trim())||$e,alt:ie.nombre_apellido||"Imagen no disponible",className:"rounded-circle me-3",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1 text-center",children:[e.jsxs("span",{children:[$+1,". ",te]}),((de=ie.asociada_notificacion_id)==null?void 0:de.length)>0&&e.jsxs("span",{className:"badge bg-teal text-white ms-3",onClick:()=>V(ie),children:["Asociado ",ie.asociada_notificacion_id.length]})]}),e.jsx("button",{className:"btn btn-sm btn-redUi1 text-white ms-3",onClick:()=>ae(M.id,ie.id,te),children:e.jsx("i",{className:"bi bi-trash"})})]},$):null})]}):e.jsx("span",{className:"text-danger text-center d-block",children:"No hay personas asociadas"})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 p-3",children:[e.jsx("button",{className:"btn btn-cyan text-white btn-sm rounded-circle ",onClick:()=>J(M.id),children:e.jsx("i",{className:"bi bi-person-fill-add"})}),e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle ",onClick:()=>me(M.id),children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle ",onClick:()=>R(M.id),disabled:h,children:e.jsx("i",{className:"bi bi-trash3-fill"})})]})]},M.id)})})})}),e.jsx("div",{className:`modal fade bg-dark ${i?"show d-block":""}`,tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!i,style:{backgroundColor:"rgba(0,0,0,0.5)"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content p-3 bg-gradient rounded-4 shadow-lg border-0 ",children:[e.jsxs("div",{className:"modal-header border-0 text-dark",children:[e.jsx("h5",{className:"modal-title",id:"modalLabel",children:"Asociar Persona a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:ne,"aria-label":"Cerrar",disabled:h})]}),e.jsxs("div",{className:"modal-body bg-light rounded-4 p-4 shadow-sm",children:[c&&e.jsxs("div",{className:"alert alert-primary d-flex align-items-center mb-4 rounded-4 shadow-sm",children:[e.jsx("i",{className:"bi bi-person-check-fill fs-4 me-2"}),e.jsx("strong",{className:"mb-0",children:"Seleccionado:"}),e.jsx("span",{className:"ms-2",children:c}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-primary ms-auto",onClick:()=>b(null),"aria-label":"Quitar selección",children:e.jsx("i",{className:"bi bi-x-lg"})})]}),e.jsx("label",{htmlFor:"persona",className:"form-label fw-semibold text-dark",children:"Buscar DNI o Nombre:"}),e.jsxs("div",{className:"d-flex mb-3",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Juan Pérez o 12345678",value:I,onChange:M=>P(M.target.value),disabled:h}),e.jsx("button",{className:"btn btn-outline-danger ms-2",onClick:()=>P(""),disabled:!I||h,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash"})})]}),I&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"fw-bold text-start mb-2",children:"Resultados:"}),e.jsx("ul",{className:"list-group mb-3",style:{maxHeight:"180px",overflowY:"auto"},"aria-live":"polite",children:t.filter(M=>`${M.nombre_apellido} ${M.documento}`.toLowerCase().includes(I.toLowerCase())).map(M=>{var ee;return e.jsxs("li",{className:"list-group-item d-flex align-items-center gap-3",onClick:()=>{b(M.nombre_apellido),P("")},style:{cursor:"pointer"},tabIndex:0,onKeyDown:te=>{te.key==="Enter"&&(b(M.nombre_apellido),P(""))},children:[e.jsx("img",{src:((ee=M.base64)==null?void 0:ee.trim())||$e,alt:M.nombre_apellido,className:"rounded-circle",style:{width:"45px",height:"45px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("p",{className:"mb-0 fw-semibold",children:M.nombre_apellido}),e.jsx("small",{className:"text-muted",children:M.documento})]}),e.jsx("span",{className:`badge rounded-pill border border-white border-2 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[M.prioridad]||"bg-warning text-dark"}`,children:L(M.prioridad)})]},M.id)})})]}),e.jsx("label",{htmlFor:"dropdownMenuButton",className:"form-label fw-semibold text-dark",children:"Buscar en lista:"}),e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{className:"btn btn-light dropdown-toggle w-100 text-truncate",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:h,children:c||"Selecciona una persona"}),e.jsx("ul",{className:"dropdown-menu w-100","aria-labelledby":"dropdownMenuButton",style:{maxHeight:"250px",overflowY:"auto"},children:t.filter(M=>`${M.nombre_apellido} ${M.documento}`.toLowerCase().includes(I.toLowerCase())).map(M=>{var ee;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>b(M.nombre_apellido),type:"button",children:[e.jsx("img",{src:((ee=M.base64)==null?void 0:ee.trim())||$e,alt:M.nombre_apellido,className:"rounded-circle",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1 text-truncate",children:[M.nombre_apellido," - ",M.documento]}),e.jsx("span",{className:`badge rounded-pill border border-white border-2 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[M.prioridad]||"bg-warning text-dark"}`,children:L(M.prioridad)})]})},M.id)})})]})]}),e.jsxs("div",{className:"modal-footer border-0 pt-0",children:[e.jsx("button",{type:"button",className:"btn btn-primary d-flex align-items-center gap-2",onClick:he,disabled:h||!c,children:h?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),e.jsx("span",{children:"Asociando..."})]}):e.jsxs(e.Fragment,{children:["Asociar Captura ",e.jsx("i",{className:"bi bi-person-plus-fill"})]})}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:ne,disabled:h,children:"Cerrar"})]})]})})}),e.jsx(ea,{showModalLink:o,setShowModalLink:d,selectedNotifId:g,setNewLink:N,newLink:v,setNotificaciones:l}),e.jsx(Mt,{showModalNot:F,closeModalNot:K})]})}const It=({loading:s})=>e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"position-relative",children:s?e.jsx(oe,{}):e.jsx("div",{className:"list-group",children:e.jsx(Pt,{})})})}),Lt="/gif/dash.gif",$t=()=>{const s=localStorage.getItem("user");return s?JSON.parse(s):null},ns=$t();var Gs;const Bs=((Gs=ns==null?void 0:ns.email)==null?void 0:Gs.split("@")[0])||"Usuario Sin Registro",Rt=Bs.charAt(0).toUpperCase()+Bs.slice(1),zt=()=>e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center  mt-5 text-light",children:[e.jsxs("span",{className:"display-4 mb-2",children:["¡Bienvenido ",Rt,"!"]}),e.jsx("span",{className:"mb-5 ",children:"Este panel de control te permite gestionar usuarios, ver estadísticas y configurar las opciones del sistema."}),e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-md-6 d-flex flex-column justify-content-center align-items-center mb-4 mb-md-0",children:[e.jsxs("p",{className:"text-center d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"bi bi-asterisk p-3 rounded-circle me-3 bg-dark bg-opacity-25"}),e.jsx("span",{className:"p-2",children:"Desde aquí podrás administrar los recursos del sistema de forma fácil y eficiente."})]}),e.jsxs("p",{className:"text-center d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"bi bi-lightbulb  p-3 rounded-circle me-3 bg-dark bg-opacity-25"}),e.jsx("span",{className:"p-2",children:"Ante cualquier inconveniente, no dudes en solicitar asistencia técnica."})]})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-center align-items-center",children:e.jsx("img",{src:Lt,alt:"Panel de control gráfico",className:"img-fluid p-2 rounded-circle shadow",style:{maxWidth:"300px",height:"auto"}})})]})]}),Tt=({loading:s})=>{const[l,t]=a.useState([]),[n,i]=a.useState([]),r=["captura","date","descripcion_fisica","documento","entidad","motivo_captura","nombre_apellido","paradero","prioridad","sexo","usuario","asociada_notificacion_id"],o={captura:"Captura",date:"Fecha",descripcion_fisica:"Datos de la Persona",documento:"Documento",entidad:"Entidad",motivo_captura:"Motivo de Captura",nombre_apellido:"Nombre y Apellido",paradero:"Paradero",prioridad:"Prioridad",sexo:"Sexo",usuario:"Usuario",asociada_notificacion_id:"ID Notificación "},d=async()=>{try{const p=(await re(W(D,"db_personas"))).docs.map(c=>({id:c.id,...c.data()}));t(p)}catch(u){console.error("Error al obtener los datos:",u)}},g=u=>{i(p=>p.includes(u)?p.filter(c=>c!==u):[...p,u])},x=()=>{i(r)},m=()=>{i([])},j=()=>{if(l.length===0||n.length===0)return;const u=l.map(b=>{const h={};return n.forEach(f=>{h[o[f]||f]=b[f]}),h}),p=ye.json_to_sheet(u),c=ye.book_new();ye.book_append_sheet(c,p,"Datos Seleccionados"),Ge(c,"Datos_Seleccionados.xlsx")};return a.useEffect(()=>{d()},[]),e.jsx(e.Fragment,{children:s?e.jsx(oe,{leyendaSet:"Exportar - Cx2"}):e.jsx("div",{className:"container-lg  mt-5 mt-md-0 text-white",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center ",children:[e.jsxs("span",{className:"mb-4 display-5",children:["Exportar Datos  ",e.jsx("i",{className:"bi bi-filetype-xml"})]}),e.jsx("h5",{className:"mb-5 fw-light",children:"Selecciona los campos que deseas incluir en la exportación."}),e.jsxs("div",{className:"d-flex justify-content-center mb-4 flex-wrap gap-2",children:[e.jsx("button",{className:"btn btn-outline-light",onClick:x,children:"Seleccionar todos"}),e.jsx("button",{className:"btn btn-outline-light",onClick:m,children:"Limpiar selección"})]}),e.jsx("form",{className:"mb-4 w-100 px-3 ",children:e.jsx("div",{className:"row p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg border border-1",children:r.map(u=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 mb-3",children:e.jsxs("div",{className:"form-check w-100 d-flex align-items-center",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:u,value:u,onChange:()=>g(u),checked:n.includes(u)}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:u,children:o[u]||u})]})},u))})}),n.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn bg-green bg-opacity-50 text-white fw-semibold",onClick:j,children:["Descargar datos seleccionados ",e.jsx("i",{className:"bi bi-file-earmark-arrow-down-fill ms-2"})]})})]})})})},aa=({data1:s,data2:l})=>{var u;const[t,n]=a.useState(!1),i=()=>n(!0),r=()=>n(!1),[o,d]=a.useState(""),x=(()=>{const p=localStorage.getItem("user");return p?JSON.parse(p):null})(),m=async p=>{if(window.confirm("¿Estás seguro de que deseas eliminar esta persona?"))try{const c=B(D,"db_personas_desactivados",p.id),b=new Date,h=`${b.getDate().toString().padStart(2,"0")}/${(b.getMonth()+1).toString().padStart(2,"0")}/${b.getFullYear().toString().slice(-2)}`;await Ne(c,{...p,usuario_baja:x.email||"usuario_desconocido",usuario_baja_fecha:h});const f=B(D,"db_personas",p.id);await je(f),l(),d("Persona eliminada y copiada a la colección de desactivados."),setTimeout(()=>d(""),3e3)}catch(c){console.error("Error al eliminar persona: ",c),d("Error al eliminar la persona. Inténtalo de nuevo."),setTimeout(()=>d(""),3e3)}},j=p=>{m(p),r()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-trash3-fill"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("h5",{className:"modal-title ",children:"Eliminar Persona"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:r})]}),"  ",e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(u=s.base64)==null?void 0:u.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-danger  bg-redW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas eliminar esta persona?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:()=>{j(s)},children:"Confirmar Eliminación"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Bt=({data1:s,data2:l})=>{const[t,n]=a.useState(!1),i=()=>n(!0),r=()=>n(!1),[o,d]=a.useState(),[g,x]=a.useState(s.descripcion_fisica),[m,j]=a.useState(s.documento),[u,p]=a.useState(s.entidad),[c,b]=a.useState(s.motivo_captura),[h,f]=a.useState(s.nombre_apellido),[v,N]=a.useState(s.prioridad),[S,k]=a.useState(s.sexo),[y,w]=a.useState(s.numero_contacto),[C,E]=a.useState(s.base64),[F,_]=a.useState("edicion desde menu de capturas"),[I,P]=a.useState(s.paradero),[U,K]=a.useState(s.alerta),[G,A]=a.useState(!1),[V,H]=a.useState(!1),[Z,z]=a.useState(!1),R=()=>{const X={nombre_apellido:h,documento:m,sexo:S,descripcion_fisica:g,entidad:u,motivo_captura:c,numero_contacto:y,prioridad:v,alerta:U,paradero:I};return["nombre_apellido","documento","sexo","descripcion_fisica","entidad","motivo_captura","numero_contacto","prioridad","alerta","paradero"].filter(ee=>X[ee]!==s[ee])},J=()=>{A(X=>!X)},ne=()=>{H(X=>!X)},me=()=>{z(X=>!X)},he=X=>{const se=X.target.files[0];if(se){const M=new FileReader;M.onloadend=()=>{E(M.result)},M.readAsDataURL(se)}else alert("Por favor, selecciona un archivo de imagen válido.")},ae=async()=>{const X=/^[A-Za-zÁÉÍÓÚáéíóúÑñ\s]+$/;if(!h.trim()){alert("El campo Nombre y Apellido no puede estar vacío.");return}if(!X.test(h)){alert("El campo Nombre y Apellido solo debe contener letras.");return}const se=/^[0-9]+$/;if(!m.trim()){alert("El campo Documento no puede estar vacío.");return}if(!se.test(m)){alert("El campo Documento solo debe contener números.");return}if(m.length<8){alert("El Documento debe tener al menos 8 dígitos.");return}if(!F.trim()){alert("La descripción de las ediciones es obligatoria.");return}const M=B(D,"db_personas",s.id),ee=R();try{d(!0);const te=new Date,$=`${te.getDate().toString().padStart(2,"0")}/${(te.getMonth()+1).toString().padStart(2,"0")}/${te.getFullYear().toString().slice(-2)}`;await le(M,{descripcion_fisica:g,documento:m,entidad:u,motivo_captura:c,nombre_apellido:h,prioridad:v,sexo:S,numero_contacto:y,alerta:U,base64:C,paradero:I,ediciones:F.trim()?[...s.ediciones||[],{motivo:F,usuario:Q.email,fecha:$,campos:ee}]:s.ediciones||[]}),l(),alert("Los cambios se han guardado correctamente.")}catch(te){console.error("Error al actualizar la persona: ",te),alert("Error al guardar los cambios. Inténtalo de nuevo.")}d(!1)},T=X=>{const se=parseInt(X.target.value,10);N(se),se===2&&(P(!0),K(!1)),se===1&&(P(!1),K(!1)),se===3&&(K(!0),P(!1)),se===4&&(P(!1),K(!1))},Q=(()=>{const X=localStorage.getItem("user");return X?JSON.parse(X):null})();return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-primary text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-pen"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header ",children:[" ",e.jsx("img",{src:"img/asistente.gif",alt:"Asistente",style:{width:"60px",height:"60px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border "}),e.jsx("h5",{className:"modal-title mx-4",children:"Asistente de Edición "}),e.jsx("button",{type:"button",className:"btn-close ",onClick:r})]}),"  ",e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:`col-3 mt-3 d-flex align-items-center ${G?"titilar":""}`,children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:J,children:[e.jsx("img",{src:C||"https://via.placeholder.com/40",alt:(C==null?void 0:C.nombre_apellido)||"Imagen no disponible",className:"img-fluid rounded-circle shadow-sm",style:{width:"100px",height:"auto",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:G?"Editando":"Editar"})]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end ",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:h,onChange:X=>f(X.target.value)}),e.jsx("label",{className:" badgefw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"number",className:"form-control",value:m,onChange:X=>j(X.target.value)}),e.jsx("label",{className:" fw-semibold opacity-75",children:"Documento"})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select text-center",value:S,onChange:X=>k(X.target.value),children:[e.jsx("option",{value:"",children:"Seleccione una Opción"}),e.jsx("option",{value:"masculino",children:"Masculino 👨"}),e.jsx("option",{value:"femenino",children:"Femenino 👩"}),e.jsx("option",{value:"otros",children:"Otros 👭🏻"})]}),e.jsx("label",{className:" fw-semibold opacity-75",children:"Sexo"})]})})]})]}),e.jsxs("div",{className:"btn-group mt-3",role:"group","aria-label":"Basic example",children:[e.jsx("button",{type:"button",className:`btn btn-secondaryM text-white ${Z?"titilar":""}`,onClick:me,children:Z?e.jsx(e.Fragment,{children:"Editando Datos de Captura "}):"Datos de Captura"}),e.jsx("button",{type:"button",className:`btn btn-primary text-white ${V?"titilar":""}`,onClick:ne,children:V?e.jsx(e.Fragment,{children:"Editando Descripciones"}):"Descripciones"})]}),G&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 ",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Editar Fotografía ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:J})}),e.jsxs("div",{className:"my-3 text-center text-purple",children:[e.jsx("input",{type:"file",className:"form-control",onChange:he}),C&&e.jsx("img",{src:C,alt:"Imagen previa",className:"img-fluid mt-5",style:{maxWidth:"300px"}})]})]})]}),Z&&e.jsxs("div",{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end  mt-4",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Datos de la Captura ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-2 text-center",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:me})}),e.jsx("span",{className:"badge text-bg-secondaryM text-white me-2 ",children:"Atención "}),e.jsxs("small",{children:["La prioridad ",e.jsx("strong",{children:"modifica el contexto"})," de la captura"]})]}),e.jsxs("div",{className:"form-floating ",children:[e.jsxs("select",{className:"form-select text-center shadow-sm border border-secondaryM mb-3  border-opacity-50 ",value:v,onChange:T,children:[e.jsx("option",{value:"",children:"Seleccione una Opción"}),e.jsx("option",{value:"1",children:"Normal"}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 🚨"}),e.jsx("option",{value:"4",children:"Prioridad ⭐"})]}),e.jsx("label",{className:"fw-semibold opacity-75 ms-2",children:"Prioridad"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Entidad que solicita captura"})}),e.jsx("input",{className:"form-control bg-blueW2",value:u,onChange:X=>p(X.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Numero de Contacto Entidad "})}),e.jsx("input",{className:"form-control bg-blueW2",value:y,onChange:X=>w(X.target.value)})]})]}),V&&e.jsxs("div",{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end  mt-4",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Descripciones ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:ne})}),e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-secondary me-2 ",children:"Descripción Fisica "})}),e.jsx("textarea",{className:"form-control bg-blueW2",value:g,onChange:X=>x(X.target.value),style:{minHeight:"160px"}})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-secondary me-2 ",children:"Motivo Captura "})}),e.jsx("textarea",{className:"form-control bg-blueW2",value:c,onChange:X=>b(X.target.value),style:{minHeight:"150px"}})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:r,children:e.jsx("i",{className:"bi bi-x-circle"})}),e.jsx("button",{className:"btn btn-primary text-white btn-sm rounded-circle",onClick:ae,disabled:o,children:o?e.jsx("i",{className:"bi bi-floppy2 titilar"}):e.jsx("i",{className:"bi bi-floppy2"})})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},ts=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1),[o,d]=a.useState(""),[g,x]=a.useState(!1),m=()=>r(!0),j=()=>r(!1),u=()=>{n([])},c=(()=>{const h=localStorage.getItem("user");return h?JSON.parse(h):null})(),b=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas copiar estas personas a la colección de desactivados?"))){x(!0);try{const v=l.filter(N=>s.includes(N.id)).map(async N=>{const S=W(D,"db_personas_desactivados"),k=new Date,y=`${k.getDate().toString().padStart(2,"0")}/${(k.getMonth()+1).toString().padStart(2,"0")}/${k.getFullYear().toString().slice(-2)}`;await Pe(S,{...N,usuario_baja:(c==null?void 0:c.email)||"usuario_desconocido",usuario_baja_fecha:y});const w=B(D,"db_personas",N.id);await je(w)});await Promise.all(v),d("Personas copiadas a la colección de desactivados y eliminadas de la colección original."),t(),u()}catch(f){console.error("Error al eliminar personas:",f),d("Hubo un error al copiar o eliminar algunas personas.")}setTimeout(()=>d(""),3e3),x(!1),j()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:m,disabled:g,children:e.jsx("i",{className:"bi bi-trash3-fill"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Eliminar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:j})]}),e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-redW p-2 rounded-pill text-secondaryMuiRed fw-bold",children:["Se eliminarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(h=>s.includes(h.id)).map(h=>{var f;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(f=h.base64)==null?void 0:f.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),h.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(v=>v.filter(N=>N!==h.id)),title:"Quitar de la selección"})]},h.id)})}),e.jsxs("p",{className:"text-danger text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas eliminar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:j,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:b,disabled:g,children:g?"Eliminando...":"Confirmar Eliminación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"}),o&&e.jsx("div",{className:"alert alert-success mt-2",children:o})]})},We=({Date1:s,Date2:l,setSelectedDocs:t,onCerrar:n,color:i})=>e.jsxs("div",{className:`card bg-${i} shadow my-4 position-relative text-dark d-flex align-items-start gap-3 p-4 card text-center p-2 bg-dark bg-opacity-75 rounded-4 shadow-lg`,style:{overflow:"visible"},children:[e.jsx("button",{type:"button",className:"btn-close position-absolute top-0 end-0 m-2","aria-label":"Cerrar",onClick:n}),e.jsx("img",{src:"img/Perfiles/9.png",alt:"Asistente",className:" position-absolute",style:{width:"120px",height:"200px",objectFit:"contain",top:"-30px",left:"-20px"}}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"130px"},children:[e.jsx("h5",{children:e.jsx("strong",{children:"Asistente de Selección"})}),e.jsxs("p",{className:"mb-3",children:["Personas Seleccionadas: ",e.jsxs("strong",{children:[s.length," 🧑"]})]}),e.jsx("strong",{children:s.length>0?e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-start p-2 rounded mb-3  ",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(r=>s.includes(r.id)).map(r=>{var o;return e.jsxs("div",{className:"badge text-dark shadow d-flex align-items-center p-2 mx-2 position-relative bg-light bg-opacity-50 m-1",style:{fontSize:"0.75rem"},children:[e.jsx("img",{src:(o=r.base64)==null?void 0:o.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),r.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>t(d=>d.filter(g=>g!==r.id)),title:"Quitar de la selección"})]},r.id)})}):e.jsx("span",{className:"text-danger",children:"Ninguna"})})]})]}),Je=({searchTerm:s,setSearchTerm:l})=>e.jsxs("div",{className:"form-floating mb-3 position-relative  ",children:[e.jsx("input",{type:"text",className:"form-control  shadow-sm pe-5 bg-dark bg-opacity-50 text-light",placeholder:"Buscar por nombre",value:s,onChange:t=>l(t.target.value)}),e.jsx("label",{children:"Buscar por Nombre"}),s&&e.jsx("button",{type:"button",className:"btn btn-link position-absolute top-50 end-0 translate-middle-y pe-3 ",onClick:()=>l(""),"aria-label":"Cancelar búsqueda",children:e.jsx("i",{className:"bi bi-x-circle text-light "})})]}),ta=({prioridadFilter:s,setPrioridadFilter:l})=>e.jsxs("div",{className:"form-floating mb-3  ",children:[e.jsxs("select",{className:"form-select shadow-sm ","aria-label":"Floating label select example",value:s,onChange:t=>l(t.target.value),children:[e.jsx("option",{value:"",children:"Todas las Prioridades"}),e.jsx("option",{value:"1",children:"Normal"}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 🚨"}),e.jsx("option",{value:"4",children:"Prioritaria ⭐"})]}),e.jsx("label",{children:"Seleccione una Prioridad"})]}),Ye=({orden:s,setOrden:l})=>e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Ordenar alfabéticamente",value:s,onChange:t=>l(t.target.value),children:[e.jsx("option",{value:"asc",children:"Orden A-Z"}),e.jsx("option",{value:"desc",children:"Orden Z-A"})]}),e.jsxs("label",{children:["Ordenar ",e.jsx("i",{className:"bi bi-alphabet"})]})]}),Ot=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState(!0);a.useState("");const[g,x]=a.useState(""),[m,j]=a.useState(""),[u,p]=a.useState(!0),[c,b]=a.useState("asc"),h=W(D,"db_personas"),f=async()=>{d(!0);try{const w=(await re(h)).docs.map(C=>({...C.data(),id:C.id}));l(w),n(w)}catch(y){console.error("Error al obtener personas: ",y)}finally{d(!1)}},v=y=>y.sort((w,C)=>c==="asc"?w.nombre_apellido.localeCompare(C.nombre_apellido):C.nombre_apellido.localeCompare(w.nombre_apellido));a.useEffect(()=>{f()},[]),a.useEffect(()=>{const y=s.filter(C=>C.nombre_apellido&&C.nombre_apellido.toLowerCase().includes(g.toLowerCase())||C.documento&&C.documento.includes(g)).filter(C=>m?C.prioridad===parseInt(m,10):!0),w=v(y);n(w)},[g,s,m,c]),a.useMemo(()=>t.filter(y=>i.includes(y.id)),[i,t]);const N=y=>{r(w=>w.includes(y)?w.filter(C=>C!==y):[...w,y])},S=()=>{if(i.length===t.length)r([]);else{const y=t.map(w=>w.id);r(y)}},k=y=>{switch(Number(y)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}};return e.jsxs("div",{className:"container-lg text-white",children:[e.jsxs("div",{className:"row mt-5",children:[e.jsx("h1",{className:"text-center my-5 animate__animated animate__bounce mt-sm-0 mt-5 ",children:"Listado de Capturas"}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(Je,{searchTerm:g,setSearchTerm:x})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(ta,{prioridadFilter:m,setPrioridadFilter:j})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ye,{orden:c,setOrden:b})})]}),o?e.jsx(oe,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[i.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2  mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(ts,{data1:i,data2:s,dataRefresh:f,setSelectedDocs:r}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>r([])})]}),u&&e.jsx(We,{Date1:i,Date2:s,setSelectedDocs:r,onCerrar:()=>p(!1),color:"blueW2"}),!u&&i.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>p(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-light"})," ",e.jsxs("small",{className:"text-light",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-light",children:[i.length," 🧑"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5  ",children:e.jsxs("table",{className:"table table-striped table-hover text-center small rounded-pill",children:[e.jsx("thead",{className:"table-info",children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:i.length===t.length,onChange:S})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Documento"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Prioridad"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(y=>{var w;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:i.includes(y.id),onChange:()=>N(y.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((w=y.base64)==null?void 0:w.trim())||"https://via.placeholder.com/40",alt:y.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize",children:y.nombre_apellido})]})}),e.jsx("td",{className:"d-none d-sm-table-cell",children:y.documento}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:k(y.prioridad)}),e.jsxs("td",{children:[e.jsx(Bt,{data1:y,data2:f}),e.jsx(aa,{data1:y,data2:f})]}),e.jsx("td",{})]},y.id)})})]})})]})})]})},ia=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1),[o,d]=a.useState(!1),g=()=>r(!0),x=()=>r(!1),m=()=>{n([])},u=(()=>{const c=localStorage.getItem("user");return c?JSON.parse(c):null})(),p=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas modificar estas personas a la colección?"))){d(!0);try{const h=l.filter(f=>s.includes(f.id)).map(async f=>{const v=B(D,"db_personas",f.id),N=new Date,S=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`;await Ne(v,{...f,prioridad:1,paradero:!1,alerta:!1,ediciones:[...f.ediciones||[],{motivo:"cambio de prioridad",usuario:u.email,fecha:S}]})});await Promise.all(h),alert("Personas modificadas con exito."),t(),m()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al modificar algunas personas.")}d(!1),x()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-orange text-white btn-sm rounded-circle ",onClick:g,disabled:o,children:e.jsx("i",{className:"bi bi-star-fill"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Modificar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:x})]}),e.jsx("hr",{className:"border border-orange border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-orangeW p-2 rounded-pill text-orange fw-bold",children:["Se modificarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(c=>s.includes(c.id)).map(c=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=c.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),c.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(h=>h.filter(f=>f!==c.id)),title:"Quitar de la selección"})]},c.id)})}),e.jsxs("p",{className:"text-orangeDb text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas modificar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:x,children:"Cancelar"}),e.jsx("button",{className:"btn btn-orangeDb text-white",onClick:p,disabled:o,children:o?"Cargando...":"Confirmar Modificación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},vs=({prioridadFilter:s,setPrioridadFilter:l,personas:t})=>{const n=[...new Set(t.map(i=>i.entidad))];return e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Floating label select example",value:s,onChange:i=>l(i.target.value),children:[e.jsx("option",{value:"",children:"Todas las Entidades"}),n.map((i,r)=>e.jsx("option",{value:i,children:i},r))]}),e.jsx("label",{children:"Seleccione una Entidad"})]})},ys=(s,l,t)=>s.filter(n=>{var i,r;return((i=n.nombre_apellido)==null?void 0:i.toLowerCase().includes(l.toLowerCase()))||((r=n.documento)==null?void 0:r.includes(l))}).filter(n=>!t||n.entidad===t),ws=(s,l)=>s.sort((t,n)=>l==="asc"?t.nombre_apellido.localeCompare(n.nombre_apellido):n.nombre_apellido.localeCompare(t.nombre_apellido)),Ut=(s,l)=>l?s.filter(t=>l==="capturado"?t.captura===!0:l==="evadido"?t.captura===!1:!0):s,Cs=(s,l,t,n)=>{s(""),l(""),t("asc"),n&&n("")},qt=({data1:s,data2:l})=>{var u;const[t,n]=a.useState(!1),i=()=>n(!0),r=()=>n(!1),[o,d]=a.useState(!1),x=(()=>{const p=localStorage.getItem("user");return p?JSON.parse(p):null})(),m=async p=>{if(window.confirm("¿Estás seguro de que deseas modificar esta persona?")){d(!0);try{const c=B(D,"db_personas",p.id),b=new Date,h=`${b.getDate().toString().padStart(2,"0")}/${(b.getMonth()+1).toString().padStart(2,"0")}/${b.getFullYear().toString().slice(-2)}`;await Ne(c,{...p,prioridad:1,paradero:!1,alerta:!1,ediciones:[...p.ediciones||[],{motivo:"cambio de prioridad",usuario:x.email,fecha:h}]}),l(),d(!1),alert("Modificación exitosa.")}catch(c){console.error("Error al eliminar persona: ",c),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},j=p=>{m(p),r()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-orange text-white btn-sm rounded-circle m-1",onClick:i,disabled:o,children:e.jsx("i",{className:"bi bi-star-fill"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("h5",{className:"modal-title ",children:"Modificar Prioridad Persona"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:r})]}),"  ",e.jsx("hr",{className:"border border-orange border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(u=s.base64)==null?void 0:u.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-orange  bg-orangeW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Cancelar"}),e.jsx("button",{className:"btn btn-orangeDb text-white",onClick:()=>{j(s)},children:"Confirmar Cambio"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Vt=({data1:s,data2:l})=>{var c;const[t,n]=a.useState("busqueda paradero"),[i,r]=a.useState(!1),o=()=>r(!0),d=()=>r(!1),[g,x]=a.useState(!1),j=(()=>{const b=localStorage.getItem("user");return b?JSON.parse(b):null})(),u=async b=>{if(window.confirm("¿Estás seguro de que deseas modificar esta persona?")){x(!0);try{const h=B(D,"db_personas",b.id),f=new Date,v=`${f.getDate().toString().padStart(2,"0")}/${(f.getMonth()+1).toString().padStart(2,"0")}/${f.getFullYear().toString().slice(-2)}`;await Ne(h,{...b,prioridad:1,paradero:!1,alerta:!1,ediciones:[...b.ediciones||[],{motivo:"desactivar busqueda paradero",usuario:j.email,fecha:v}]}),l(),x(!1),alert("Modificación exitosa.")}catch(h){console.error("Error al eliminar persona: ",h),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},p=b=>{u(b),d()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-primaryMuiBlue text-white btn-sm rounded-circle m-1",onClick:o,disabled:g,children:e.jsx("i",{className:"bi bi-search"})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsxs("h5",{className:"modal-title text-capitalize",children:["Modificar ",t]}),e.jsx("button",{type:"button",className:"btn-close ",onClick:d})]}),"  ",e.jsx("hr",{className:"border border-primary border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(c=s.base64)==null?void 0:c.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-primary  bg-blueW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:d,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primaryMuiBlue text-white",onClick:()=>{p(s)},children:"Confirmar Cambio"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Gt=({data1:s,data2:l})=>{const[t,n]=a.useState(!1),i=()=>n(!1),[r,o]=a.useState(!1),[d,g]=a.useState(""),[x,m]=a.useState(""),[j,u]=a.useState(""),c=(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null})(),b=async()=>{if(window.confirm(`¿Estás seguro de que deseas ${j}?`)){o(!0);try{const N=B(D,"db_personas",s.id),S=new Date,k=`${S.getDate().toString().padStart(2,"0")}/${(S.getMonth()+1).toString().padStart(2,"0")}/${S.getFullYear().toString().slice(-2)}`;await Ne(N,{...s,captura:!0,capturas_informacion_estados:[...s.capturas_informacion_estados||[],{captura_motivo:"informar captura",captura_informa_usuario:c.email,captura_fecha:k,captura_autor:x,captura_descripcion:d}]}),l(),o(!1),alert(`${j} realizado.`)}catch(N){console.error("Error al modificar persona: ",N),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},h=async N=>{console.log(N),o(!0);try{const S=B(D,"db_personas",N),k=new Date,y=`${k.getDate().toString().padStart(2,"0")}/${(k.getMonth()+1).toString().padStart(2,"0")}/${k.getFullYear().toString().slice(-2)}`;await le(S,{...N,prioridad:1,capturas_informacion_estados:[...N.capturas_informacion_estados||[],{captura_motivo:"desactivar alerta",captura_informa_usuario:c.email,captura_fecha:y}]}),l(),o(!1),alert("Alerta desactivada correctamente.")}catch{alert("No se pudo desactivar la alerta.")}},f=()=>{n(!0),u("Informar Captura de Persona")},v=async()=>{if(window.confirm("¿Estás seguro de que deseas QUITAR EL ESTADO DE  CAPTURADO ?")){o(!0);try{const N=B(D,"db_personas",s.id),S=new Date,k=`${S.getDate().toString().padStart(2,"0")}/${(S.getMonth()+1).toString().padStart(2,"0")}/${S.getFullYear().toString().slice(-2)}`;await le(N,{...s,captura:!1,capturas_informacion_estados:[...s.capturas_informacion_estados||[],{captura_motivo:"quitar estado de captura",captura_quita_estado_usuario:c.email,captura_quita_fecha:k}]}),l(),alert("Captura quitada correctamente."),o(!1)}catch(N){console.error("Error al quitar la captura:",N),alert("No se pudo quitar la captura. Inténtalo de nuevo."),o(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx("td",{className:s.captura?"bg-redW ":"",children:e.jsxs("div",{className:"d-flex flex-column gap-1",children:[s.captura?e.jsx("button",{className:"btn btn-pink text-white btn-sm w-100",onClick:()=>{v()},children:"Quitar Captura"}):e.jsx("button",{className:"btn btn-primary btn-sm w-100",onClick:f,disabled:r,children:"Marcar Capturado"}),s.alerta?e.jsx("button",{className:"btn btn-secondaryMuiRed text-white btn-sm w-100",onClick:()=>{window.confirm("¿Seguro que deseas desactivar la alerta?")&&h(s.id)},children:"Desactivar Alerta"}):e.jsx("button",{className:"btn btn-secondaryM btn-sm w-100",disabled:!0,children:"Alerta Inactiva"})]})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsxs("h5",{className:"modal-title mx-3",children:[j," "]}),e.jsx("button",{type:"button",className:"btn-close ",onClick:i})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3 mt-3 d-flex align-items-center",children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},children:[e.jsx("img",{src:s.base64?s.base64.trim():"",alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle shadow-sm",style:{width:"100px",height:"auto",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:e.jsx("span",{children:"Capturado  👮 "})})]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end ",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{className:"form-control border-0 border text-capitalize",value:s.nombre_apellido,disabled:!0}),e.jsx("label",{className:"badgefw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2 ",children:[e.jsx("input",{className:"form-control border-0 border",value:s.documento,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Documento"})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2 ",children:[e.jsx("input",{className:"form-control border-0 border text-capitalize",value:s.sexo,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Sexo"})]})})]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 ",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM"}),j," ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Autor / Entidad que realizó la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:x,onChange:N=>m(N.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Breve relato de la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:d,onChange:N=>g(N.target.value)})]})]}),e.jsxs("p",{className:"text-primary bg-blueW rounded my-2 p-1",children:[e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:i,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",onClick:b,disabled:!x||!d||r,children:j})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Ss=({personas:s,selectedDocs:l,toggleSelectDoc:t,toggleSelectAll:n,getPrioridadLabel:i,fetchPersonas:r,isFiltered:o,color:d,prioridad:g})=>e.jsx("div",{className:"table-responsive-sm mt-5 ",children:e.jsxs("table",{className:"table table-striped table-hover  text-center small ",children:[e.jsx("thead",{className:"table-info",children:e.jsxs("tr",{className:"bg-light",children:[!o&&e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:l.length===s.length,onChange:n})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell ",children:"Entidad"}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"DNI"}),g===3?e.jsx("th",{className:"d-none d-sm-table-cell",children:"Fecha"}):null,e.jsx("th",{className:"d-none d-sm-table-cell",children:"Prioridad"}),g===3?e.jsx("th",{}):null,e.jsx("th",{})]})}),e.jsx("tbody",{children:s.map(x=>{var m;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{className:x.captura?"bg-redW":"",children:e.jsx("input",{type:"checkbox",checked:l.includes(x.id),onChange:()=>t(x.id)})}),e.jsx("td",{className:x.captura?"bg-redW ":"",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((m=x.base64)==null?void 0:m.trim())||$e,alt:x.nombre_apellido,className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize d-inline-block text-truncate",children:x.nombre_apellido})]})}),e.jsx("td",{className:`d-none d-sm-table-cell text-dark ${x.captura?"bg-redW":d}`,children:x.entidad}),e.jsx("td",{className:x.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:x.documento}),g===3?e.jsx("th",{className:x.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:x.date}):null,e.jsx("td",{className:x.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:x.captura?e.jsx("span",{className:"badge bg-dark",children:"Capturado 👮"}):i(x.prioridad)}),g===3?e.jsx(Gt,{data1:x,data2:r}):null,e.jsxs("td",{className:x.captura?"bg-redW":"",children:[g===4?e.jsx(qt,{data1:x,data2:r}):null,g===2?e.jsx(Vt,{data1:x,data2:r}):null,e.jsx(aa,{data1:x,data2:r})]})]},x.id)})})]})}),ks=s=>{switch(Number(s)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}},_s=s=>{const[l,t]=a.useState([]),[n,i]=a.useState(!0),r=W(D,"db_personas"),o=async()=>{i(!0);try{let g=(await re(r)).docs.map(x=>({...x.data(),id:x.id}));g=g.filter(x=>x.prioridad===s),t(g)}catch(d){console.error("Error al obtener personas: ",d)}finally{i(!1)}};return a.useEffect(()=>{o()},[]),{personas:l,loading:n,fetchPersonas:o}},Es=s=>{const[l,t]=a.useState([]);return{selectedDocs:l,setSelectedDocs:t,toggleSelectDoc:r=>{t(o=>o.includes(r)?o.filter(d=>d!==r):[...o,r])},toggleSelectAll:()=>{if(s&&s.length>0)if(l.length===s.length)t([]);else{const r=s.map(o=>o.id);t(r)}}}},Ht=()=>{const[s,l]=a.useState(4),{personas:t,loading:n,fetchPersonas:i}=_s(s),[r,o]=a.useState([]),[d,g]=a.useState(""),[x,m]=a.useState(""),[j,u]=a.useState(!0),[p,c]=a.useState("asc"),{selectedDocs:b,setSelectedDocs:h,toggleSelectDoc:f,toggleSelectAll:v}=Es(r||[]),N=d||x;return a.useEffect(()=>{const S=ys(t,d,x),k=ws(S,p);o(k)},[d,t,x,p]),e.jsxs("div",{className:"container-lg text-white",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0  my-5",children:"Listado de Capturas Prioritarias"}),e.jsxs("div",{className:"card my-5  bg-dark bg-opacity-50 p-4 rounded-4",children:[e.jsx("div",{className:"card-header bg-light bg-opacity-75 rounded-2",children:e.jsx("div",{children:"Filtros"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-3",children:[e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(vs,{prioridadFilter:x,setPrioridadFilter:m,personas:t})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ye,{orden:p,setOrden:c})})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>Cs(g,m,c),className:"btn bg-white bg-opacity-25 btn-sm text-light",children:"Limpiar Filtros"})})]})})]}),e.jsx("div",{className:"col-12",children:e.jsx(Je,{searchTerm:d,setSearchTerm:g})}),n?e.jsx(oe,{}):e.jsx(e.Fragment,{children:r.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(ia,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:h}),e.jsx(ts,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:h}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>h([])})]}),j&&e.jsx(We,{Date1:b,Date2:t,setSelectedDocs:h,onCerrar:()=>u(!1),color:"blueW2"}),!j&&b.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>u(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-white"})," ",e.jsxs("small",{className:"text-white",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-white",children:[b.length," 🧑"]}),")"]})]})})]}),e.jsx(Ss,{personas:r,selectedDocs:b,toggleSelectDoc:f,toggleSelectAll:v,getPrioridadLabel:ks,fetchPersonas:i,isFiltered:N,color:"bg-yellowW",prioridad:s})]})})]})},Wt=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1),[o,d]=a.useState(!1),g=()=>r(!0),x=()=>r(!1),m=()=>{n([])},u=(()=>{const c=localStorage.getItem("user");return c?JSON.parse(c):null})(),p=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas recuperar estas personas?"))){d(!0);try{const h=l.filter(f=>s.includes(f.id)).map(async f=>{const v=B(D,"db_personas",f.id),N=new Date,S=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`;await Ne(v,{...f,recuperado:[...f.recuperado||[],{motivo:"recuperado manual",usuario:u.email,fecha:S,datos_resguardo_baja_previa:[{usuario_baja:f.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:f.usuario_baja_fecha||"fecha_no_disponible"}]}]});const k=B(D,"db_personas_desactivados",f.id);await je(k)});await Promise.all(h),alert("Personas recuperadas y eliminadas de la colección de desactivados."),t(),m()}catch(b){console.error("Error al recuperar personas:",b),alert("Hubo un error al recuperar o eliminar algunas personas.")}d(!1),x()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:g,disabled:o,children:e.jsx("i",{className:"bi bi-recycle"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Recuperar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:x})]}),e.jsx("hr",{className:"border border-teal border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-greenW p-2 rounded-pill text-primary fw-bold",children:["Se reactivan ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(c=>s.includes(c.id)).map(c=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=c.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),c.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(h=>h.filter(f=>f!==c.id)),title:"Quitar de la selección"})]},c.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas reactivar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:x,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:p,disabled:o,children:o?"Recuperando...":"Confirmar Recuperación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Jt=({data1:s,data2:l})=>{var m;const[t,n]=a.useState(!1),i=()=>n(!0),r=()=>n(!1),d=(()=>{const j=localStorage.getItem("user");return j?JSON.parse(j):null})(),g=async j=>{if(window.confirm("¿Estás seguro de que deseas recuperar esta persona?"))try{const u=B(D,"db_personas",j.id),p=new Date,c=`${p.getDate().toString().padStart(2,"0")}/${(p.getMonth()+1).toString().padStart(2,"0")}/${p.getFullYear().toString().slice(-2)}`,b="campos_modificados_aqui";await Ne(u,{...j,recuperado:[...j.recuperado||[],{motivo:"recuperado manual",usuario:d.email,fecha:c,datos_resguardo_baja_previa:[{usuario_baja:j.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:j.usuario_baja_fecha||"fecha_no_disponible"}]}]});const h=B(D,"db_personas_desactivados",j.id);await je(h),l(),alert("Persona recuperada y copiada a la colección de capturas.")}catch(u){console.error("Error al eliminar persona: ",u)}},x=j=>{g(j),r()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-recycle"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Recuperar Persona"}),e.jsx("button",{type:"button",className:"btn-close",onClick:r})]}),e.jsx("hr",{className:"border border-teal  border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(m=s.base64)==null?void 0:m.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-primary bg-greenW2 p-1",children:[e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas recuperar esta persona?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:()=>x(s),children:"Confirmar Recuperación"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Yt=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState(!0),[g,x]=a.useState(""),[m,j]=a.useState(""),[u,p]=a.useState(!0),[c,b]=a.useState("asc"),h=W(D,"db_personas_desactivados"),f=async()=>{d(!0);try{const w=(await re(h)).docs.map(C=>({...C.data(),id:C.id}));l(w),n(w)}catch(y){console.error("Error al obtener personas: ",y)}finally{d(!1)}},v=y=>y.sort((w,C)=>c==="asc"?w.nombre_apellido.localeCompare(C.nombre_apellido):C.nombre_apellido.localeCompare(w.nombre_apellido));a.useEffect(()=>{f()},[]),a.useEffect(()=>{const y=s.filter(C=>C.nombre_apellido&&C.nombre_apellido.toLowerCase().includes(g.toLowerCase())||C.documento&&C.documento.includes(g)).filter(C=>m?C.prioridad===parseInt(m,10):!0),w=v(y);n(w)},[g,s,m,c]);const N=y=>{r(w=>w.includes(y)?w.filter(C=>C!==y):[...w,y])},S=()=>{if(i.length===t.length)r([]);else{const y=t.map(w=>w.id);r(y)}},k=y=>{switch(Number(y)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}};return e.jsxs("div",{className:"container-lg text-white ",children:[e.jsxs("div",{className:"row mt-5",children:[e.jsx("h1",{className:"text-center mb-5 animate__animated animate__bounce mt-sm-0  ",children:"Listado de Capturas  Desactivadas"}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(Je,{searchTerm:g,setSearchTerm:x})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(ta,{prioridadFilter:m,setPrioridadFilter:j})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ye,{orden:c,setOrden:b})})]}),o?e.jsx(oe,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[i.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2  mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(Wt,{data1:i,data2:s,dataRefresh:f,setSelectedDocs:r}),e.jsx("button",{type:"button",className:"btn-close  btn-close-white mt-1","aria-label":"Close",onClick:()=>r([])})]}),u&&e.jsx(We,{Date1:i,Date2:s,setSelectedDocs:r,onCerrar:()=>p(!1),color:"blueW2"}),!u&&i.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>p(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-white"})," ",e.jsxs("small",{className:"text-white",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-white",children:[i.length," 🧑"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5",children:e.jsxs("table",{className:"table table-striped table-hover text-center small",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:i.length===t.length,onChange:S})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Documento"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Prioridad"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(y=>{var w;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:i.includes(y.id),onChange:()=>N(y.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((w=y.base64)==null?void 0:w.trim())||"https://via.placeholder.com/40",alt:y.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize",children:y.nombre_apellido})]})}),e.jsx("td",{className:"d-none d-sm-table-cell",children:y.documento}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:k(y.prioridad)}),e.jsx("td",{children:e.jsx(Jt,{data1:y,data2:f})}),e.jsx("td",{})]},y.id)})})]})})]})})]})},Zt=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1),[o,d]=a.useState(!1),g=()=>r(!0),x=()=>r(!1),m=()=>{n([])},u=(()=>{const c=localStorage.getItem("user");return c?JSON.parse(c):null})(),p=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas modificar estas personas ?"))){d(!0);try{const h=l.filter(f=>s.includes(f.id)).map(async f=>{const v=B(D,"db_personas",f.id),N=new Date,S=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`;await Ne(v,{...f,prioridad:1,paradero:!1,alerta:!1,ediciones:[...f.ediciones||[],{motivo:"desactivar busqueda paradero grupal",usuario:u.email,fecha:S}]})});await Promise.all(h),alert("Personas modificadas con exito."),t(),m()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al modificar algunas personas.")}d(!1),x()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-primaryMuiBlue text-white btn-sm rounded-circle ",onClick:g,disabled:o,children:e.jsx("i",{className:"bi bi-search"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Modificar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:x})]}),e.jsx("hr",{className:"border border-primary border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-blueW p-2 rounded-pill text-primary fw-bold",children:["Se modificarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(c=>s.includes(c.id)).map(c=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=c.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),c.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(h=>h.filter(f=>f!==c.id)),title:"Quitar de la selección"})]},c.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas modificar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:x,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primaryMuiBlue text-white",onClick:p,disabled:o,children:o?"Cargando...":"Confirmar Modificación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Qt=()=>{const[s,l]=a.useState(2),{personas:t,loading:n,fetchPersonas:i}=_s(s),[r,o]=a.useState([]),[d,g]=a.useState(""),[x,m]=a.useState(""),[j,u]=a.useState(!0),[p,c]=a.useState("asc"),{selectedDocs:b,setSelectedDocs:h,toggleSelectDoc:f,toggleSelectAll:v}=Es(r||[]),N=d||x;return a.useEffect(()=>{const S=ys(t,d,x),k=ws(S,p);o(k)},[d,t,x,p]),e.jsxs("div",{className:"container my-5 text-light",children:[e.jsx("h1",{className:"text-center my-5 animate__animated animate__bounce mt-sm-0  ",children:"Listado Busqueda de Paradero"}),e.jsxs("div",{className:"card my-5  bg-dark bg-opacity-50 p-4 rounded-4",children:[e.jsx("div",{className:"card-header bg-light bg-opacity-75 rounded-2",children:e.jsx("div",{children:"Filtros"})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-3",children:[e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(vs,{prioridadFilter:x,setPrioridadFilter:m,personas:t})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(Ye,{orden:p,setOrden:c})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>Cs(g,m,c),className:"btn bg-white bg-opacity-25 btn-sm text-light",children:"Limpiar Filtros"})})]})]}),e.jsx("div",{className:"col-12 ",children:e.jsx(Je,{searchTerm:d,setSearchTerm:g})}),n?e.jsx(oe,{}):e.jsx(e.Fragment,{children:r.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[s===4?e.jsx(ia,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:h}):null,s===2?e.jsx(Zt,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:h}):null,e.jsx(ts,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:h}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>h([])})]}),j&&e.jsx(We,{Date1:b,Date2:t,setSelectedDocs:h,onCerrar:()=>u(!1),color:"blueW2"}),!j&&b.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>u(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2"})," ",e.jsxs("small",{children:["Ver Resumen ( ",e.jsxs("span",{className:"text-primary",children:[b.length," 🧑"]}),")"]})]})})]}),e.jsx(Ss,{personas:r,selectedDocs:b,toggleSelectDoc:f,toggleSelectAll:v,getPrioridadLabel:ks,fetchPersonas:i,isFiltered:N,color:"bg-blueW",prioridad:s})]})})]})},Xt=({alertaFilter:s,setAlertaFilter:l})=>e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Floating label select example",value:s,onChange:t=>l(t.target.value),children:[e.jsx("option",{value:"",children:"Todos los Estados"}),e.jsx("option",{value:"capturado",children:"Capturado"}),e.jsx("option",{value:"evadido",children:"Evadido"})]}),e.jsx("label",{children:"Seleccione un Estado"})]}),Kt=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1);a.useState("");const[o,d]=a.useState(!1),[g,x]=a.useState(""),[m,j]=a.useState(""),u=()=>r(!0),p=()=>r(!1),c=()=>{n([])},h=(()=>{const v=localStorage.getItem("user");return v?JSON.parse(v):null})(),f=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas dar por CAPTURADOS 👮 a este grupo personas ?"))){d(!0);try{const S=l.filter(k=>s.includes(k.id)).map(async k=>{const y=B(D,"db_personas",k.id),w=new Date,C=`${w.getDate().toString().padStart(2,"0")}/${(w.getMonth()+1).toString().padStart(2,"0")}/${w.getFullYear().toString().slice(-2)}`;await le(y,{...k,captura:!0,capturas_informacion_estados:[...k.capturas_informacion_estados||[],{captura_motivo:"informar captura",captura_informa_usuario:h.email,captura_fecha:C,captura_autor:m,captura_descripcion:g}]})});await Promise.all(S),alert("Capturas Exitosas"),t(),c()}catch(N){console.error("Error al modificar personas:",N),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}d(!1),p()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-primary btn-sm w-100",onClick:u,disabled:o,children:["Marcar Capturas (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsx("h5",{className:"modal-title ms-3 text-dark",children:"Marcar Grupo como Capturado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:p})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(v=>s.includes(v.id)).map(v=>{var N;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(N=v.base64)==null?void 0:N.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),v.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(S=>S.filter(k=>k!==v.id)),title:"Quitar de la selección"})]},v.id)})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Autor / Entidad que realizó la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:m,onChange:v=>j(v.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Breve relato de la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:g,onChange:v=>x(v.target.value)})]}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas marcar como capturados estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:p,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:f,disabled:!m||!g||o,children:o?"Trabajando...":"Confirmar Captura"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},ei=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1);a.useState("");const[o,d]=a.useState(!1);a.useState(""),a.useState("");const g=()=>r(!0),x=()=>r(!1),m=()=>{n([])},u=(()=>{const c=localStorage.getItem("user");return c?JSON.parse(c):null})(),p=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas QUITAR LOS ESTADOS DE CAPTURA 👮 a estas personas ?"))){d(!0);try{const h=l.filter(f=>s.includes(f.id)).map(async f=>{const v=B(D,"db_personas",f.id),N=new Date,S=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`;await le(v,{...f,captura:!1,capturas_informacion_estados:[...f.capturas_informacion_estados||[],{captura_motivo:"quitar captura",captura_informa_usuario:u.email,captura_fecha:S}]})});await Promise.all(h),alert("Se quito las capturas de forma Exitosa"),t(),m()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}d(!1),x()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-pink btn-sm w-100",onClick:g,disabled:o,children:["Quitar Capturas (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsx("h5",{className:"modal-title ms-3 text-dark",children:"Quitar Estado de Capturados a Grupo "}),e.jsx("button",{type:"button",className:"btn-close",onClick:x})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de  ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(c=>s.includes(c.id)).map(c=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=c.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),c.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(h=>h.filter(f=>f!==c.id)),title:"Quitar de la selección"})]},c.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas quitar estado de captura ?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:x,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:p,disabled:o,children:o?"Trabajando...":"Quitar Captura"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},si=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1);a.useState("");const[o,d]=a.useState(!1);a.useState(""),a.useState("");const g=()=>r(!0),x=()=>r(!1),m=()=>{n([])},u=(()=>{const c=localStorage.getItem("user");return c?JSON.parse(c):null})(),p=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas DESACTIVAR SU ESTADO DE ALERTA EVADIDO 🚨 a este grupo de  personas ?"))){d(!0);try{const h=l.filter(f=>s.includes(f.id)).map(async f=>{const v=B(D,"db_personas",f.id),N=new Date,S=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`;await le(v,{...f,prioridad:1,capturas_informacion_estados:[...f.capturas_informacion_estados||[],{captura_motivo:"desactivar alerta",captura_informa_usuario:u.email,captura_fecha:S}]})});await Promise.all(h),alert("Alrta Modificada Exitosas"),t(),m()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}d(!1),x()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-secondaryMuiRed btn-sm w-100 text-white",onClick:g,disabled:o,children:["Desactivar Alerta (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border titilar",children:"🚨"}),e.jsx("h5",{className:"modal-title ms-3 text-dark",children:"Desactivar Alerta Evadido"}),e.jsx("button",{type:"button",className:"btn-close",onClick:x})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(c=>s.includes(c.id)).map(c=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=c.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),c.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(h=>h.filter(f=>f!==c.id)),title:"Quitar de la selección"})]},c.id)})}),e.jsxs("p",{className:"text-primary text-center  titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas desactivar el estado evadido ?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:x,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:p,disabled:o,children:o?"Trabajando...":"Desactivar Evadido"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},ai=()=>{const[s,l]=a.useState(3),{personas:t,loading:n,fetchPersonas:i}=_s(s),[r,o]=a.useState([]),[d,g]=a.useState(""),[x,m]=a.useState(""),[j,u]=a.useState(!0),[p,c]=a.useState("asc"),{selectedDocs:b,setSelectedDocs:h,toggleSelectDoc:f,toggleSelectAll:v}=Es(r||[]),N=d||x,[S,k]=a.useState(""),y=b.every(E=>{const F=t.find(_=>_.id===E);return(F==null?void 0:F.captura)===!0}),w=b.every(E=>{const F=t.find(_=>_.id===E);return(F==null?void 0:F.captura)===!1||(F==null?void 0:F.captura)===void 0}),C=!y&&!w;return a.useEffect(()=>{let E=ys(t,d,x);E=Ut(E,S);const F=ws(E,p);o(F)},[d,t,x,p,S]),e.jsxs("div",{className:"container-lg my-5 text-light",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0  ",children:"Listado de Evasiones"}),e.jsxs("div",{className:"card my-5  bg-dark bg-opacity-50 p-4 rounded-4",children:[e.jsx("div",{className:"card-header bg-light bg-opacity-75 rounded-2",children:e.jsx("div",{children:"Filtros"})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-3",children:[e.jsx("div",{className:"col-12 col-sm-4 col-md-8 col-lg-4",children:e.jsx(vs,{prioridadFilter:x,setPrioridadFilter:m,personas:t})}),e.jsx("div",{className:"col-12 col-sm-4 col-md-8 col-lg-4",children:e.jsx(Xt,{alertaFilter:S,setAlertaFilter:k})}),e.jsx("div",{className:"col-12 col-sm-3 col-md-8 col-lg-2",children:e.jsx(Ye,{orden:p,setOrden:c})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>Cs(g,m,c,k),className:"btn bg-white bg-opacity-25 btn-sm text-light",children:"Limpiar Filtros"})})]})]}),e.jsx("div",{className:"col-12 ",children:e.jsx(Je,{searchTerm:d,setSearchTerm:g})}),n?e.jsx(oe,{}):e.jsx(e.Fragment,{children:r.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[b.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx("div",{className:"d-flex gap-2 mb-2 justify-content-end mb-2",children:!C&&e.jsxs(e.Fragment,{children:[y&&e.jsx(ei,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:h}),w&&e.jsx(Kt,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:h})]})}),e.jsx(si,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:h}),e.jsx(ts,{data1:b,data2:t,dataRefresh:i,setSelectedDocs:h}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>h([])})]}),j&&e.jsx(We,{Date1:b,Date2:t,setSelectedDocs:h,onCerrar:()=>u(!1),color:"blueW2"}),!j&&b.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>u(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-light"})," ",e.jsxs("small",{className:"text-light",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-ligh",children:[b.length," 🧑"]}),")"]})]})})]}),e.jsx(Ss,{personas:r,selectedDocs:b,toggleSelectDoc:f,toggleSelectAll:v,getPrioridadLabel:ks,fetchPersonas:i,isFiltered:N,color:"bg-redW",prioridad:s})]})})]})},ti=()=>{const[s,l]=a.useState("dashboard"),[t,n]=a.useState([]),[i,r]=a.useState(!1),o=localStorage.getItem("user");o&&JSON.parse(o);const d=async()=>{try{r(!0);const b=await re(W(D,"db_personas")),h=[];b.forEach(f=>{h.push({id:f.id,...f.data()})}),n(h)}catch(b){console.error("Error al obtener los documentos: ",b)}finally{r(!1)}};a.useEffect(()=>{d()},[]);const g=t.filter(b=>b.prioridad===3).length,x=t.filter(b=>b.prioridad===1).length,m=t.filter(b=>b.prioridad===2).length,j=t.filter(b=>b.prioridad===4).length,u=t.filter(b=>b.captura===!0).length,p=t.length,c=()=>{switch(s){case"dashboard":return e.jsx(zt,{});case"reportes":return e.jsx(Tt,{loading:i});case"graficos":return e.jsx(At,{totalCapturas:p,totalPrioridadNormal:x,totalParadero:m,totalEvasiones:g,totalPrioritaria:j,totalEvasionesCapturados:u});case"Desactivados":return e.jsx(Yt,{});case"capturas":return e.jsx(Ot,{});case"evasiones":return e.jsx(ai,{});case"csv":return e.jsx(Ft,{});case"paradero":return e.jsx(Qt,{});case"prioritaria":return e.jsx(Ht,{});case"notificaciones":return e.jsx(It,{loading:i});default:return e.jsx("p",{children:"Selecciona una opción del menú."})}};return e.jsx("div",{className:"container-lg",children:e.jsxs("div",{className:"row ",children:[e.jsxs("div",{className:"col-12 col-md-4 col-lg-3 ",children:[e.jsx("div",{className:"text-center mb-4 text-light",children:e.jsxs("span",{className:"bg-dark bg-opacity-25 p-2 px-5 fs-6 rounded-5 ",children:[" ",e.jsx("i",{className:"mx-2 bi bi-menu-button-fill"}),"Menú Panel"]})}),e.jsxs("div",{className:"list-group p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="dashboard"?"active":""}`,onClick:()=>l("dashboard"),children:"Bienvenido"}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="reportes"?"active":""}`,onClick:()=>l("reportes"),children:"Exportación"}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="graficos"?"active":""}`,onClick:()=>l("graficos"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Graficos",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-teal rounded-pill",children:"Nuevo"})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="notificaciones"?"active":""}`,onClick:()=>l("notificaciones"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Notificaciones",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-primaryMuiBlue rounded-pill",children:"Administrar"})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="capturas"?"active":""}`,onClick:()=>l("capturas"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Capturas",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",p]})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="evasiones"?"active":""}`,onClick:()=>l("evasiones"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Evasiones",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",g]})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="paradero"?"active":""}`,onClick:()=>l("paradero"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Busqueda Paradero",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",m]})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="prioritaria"?"active":""}`,onClick:()=>l("prioritaria"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Prioritarias",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",j]})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="csv"?"active":""}`,onClick:()=>l("csv"),children:"Usuarios Csv"}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="Desactivados"?"active":""}`,onClick:()=>l("Desactivados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Desactivados",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-cyan rounded-pill",children:"Reactivar"})]})})]})]}),e.jsx("div",{className:"col-12 col-md-8 col-lg-9",children:c()})]})})},ii=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Panel de Control"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5",children:["  ",e.jsx(Fe,{Promp:"Panel de Control ",Promp2:"bi bi-code-slash fs-4 "}),"   "]}),e.jsx(ti,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},li=()=>e.jsx(e.Fragment,{children:e.jsx(ii,{})}),ri=({showModal:s,closeModal:l})=>{const t={Rosario:["Comisaria 1ra. - Sección Centro","Comisaria 2da. - Sección Puerto Norte","Comisaria 3ra. - Sección Tucuman","Comisaria 4ta. - Sección Echesortu","Comisaria 5ta. - Sección Pichincha","Comisaria 6ta. - Sección Zona Sur","Comisaria 7ma. - Sección La Florida","Comisaria 8va. - Sección Zona Oeste"]},n=["CRE Rosario","CRE Baigorria","BOU","BOP","AUOP","MOTORIZADA","CGI","PAT","CYP","VIAL","PUMAS","OTROS"],[i,r]=a.useState("Rosario"),[o,d]=a.useState(""),[g,x]=a.useState(""),[m,j]=a.useState(""),[u,p]=a.useState(""),[c,b]=a.useState(""),[h,f]=a.useState(""),[v,N]=a.useState(""),[S,k]=a.useState(!1),y=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$/,[w,C]=a.useState([]),[E,F]=a.useState(""),[_,I]=a.useState(""),[P,U]=a.useState([]),K=new Date().toLocaleString(),G=R=>y.test(R),A=()=>{if(!G(m)){f("El nombre y apellido solo deben contener letras y espacios.");return}if(u.length!==8||isNaN(u)){N("El DNI debe ser un número de 8 caracteres.");return}U([...P,{nombreApellido:m,dni:u}]),j(""),p(""),f("")},V=()=>{if(_.length!==6||isNaN(_)){N("El NI debe ser un número de 6 caracteres.");return}if(!G(E)){N("El nombre no debe contener números.");return}C([...w,{nombre:E,ni:_}]),F(""),I(""),N("")},H=async R=>{if(R.preventDefault(),!o){b("Por favor, selecciona una comisaría.");return}if(!g){b("Por favor, selecciona una unidad.");return}if(P.length===0){b("Debes agregar al menos una persona.");return}if(w.length===0){b("Debes agregar al menos una persona para la entrega.");return}if(!window.confirm("¿Estás seguro de que deseas agregar Art. 10 Bis?")){alert("La operación fue cancelada.");return}b(""),k(!0);try{const ne=JSON.parse(localStorage.getItem("user"));for(let me=0;me<P.length;me++){const he=P[me];await Pe(W(D,"db_art_diez_bis"),{nombre_apellido:he.nombreApellido,dni:he.dni,selectedLocalidad:i,comisaria:o.split(".")[0].trim(),unidad:g,timestamp:K,usuario:(ne==null?void 0:ne.email)||"Usuario desconocido",visualidad:!1,comisaria_recibe:!1,personal_entrega:w})}alert("Se agregaron las personas con Art. 10 Bis."),j(""),p(""),d(""),x(""),r("Rosario"),C([]),l()}catch(ne){console.error("Error al enviar notificación: ",ne),b("Error al enviar la notificación. Inténtalo de nuevo.")}finally{k(!1)}},Z=R=>{const J=P.filter((ne,me)=>me!==R);U(J)},z=R=>{const J=w.filter((ne,me)=>me!==R);C(J)};return s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-dark",children:[e.jsx("h5",{className:"modal-title text-center fw-semibold text-white",children:"Agregar Persona - Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close bg-white",onClick:l})]}),e.jsx("div",{className:"modal-body",children:e.jsx("form",{onSubmit:H,children:e.jsxs("div",{className:"container ",children:[e.jsxs("div",{className:"mb-3 text-center",children:[c&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),c]}),h&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar "}),h]}),v&&e.jsxs("div",{className:"alert alert-light text-danger shadow mb-4",children:[e.jsx("i",{className:"me-2 text-danger bi bi-exclamation-circle-fill titilar"}),v]})]}),e.jsxs("div",{className:"row g-2 mb-4 mt-4 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-primary fw-semibold shadow-sm text-white py-2 rounded",children:"Agregar personas 10 Bis"}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${h&&!y.test(m)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:m,onChange:R=>j(R.target.value)}),e.jsx("label",{htmlFor:"nombreApellido",children:"Nombre y Apellido"}),h&&!y.test(m)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${h&&(u.length!==8||isNaN(Number(u)))?"is-invalid":""}`,maxLength:"8",placeholder:"DNI",value:u,onChange:R=>p(R.target.value.replace(/[^\d]/g,""))}),e.jsx("label",{htmlFor:"dni",children:"DNI"}),h&&(u.length!==8||isNaN(Number(u)))&&e.jsx("div",{className:"invalid-feedback",children:"El DNI debe ser un número de hasta 8 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-primary shadow-sm rounded-circle",onClick:()=>A(),children:"+"})})]}),P.map((R,J)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center mb-2 p-2 rounded shadow-sm bg-light",children:[e.jsx("i",{className:"bi bi-person-circle text-primary me-3 "}),R.nombreApellido," - ",R.dni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>Z(J),children:e.jsx("i",{className:"bi bi-trash"})})]},J)),e.jsxs("div",{className:"row g-2 mb-4 mt-4 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-pink fw-semibold shadow-sm text-white py-2 rounded",children:"Dependencia Destino"}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("select",{className:`form-select ${c&&!i?"is-invalid":""}`,value:i,onChange:R=>r(R.target.value),children:e.jsx("option",{value:"Rosario",children:"Rosario"})}),e.jsx("label",{htmlFor:"localidad",children:"Localidad"}),c&&!i&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una localidad."})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:`form-select ${c&&!o?"is-invalid":""}`,value:o,onChange:R=>d(R.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar Comisaría"}),(t[i]||[]).map(R=>e.jsx("option",{value:R,children:R},R))]}),e.jsx("label",{htmlFor:"comisaria",children:"Comisaría"}),c&&!o&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una comisaría."})]})})]}),e.jsxs("div",{className:"mb-3 text-center",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-blue fw-semibold shadow-sm text-white py-2 rounded",children:"Unidad Procede a la Entrega"}),e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{id:"unidad",className:`form-select ${c&&!g?"is-invalid":""}`,value:g,onChange:R=>x(R.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar Unidad"}),n.map(R=>e.jsx("option",{value:R,children:R},R))]}),e.jsx("label",{htmlFor:"unidad",children:"Unidad Procede a la Entrega"}),c&&!g&&e.jsx("div",{className:"invalid-feedback",children:"Selecciona una unidad."})]})]}),e.jsxs("div",{className:"mb-3 text-center mt-4",children:[e.jsx("h6",{className:"fw-semibold text-capitalize text-center bg-secondaryM fw-semibold shadow-sm text-white py-2 rounded",children:"Mi Unidad de Trabajo"}),e.jsxs("div",{className:"row g-2 mb-2",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${v&&!y.test(E)?"is-invalid":""}`,placeholder:"Nombre y Apellido",value:E,onChange:R=>F(R.target.value)}),e.jsx("label",{htmlFor:"nombreEntrega",children:"Nombre y Apellido"}),v&&!y.test(E)&&e.jsx("div",{className:"invalid-feedback",children:"El nombre y apellido solo deben contener letras y espacios."})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control shadow-sm ${v&&(_.length!==6||isNaN(_))?"is-invalid":""}`,placeholder:"N.I",maxLength:"6",value:_,onChange:R=>I(R.target.value)}),e.jsx("label",{htmlFor:"niEntrega",children:"N.I"}),v&&(_.length!==6||isNaN(_))&&e.jsx("div",{className:"invalid-feedback",children:"El N.I debe ser un número de 6 caracteres."})]})}),e.jsx("div",{className:"col-2",children:e.jsx("button",{type:"button",className:"btn btn-primary shadow-sm rounded-circle",onClick:()=>V(),children:"+"})})]}),w.map((R,J)=>e.jsxs("li",{className:"list-group-item py-1 d-flex align-items-center justify-content-center mb-2 p-2 rounded shadow-sm bg-light mt-3",children:[e.jsx("i",{className:"bi bi-person-circle text-primary me-3 "}),R.nombre," - ",R.ni,e.jsx("i",{className:"ms-3 bi bi-check text-teal"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm text-white rounded-circle ms-3",onClick:()=>z(J),children:e.jsx("i",{className:"bi bi-trash"})})]},J))]}),e.jsx("div",{className:"text-center mb-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary shadow",disabled:S,children:S?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-arrow-repeat me-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-check-circle me-2"}),"Confirmar"]})})})," "]})})})]})})}):null},ni=({showModal:s,closeModal:l})=>{const[t,n]=a.useState(!1),i=Ve(),r=()=>{n(!1),l()},o=()=>{n(!t)};return a.useEffect(()=>{if(i.pathname==="/dashboard"){const d=g=>{r()};return window.history.pushState(null,document.title),window.addEventListener("popstate",d),()=>{window.removeEventListener("popstate",d)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Herramientas Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:r})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsxs("button",{className:`btn btn-${t?"secondary":"purple"}`,onClick:o,children:[t?"Ocultar Formulario":"Ingresar Nuevo Art. 10 Bis",e.jsx("i",{className:`ms-2 bi ${t?"bi-x-circle":"bi-person-add"}`})]})}),t&&e.jsx("div",{className:"container my-4",children:e.jsx(ri,{showModal:s,closeModal:r})})]})]})})}):null},oi=({recepciones:s,loading:l})=>e.jsx("div",{className:" text-center mt-4",children:l?e.jsx("div",{className:"spinner-border text-primary",role:"status"}):Object.keys(s).length>0?e.jsxs("div",{className:"alert",children:[e.jsx("strong",{children:"Recepciones pendientes por comisaría:"}),e.jsx("ul",{className:"list-group mt-3",children:Object.entries(s).map(([t,n],i)=>e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"spinner-grow text-primary",role:"status"}),e.jsx("span",{children:t}),e.jsxs("span",{className:"badge bg-primary",children:[n," pendientes"]})]},i))})]}):e.jsx("div",{className:"alert alert-primary",children:e.jsx("strong",{children:"No hay recepciones pendientes en este momento."})})}),ci=({notificaciones:s,loading:l,aceptarRecepcion:t,rechazarRecepcion:n})=>{const[i,r]=a.useState(""),[o,d]=a.useState(!1),[g,x]=a.useState(null),[m,j]=a.useState(""),[u,p]=a.useState(!1),c=async()=>{if(!g)return;p(!0);const{id:h,comisaria:f}=g,v=as[f];setTimeout(()=>{m&&m===v?(t(h),r(""),d(!1),j("")):r(`El código ingresado "${m}" es incorrecto.`),p(!1)},1e3)},b=h=>{x(h),d(!0),r(""),j("")};return e.jsxs("div",{className:"container-lg text-center",children:[e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("p",{className:"text-center  text-center mb-4 bg-primary text-white rounded p-2 mt-4 mb-3",children:["       ",e.jsx("span",{className:"text-capitalize fs-3  ",children:" validación Recepción Art. 10 Bis "}),"  ",e.jsx("i",{className:"bi bi-people-fill  ms-3 fs-1 "})]}),e.jsx("div",{className:"col-12 col-md-12 col-lg-12 mt-4",children:e.jsx("div",{className:"position-relative",children:l?e.jsxs("div",{className:"text-primary",children:["      ",e.jsx("div",{className:"spinner-border ",role:"status","aria-label":"Cargando...",children:" "})]}):e.jsxs("div",{className:"list-group",children:[i&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:i}),s&&s.length>0?s.map(h=>e.jsxs("div",{className:"list-group-item mb-3 shadow",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex flex-column w-100 text-truncate",children:[e.jsx("strong",{className:"text-truncate",children:h.nombre_apellido}),e.jsx("span",{className:"text-truncate",children:h.dni})]}),e.jsxs("div",{className:"d-flex flex-wrap justify-content-end row",children:[e.jsx("div",{className:"col mb-1",children:e.jsxs("button",{className:"btn btn-primary btn-sm me-2 mb-2 mb-md-0 w-100 w-md-auto",onClick:()=>b(h),"aria-label":`Aceptar recepción para ${h.nombre_apellido} en la Comisaría ${h.comisaria}`,children:["Aceptar ",e.jsx("i",{className:"bi bi-check-all ms-2"})]})}),e.jsx("div",{className:"col",children:e.jsxs("button",{className:"btn btn-pink btn-sm mb-2 mb-md-0 w-100 w-md-auto",onClick:()=>n(h.id),"aria-label":`Cancelar recepción para ${h.nombre_apellido}`,children:["Cancelar ",e.jsx("i",{className:"bi bi-trash ms-2"})]})})]})]}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{children:e.jsxs("small",{children:[h.selectedLocalidad," -"," ",e.jsx("span",{className:"badge bg-pink",children:h.comisaria})," -"," ",h.timestamp," -"," ",e.jsx("span",{className:"badge bg-primary",children:h.unidad})]})})})]},h.id)):e.jsx("div",{className:"alert alert-info shadow",role:"alert",children:"No se encontraron notificaciones para validar."})]})})})]}),o&&g&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Ingresar Código"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>d(!1),"aria-label":"Cerrar"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["Ingresa el código para la Comisaría ",e.jsx("strong",{children:g.comisaria}),":"]}),e.jsx("input",{type:"text",className:"form-control",value:m,onChange:h=>j(h.target.value),placeholder:"Código"}),i&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:i})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:c,disabled:!m||u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Validando..."]}):"Aceptar"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>d(!1),children:"Cancelar"})]})]})})})]})},di=()=>{const[s,l]=a.useState([]),[t,n]=a.useState(!1),[i,r]=a.useState(""),o=async()=>{try{n(!0);const j=_e(W(D,"db_art_diez_bis"),Oe("comisaria_recibe","==",!1)),p=(await re(j)).docs.map(c=>({id:c.id,...c.data()}));l(p)}catch(j){console.error("Error al obtener las recepciones pendientes: ",j)}finally{n(!1)}};a.useEffect(()=>{o()},[]);const d=async j=>{try{const u=JSON.parse(localStorage.getItem("user")),p=B(D,"db_art_diez_bis",j);await le(p,{comisaria_recibe:!0,visualidad:!0,fecha_ingreso_validado:Re(),usuario_validado_ingreso:u.email}),l(c=>c.filter(b=>b.id!==j)),alert("Recepción aceptada correctamente.")}catch(u){console.error("Error al aceptar la recepción: ",u),alert("Hubo un error al aceptar la recepción.")}},g=async j=>{if(window.confirm("¿Estás seguro de que deseas rechazar esta recepción?"))try{const p=B(D,"db_art_diez_bis",j);await je(p),l(c=>c.filter(b=>b.id!==j)),alert("Recepción rechazada correctamente.")}catch(p){console.error("Error al rechazar la recepción: ",p),alert("Hubo un error al rechazar la recepción.")}},x=s.reduce((j,u)=>{const p=u.comisaria||"Comisaría desconocida";return j[p]=(j[p]||0)+1,j},{}),m=i?s.filter(j=>j.comisaria===i):s;return e.jsx("div",{className:"container-lg mt-5",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-4 mb-4",children:[e.jsx(oi,{recepciones:x,loading:t}),e.jsxs("div",{className:"mt-4 card p-3 shadow-sm",children:[e.jsx("label",{htmlFor:"filtroComisaria",className:"form-label text-center text-capitalize fw-bold text-muted",children:"Filtrar por comisaría"}),e.jsxs("select",{id:"filtroComisaria",className:"form-select",value:i,onChange:j=>r(j.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),Object.keys(x).map((j,u)=>e.jsx("option",{value:j,children:j},u))]})]})]}),e.jsx("div",{className:"col-12 col-md-8 mt-4 mt-md-0",children:e.jsx(ci,{notificaciones:m,loading:t,aceptarRecepcion:d,rechazarRecepcion:g})})]})})},mi=({showModal:s,closeModal:l})=>{const[t,n]=a.useState(!1),i=Ve(),r=()=>{n(!1),l()};return a.useEffect(()=>{if(i.pathname==="/panelcontrol10bis"){const o=d=>{r()};return window.history.pushState(null,document.title),window.addEventListener("popstate",o),()=>{window.removeEventListener("popstate",o)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Recepción Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:r})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsx(di,{})})})]})})}):null},ui=({recepciones:s,loading:l})=>e.jsx("div",{className:"text-center mt-4",children:l?e.jsx("div",{className:"spinner-border text-primary",role:"status","aria-label":"Cargando..."}):Object.keys(s).length>0?e.jsxs("div",{className:"alert",children:[e.jsx("strong",{children:"Personas visibles por comisaría:"}),e.jsx("ul",{className:"list-group mt-3",children:Object.entries(s).map(([t,n],i)=>e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"spinner-grow text-teal",role:"status","aria-label":"Comisaría con personas visibles"}),e.jsx("span",{className:"text-truncate",children:t}),e.jsxs("span",{className:"badge bg-teal",children:[n," personas"]})]},i))})]}):e.jsx("div",{className:"alert alert-primary shadow",children:e.jsx("strong",{children:"No hay personas visibles en este momento."})})}),hi=as,xi=({dataInfo:s,loading:l,actualizarListado:t})=>{const[n,i]=a.useState("");console.log(l);const[r,o]=a.useState(null),[d,g]=a.useState(""),[x,m]=a.useState(!1),[j,u]=a.useState(null),[p,c]=a.useState({}),[b,h]=a.useState(!1),f=y=>hi[y]||"",v=(y,w)=>{const C=new Date(w.seconds*1e3).getTime()+216e5,E=setInterval(()=>{const F=Date.now(),_=C-F;if(_<=0){clearInterval(E),c(G=>({...G,[y]:"00:00:00"}));return}const I=Math.floor(_/36e5),P=Math.floor(_%36e5/6e4),U=Math.floor(_%6e4/1e3),K=`${I.toString().padStart(2,"0")}:${P.toString().padStart(2,"0")}:${U.toString().padStart(2,"0")}`;c(G=>({...G,[y]:K}))},1e3);return E},N=async y=>{for(const w of y){const C=w.fecha_ingreso_validado;if(C&&C.seconds){const E=new Date(C.seconds*1e3);if(new Date().getTime()-E.getTime()>36e5){console.log(`Han pasado más de 1 hora desde la salida de ${w.nombre_apellido}`),alert(`Han pasado más de 1 hora el sistema da como salida a  ${w.nombre_apellido} del Articulo 10 bis`);const I=B(D,"db_art_diez_bis",w.id),P=await De(I);if(P.exists()){const U=B(D,"db_art_diez_bis_desactivados",w.id);await Ne(U,P.data()),await je(I),await le(U,{visualidad:!1,salida_art:Re(),salida_art_usuario:"sistema"}),t(),console.log(`Documento copiado, actualizado y eliminado para ${w.nombre_apellido}`)}}}}};a.useEffect(()=>{s&&s.length>0&&(N(s),s.forEach(y=>{y.fecha_ingreso_validado&&y.fecha_ingreso_validado.seconds&&v(y.id,y.fecha_ingreso_validado)}))},[s]);const S=async()=>{if(!j)return;h(!0);const{id:y,comisaria:w}=j,C=f(w);setTimeout(async()=>{if(d&&d===C)try{const E=JSON.parse(localStorage.getItem("user")),F=B(D,"db_art_diez_bis",y),_=await De(F);if(_.exists()){const I=_.data();await Ne(B(D,"db_art_diez_bis_desactivados",y),{...I,visualidad:!1,salida_art:Re(),salida_art_usuario:(E==null?void 0:E.email)||"sistema"}),await je(F),i(""),alert("Recepción aceptada correctamente."),m(!1),g(""),t()}else alert("El documento no existe.")}catch(E){console.error("Error al aceptar la recepción: ",E),alert("Hubo un error al aceptar la recepción.")}finally{h(!1)}else i(`El código ingresado (${d}) es incorrecto.`),h(!1)},1e3)},k=y=>{u(y),m(!0)};return e.jsxs("div",{className:"container-lg text-center",children:[e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("p",{className:"text-center  text-center mb-4 bg-secondaryM text-white rounded p-2 mt-4 mb-3",children:["       ",e.jsx("span",{className:"text-capitalize fs-3  ",children:" Salida Art. 10 Bis "}),"  ",e.jsx("i",{className:"bi bi-people-fill  ms-3 fs-1 "})]}),e.jsx("div",{className:"col-12 col-md-12 col-lg-12 mt-4",children:l?e.jsxs("div",{className:"text-primary",children:["      ",e.jsx("div",{className:"spinner-border ",role:"status","aria-label":"Cargando...",children:" "}),"  "]}):e.jsxs("div",{className:"list-group",children:[n&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:n}),s&&s.length>0?s.map(y=>e.jsxs("div",{className:"list-group-item mb-3 shadow",children:[e.jsx("div",{className:"text-end me-2",children:e.jsxs("span",{className:"badge bg-primary",children:[e.jsx("i",{className:"bi bi-clock titilar me-1"})," ",p[y.id]||"Cargando..."]})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"d-flex flex-column w-100 text-truncate",children:[e.jsx("strong",{className:"text-truncate",children:y.nombre_apellido}),e.jsx("span",{className:"text-truncate",children:y.dni})]}),e.jsx("button",{className:"btn btn-teal text-white btn-sm w-25",onClick:()=>k(y),disabled:r===y.id,children:r===y.id?"Procesando...":"Finalizar"})]}),e.jsxs("small",{className:"mt-2",children:[y.selectedLocalidad," -"," ",e.jsx("span",{className:"badge bg-pink",children:y.comisaria})," - ",y.timestamp," -"," ",e.jsx("span",{className:"badge bg-primary",children:y.unidad})]})]},y.id)):e.jsxs("div",{className:"alert alert-info text-capitalize shadow",role:"alert",children:["No se encontraron Personas en dependencias.",e.jsx("i",{className:"bi bi-hand-thumbs-up ms-2"})]})]})})]}),x&&j&&e.jsx("div",{className:"modal show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Ingresar Código"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>m(!1),"aria-label":"Cerrar"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["Ingresa el código para la Comisaría ",e.jsx("strong",{children:j.comisaria}),":"]}),e.jsx("input",{type:"text",className:"form-control",value:d,onChange:y=>g(y.target.value),placeholder:"Código"}),n&&e.jsx("div",{className:"alert alert-danger mt-3",role:"alert",children:n})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:S,disabled:!d||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Validando..."]}):"Aceptar"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>m(!1),children:"Cancelar"})]})]})})})]})},bi=()=>{const[s,l]=a.useState(!1),[t,n]=a.useState(""),[i,r]=a.useState({}),[o,d]=a.useState([]),g=async()=>{try{l(!0);const m=_e(W(D,"db_art_diez_bis"),Oe("visualidad","==",!0)),u=(await re(m)).docs.map(c=>({id:c.id,...c.data()}));d(u);const p=u.reduce((c,b)=>{const h=b.comisaria||"Comisaría desconocida";return c[h]=(c[h]||0)+1,c},{});r(p)}catch(m){console.error("Error al obtener datos: ",m)}finally{l(!1)}};a.useEffect(()=>{g()},[]);const x=t?o.filter(m=>(m.comisaria||"").toLowerCase()===t.toLowerCase()):o;return e.jsxs("div",{className:"container-lg mt-5",children:[e.jsx("div",{className:"row"}),e.jsxs("div",{className:"row gy-4",children:[e.jsxs("div",{className:"col-12 col-lg-4",children:[e.jsx(ui,{recepciones:i,loading:s}),e.jsxs("div",{className:"mt-4 card p-3 shadow-sm",children:[e.jsx("label",{htmlFor:"filtroComisaria",className:"form-label text-center text-capitalize fw-bold text-muted",children:"Filtrar por comisaría"}),e.jsxs("select",{id:"filtroComisaria",className:"form-select",value:t,onChange:m=>n(m.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),Object.keys(i).map((m,j)=>e.jsx("option",{value:m,children:m},j))]})]})]}),e.jsx("div",{className:"col-12 col-lg-8",children:e.jsx(xi,{dataInfo:x,loading:s,actualizarListado:g})})]})]})},pi=({showModal:s,closeModal:l})=>{const[t,n]=a.useState(!1),i=Ve(),r=()=>{n(!1),l()};return a.useEffect(()=>{if(i.pathname==="/panelcontrol10bis"){const o=d=>{r()};return window.history.pushState(null,document.title),window.addEventListener("popstate",o),()=>{window.removeEventListener("popstate",o)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog modal-xl",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Salida / Egreso Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:r})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsx(bi,{})})})]})})}):null},gi=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState("nombre"),g=async()=>{try{const b=(await re(W(D,"db_comisarias"))).docs.map(h=>({id:h.id,...h.data()})).filter(h=>h.disponibilidad===!0);l(b)}catch(c){console.error("Error al obtener las comisarías: ",c)}},x=async()=>{try{const b=(await re(W(D,"db_art_diez_bis"))).docs.map(v=>({id:v.id,...v.data()})),h=b.filter(v=>v.visualidad===!0&&v.comisaria_recibe===!0),f=b.filter(v=>v.visualidad===!1&&v.comisaria_recibe===!1);n(h),r(f)}catch(c){console.error("Error al obtener las notificaciones: ",c)}};a.useEffect(()=>{g(),x()},[]);const m=t.reduce((c,b)=>{const h=b.comisaria;return h&&(c[h]=(c[h]||0)+1),c},{}),j=i.reduce((c,b)=>{const h=b.comisaria;return h&&(c[h]=(c[h]||0)+1),c},{}),u=c=>{const b=s.find(h=>h.comisaria===c);if(b){const h=b.plazas_art_10_bis||0;return(m[c]||0)>=h?{estado:"Llena",clase:"badge bg-danger"}:{estado:"Disponible",clase:"badge bg-info"}}return{estado:"Desconocido",clase:"badge bg-secondary"}},p=()=>o==="nombre"?[...s].sort((c,b)=>c.comisaria.localeCompare(b.comisaria)):o==="plaza"?[...s].sort((c,b)=>(b.plazas_art_10_bis||0)-(c.plazas_art_10_bis||0)):s;return e.jsxs("div",{children:[e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select",id:"filtroOrden",value:o,onChange:c=>d(c.target.value),"aria-label":"Ordenar por",children:[e.jsx("option",{value:"nombre",children:"Nombre (A-Z)"}),e.jsx("option",{value:"plaza",children:"Plazas Disponibles"})]}),e.jsx("label",{htmlFor:"filtroOrden",children:"Ordenar por"})]}),e.jsx("div",{className:"list-group",children:p().map(c=>{const{estado:b,clase:h}=u(c.comisaria),f=m[c.comisaria]||0,v=j[c.comisaria]||0;return e.jsx("div",{className:"list-group-item mb-3 shadow",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary",style:{fontSize:"1.5rem"}}),e.jsxs("div",{children:[e.jsx("strong",{children:c.comisaria}),e.jsxs("div",{children:[e.jsx("small",{className:h,children:`${f} / ${c.plazas_art_10_bis||0} Plazas - ${b}`}),e.jsx("div",{children:e.jsx("small",{className:"badge bg-primary",children:`${v} Pendientes ( Por Validar )`})})]})]})]})},c.comisaria)})})]})},ji=({showModal:s,closeModal:l})=>{const[t,n]=a.useState(!1),i=Ve(),r=()=>{n(!1),l()};return a.useEffect(()=>{if(i.pathname==="/panelcontrol10bis"){const o=d=>{r()};return window.history.pushState(null,document.title),window.addEventListener("popstate",o),()=>{window.removeEventListener("popstate",o)}}},[]),s?e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog modal-md",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",id:"modalTitle",children:"Plazas Art. 10 Bis"}),e.jsx("button",{type:"button",className:"btn-close",onClick:r})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsx(gi,{})})})]})})}):null},fi=()=>{const[s,l]=a.useState(!1),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState({search:"",estado:"",comisaria:""}),[g,x]=a.useState(!1),[m,j]=a.useState(!1),[u,p]=a.useState(""),c=async()=>{l(!0);try{let N=W(D,"db_art_diez_bis");if(o.estado==="desactivado")N=W(D,"db_art_diez_bis_desactivados");else if(o.estado===""){const y=await re(W(D,"db_art_diez_bis")),w=await re(W(D,"db_art_diez_bis_desactivados")),C=y.docs.map(_=>({id:_.id,..._.data()})),E=w.docs.map(_=>({id:_.id,..._.data()})),F=[...C,...E];n(F),r(F),l(!1);return}const k=(await re(N)).docs.map(y=>({id:y.id,...y.data()}));n(k),r(k)}catch(N){console.error("Error al obtener las notificaciones: ",N)}finally{l(!1)}};a.useEffect(()=>{c()},[o.estado]);const b=N=>{const{name:S,value:k}=N.target;d(y=>({...y,[S]:k}))};a.useEffect(()=>{const{search:N,estado:S,comisaria:k}=o,y=t.filter(w=>{var _,I,P;const C=N===""||((_=w.nombre_apellido)==null?void 0:_.toLowerCase().includes(N.toLowerCase()))||((I=w.dni)==null?void 0:I.toString().includes(N)),E=S===""||(S==="activado"?w.visualidad:!w.visualidad),F=k===""||((P=w.comisaria)==null?void 0:P.toLowerCase())===k.toLowerCase();return C&&E&&F});r(y),y.length===0?x(!0):x(!1)},[o,t]);const h=async(N,S,k)=>{try{if(S){const y=B(D,"db_art_diez_bis",N);await le(y,{visualidad:!1}),await Ne(B(D,"db_art_diez_bis_desactivados",N),k),await je(y),c(),alert("Estado desactivado y documento movido a desactivados")}else{const y=B(D,"db_art_diez_bis_desactivados",N),w=k;await Ne(B(D,"db_art_diez_bis",N),{...w,visualidad:!0}),await je(y),c(),alert("Estado activado y documento movido a activados")}}catch(y){console.error("Error al actualizar la visualidad: ",y),alert("Hubo un error al cambiar la visualidad.")}},f=()=>j(!1),v=N=>{p(N),j(!0)};return e.jsxs("div",{className:"container-lg text-center mt-5  mt-sm-5 mt-md-0 ms-lg-0",children:[e.jsxs("div",{className:"alert alert-light text-danger text-center bg-white border border-2 shadow-sm",role:"alert",children:["Recuerda que las personas están dentro del contexto ",e.jsx("strong",{children:" 6 horas cumplidas como maximo ( Art. 10 Bis ) desde su Ingreso . "}),"Por lo tanto el sistema da salida automáticamente a esas personas cumplido el plazo."]}),e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-4 mb-3  mb-sm-5 mb-md-0 mb-lg-0",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:"form-control shadow-sm",name:"search",value:o.search,onChange:b,placeholder:"Buscar por nombre o DNI"}),e.jsx("label",{htmlFor:"search",children:"Buscar por nombre o DNI"})]})}),e.jsx("div",{className:"col-md-4  mb-3 mb-sm-5 mb-md-0 mb-lg-0",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm",name:"estado",value:o.estado,onChange:b,children:[e.jsx("option",{value:"",children:"Todos los estados"}),e.jsx("option",{value:"activado",children:"Activado"}),e.jsx("option",{value:"desactivado",children:"Desactivado"})]}),e.jsx("label",{htmlFor:"estado",children:"Filtrar por estado"})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm",name:"comisaria",value:o.comisaria,onChange:b,children:[e.jsx("option",{value:"",children:"Todas las comisarías"}),[...new Set(t.map(N=>N.comisaria).filter(Boolean))].map(N=>e.jsx("option",{value:N,children:N},N))]}),e.jsx("label",{htmlFor:"comisaria",children:"Filtrar por comisaría"})]})})]}),g&&e.jsx("div",{className:"alert alert-danger",children:"No se encontraron coincidencias"}),e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-6 col-md-3 mt-4",children:[e.jsxs("button",{className:"btn btn-primary text-white fw-semibold mt-3 w-100",onClick:()=>v("panel"),children:["Nuevo 10 Bis"," ",e.jsx("i",{className:"bi bi-person-add rounded-circle border border-2 p-1 m-1"})]}),e.jsxs("button",{className:"btn btn-teal text-white fw-semibold mt-3 w-100",onClick:()=>v("recepcion"),children:["Recepción 10 Bis"," ",e.jsx("i",{className:"bi bi-people-fill rounded-circle border border-2 p-1 m-1"})]}),e.jsxs("button",{className:"btn btn-secondaryMuiRed text-white fw-semibold mt-3 w-100",onClick:()=>v("estadio"),children:["Alojados 10 Bis"," ",e.jsx("i",{className:"bi bi-person-raised-hand rounded-circle border border-2 p-1 m-1"})]}),e.jsxs("button",{className:"btn btn-orange text-white fw-semibold mt-3 w-100",onClick:()=>v("plazas"),children:["Plazas 10 Bis"," ",e.jsx("i",{className:"bi bi-shield-lock rounded-circle border border-2 p-1 m-1"})]})]}),e.jsx("div",{className:"col-12 col-md-9 mt-4",children:e.jsxs("div",{className:"position-relative",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h3",{children:"Actividad Art 10 Bis"})}),s?e.jsx(oe,{}):e.jsx("div",{className:"list-group",children:i.map(N=>e.jsxs("div",{className:`list-group-item mb-3 shadow ${N.visualidad?"bg-greenW2":"bg-redW"}`,children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{children:[e.jsx("strong",{children:N.nombre_apellido||"Sin nombre"})," -"," ",N.dni||"Sin DNI"]}),e.jsx("button",{className:`btn fw-semibold btn-sm ${N.visualidad?"btn-pink text-white rounded-pill":"btn-teal text-white rounded-pill"}`,onClick:()=>h(N.id,N.visualidad,N),children:N.visualidad?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-eye-slash me-1"})," Ocultar"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-eye me-2"})," Activar"]})})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("small",{children:[N.selectedLocalidad||"Localidad desconocida"," -"," ",N.comisaria||"Comisaría desconocida"," -"," ",N.timestamp?N.timestamp.split(",")[0]+" "+N.timestamp.split(",")[1].trim().slice(0,5)+" hs":"Fecha no disponible"]})})]},N.id))})]})})]}),m&&u==="panel"&&e.jsx(ni,{showModal:m,closeModal:f}),m&&u==="recepcion"&&e.jsx(mi,{showModal:m,closeModal:f}),m&&u==="estadio"&&e.jsx(pi,{showModal:m,closeModal:f}),m&&u==="plazas"&&e.jsx(ji,{showModal:m,closeModal:f})]})},Ni=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState(!0),o=["comisaria","fecha_ingreso_validado","dni","nombre_apellido","selectedLocalidad","timestamp","unidad","usuario_validado_ingreso","salida_art","salida_art_usuario"],d=async()=>{try{const u=W(D,"db_art_diez_bis"),p=W(D,"db_art_diez_bis_desactivados"),[c,b]=await Promise.all([re(u),re(p)]),h=c.docs.map(N=>({id:N.id,...N.data()})),f=b.docs.map(N=>({id:N.id,...N.data()})),v=[...h,...f];l(v),r(!1)}catch(u){console.error("Error al obtener los datos:",u),r(!1)}},g=u=>{n(p=>p.includes(u)?p.filter(c=>c!==u):[...p,u])},x=()=>{n(o)},m=()=>{n([])},j=()=>{if(s.length===0){console.error("No hay datos para descargar");return}if(t.length===0){console.error("Debe seleccionar al menos un campo");return}const u=s.map(b=>{const h={};return t.forEach(f=>{h[f]=b[f]}),h}),p=ye.json_to_sheet(u),c=ye.book_new();ye.book_append_sheet(c,p,"Datos Seleccionados"),Ge(c,"Datos_Seleccionados.xlsx")};return a.useEffect(()=>{d()},[]),e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center text-white",style:{minHeight:"55vh"},children:[e.jsxs("h2",{className:"text-center mb-4",children:["Exportar Datos  ",e.jsx("i",{className:"bi bi-filetype-xml"})]}),e.jsx("h5",{className:"text-center mb-5 fw-light",children:"Selecciona los campos que deseas incluir en la exportación."}),i?e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm text-light mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-light mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-light mx-2",role:"status"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex justify-content-center mb-4 flex-wrap gap-2",children:[e.jsx("button",{className:"btn btn-outline-light",onClick:x,children:"Seleccionar Todos"}),e.jsx("button",{className:"btn btn-outline-light",onClick:m,children:"Limpiar Selección"})]}),e.jsx("form",{className:"mb-4 w-100 px-3",children:e.jsx("div",{className:"row p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg border-1 border",children:o.map(u=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 mb-3",style:{display:"flex",alignItems:"center"},children:e.jsxs("div",{className:"form-check w-100 d-flex align-items-center",children:[e.jsx("input",{type:"checkbox",className:"form-check-input ",id:u,value:u,onChange:()=>g(u),checked:t.includes(u)}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:u,children:u})]})},u))})}),t.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn btn-green text-white fw-semibold",onClick:j,children:["Descargar Datos Seleccionados ",e.jsx("i",{className:"bi bi-filetype-xml"})]})})]})]})},vi=({chartType:s,onChange:l})=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsx("span",{className:"input-group-text bg-dark bg-opacity-50 text-white ",id:"inputGroup-sizing-sm",children:"Tipo de gráfico:"}),e.jsxs("select",{className:"form-select text-center ",onChange:l,value:s,children:[e.jsx("option",{value:"bar",children:"Barra"}),e.jsx("option",{value:"line",children:"Línea"}),e.jsx("option",{value:"pie",children:"Pastel"}),e.jsx("option",{value:"doughnut",children:"Doughnut"})]})]}),yi=({agrupacion:s,onChange:l})=>e.jsxs("div",{className:"input-group input-group-sm",children:[e.jsxs("span",{className:"input-group-text bg-purpleUi bg-opacity-50 text-white",children:[e.jsx("i",{className:"bi bi-diagram-3-fill me-1"})," Agrupar por"]}),e.jsxs("select",{className:"form-select text-center shadow-sm bg-dark bg-opacity-50 text-white",value:s,onChange:l,children:[e.jsx("option",{value:"comisaria",children:"Comisaría"}),e.jsx("option",{value:"unidad",children:"Unidad"})]})]}),wi=({coleccionesSeleccionadas:s,onChange:l})=>{const t=["db_art_diez_bis","db_art_diez_bis_desactivados"],n=o=>{const d=s.includes(o);d&&s.length===1||l(d?s.filter(g=>g!==o):[...s,o])},i=o=>o==="db_art_diez_bis"?"Activos":"Históricos",r=o=>o==="db_art_diez_bis"?"bi-person-fill-check":"bi-person-fill-slash";return e.jsx("div",{className:"d-flex justify-content-center gap-3 flex-wrap my-3",children:t.map(o=>{const d=s.includes(o);return e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Registros "}),e.jsxs("button",{type:"button",className:`btn d-flex align-items-center gap-2 px-4 py-1 rounded-3 shadow-sm fw-semibold ${d?"btn-light":"btn-outline-light"}`,onClick:()=>n(o),children:[e.jsx("i",{className:`bi ${r(o)} fs-5`}),i(o)]},o)]})})})},Ci=({chartType:s,data:l,options:t})=>{switch(s){case"line":return e.jsx(es,{data:l,options:t});case"pie":return e.jsx(js,{data:l,options:t});case"doughnut":return e.jsx(fs,{data:l,options:t});case"bar":default:return e.jsx(gs,{data:l,options:t})}},Si=(s,l)=>{const[t,n]=a.useState({}),[i,r]=a.useState(!0),[o,d]=a.useState(null);return a.useEffect(()=>{const g=async()=>{try{const x={};for(const m of l)(await re(W(D,m))).forEach(u=>{const p=u.data()[s];p&&(x[p]=(x[p]||0)+1)});n(x)}catch(x){d(x),console.error("Error fetching data:",x)}finally{r(!1)}};l.length>0?(r(!0),g()):(n({}),r(!1))},[s,l]),{data:t,loading:i,error:o}},ki=()=>{const[s,l]=a.useState("bar"),[t,n]=a.useState("comisaria"),[i,r]=a.useState(["db_art_diez_bis","db_art_diez_bis_desactivados"]),{data:o,loading:d,error:g}=Si(t,i);if(d)return e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm text-white mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-white mx-2",role:"status"}),e.jsx("span",{className:"spinner-grow spinner-grow-sm text-white mx-2",role:"status"})]});if(g)return e.jsx("p",{className:"alert alert-danger text-center",children:"Error cargando datos."});if(!o)return null;const x=Object.values(o).reduce((f,v)=>f+v,0),j=[" #1de9b6"," #ffca28"," #f73378"," #16B1FF"," #7e57c2"," #e353d3"," #c7f7d4"," #ffef62"," #05F2D4"].slice(0,9),u=Object.keys(o),p=Object.values(o),c={labels:u,datasets:[{label:`Total por ${t[0].toUpperCase()+t.slice(1)} (${x})`,data:p,backgroundColor:j,borderColor:"white",borderWidth:2,color:"#ffffff"}]},b={duration:1e3,easing:"easeOutBounce"},h={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"#ffffff"}},title:{display:!0,text:`Total de Casos por ${t[0].toUpperCase()+t.slice(1)}`,color:"#ffffff",font:{size:20}},tooltip:{bodyColor:"#ffffff",titleColor:"#ffffff"}},animation:b,scales:s==="pie"||s==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{stepSize:1,color:"#ffffff"},grid:{color:"rgba(255, 255, 255, 0.2)"}},x:{beginAtZero:!0,ticks:{stepSize:1,color:"#ffffff"},grid:{color:"rgba(255, 255, 255, 0.2)"}}}};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-center my-5 text-light",children:"Estadísticas / Gráficos"}),e.jsxs("div",{className:"row justify-content-center mb-3",children:[e.jsx("div",{className:"col-12 col-md-5 mb-2",children:e.jsx(vi,{chartType:s,onChange:f=>l(f.target.value)})}),e.jsx("div",{className:"col-12 col-md-5 mb-2",children:e.jsx(yi,{agrupacion:t,onChange:f=>n(f.target.value)})}),e.jsx("div",{className:"col-12 col-md-10",children:e.jsx(wi,{coleccionesSeleccionadas:i,onChange:r})})]}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10",style:{height:"400px"},children:e.jsx(Ci,{chartType:s,data:c,options:h})})})]})},_i=()=>{const[s,l]=a.useState([]),[t,n]=a.useState({totalDocumentos:0,personalEntrega:{},promedioTiempo:null,documentosPorComisaria:{},unidades:[],comisarias:[],salidasArtUsuarioMap:[]});a.useEffect(()=>{(async()=>{const d=(await re(W(D,"db_art_diez_bis_desactivados"))).docs.map(g=>g.data());l(d),i(d)})()},[]);const i=r=>{const o={},d={},g={},x={};let m=0,j=0;r.forEach(h=>{if(h.personal_entrega.forEach(f=>{const v=f.nombre.split(" ")[0],N=`${f.ni} - ${v}`;o[N]=(o[N]||0)+1}),d[h.comisaria]=(d[h.comisaria]||0)+1,h.unidad&&(g[h.unidad]=(g[h.unidad]||0)+1),h.salida_art_usuario&&(x[h.salida_art_usuario]=(x[h.salida_art_usuario]||0)+1),h.fecha_ingreso_validado&&h.salida_art){const f=h.fecha_ingreso_validado.toDate(),v=h.salida_art.toDate();!isNaN(f)&&!isNaN(v)?(m+=(v-f)/(1e3*60*60),j++):console.warn("Fecha inválida: ",h.fecha_ingreso_validado,h.salida_art)}});const u=Object.entries(g).map(([h,f])=>({unidad:h,cantidad:f})).sort((h,f)=>f.cantidad-h.cantidad),p=Object.entries(d).map(([h,f])=>({comisaria:h,cantidad:f})).sort((h,f)=>f.cantidad-h.cantidad),c=Object.entries(o).map(([h,f])=>({key:h,value:f})).sort((h,f)=>f.value-h.value),b=Object.entries(x).map(([h,f])=>({usuario:h,cantidad:f})).sort((h,f)=>f.cantidad-h.cantidad);n({totalDocumentos:r.length,personalEntrega:c,promedioTiempo:j>0?(m/j).toFixed(2):null,documentosPorComisaria:d,unidades:u,comisarias:p,salidasArtUsuarioMap:b})};return e.jsxs("div",{className:"container ",children:[e.jsxs("h3",{className:"text-center mb-4 bg-secondaryM text-white rounded p-2 ",children:["Estadísticas Art. 10 Bis ",e.jsx("i",{className:"ms-2 bi bi-bar-chart-fill"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card mb-4 shadow-sm mt-2",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2  ",children:"Total Art 10 Bis"}),e.jsxs("p",{className:"card-text fs-3",children:["    ",e.jsx("i",{className:"bi bi-clipboard-data mx-3",style:{fontSize:"1.5rem",color:"#007bff"}})," ",t.totalDocumentos," Total "]})]})})}),e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card mb-4 shadow-sm mt-2",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2 ",children:"Promedio Salida"}),e.jsx("i",{className:"bi bi-clock mx-3",style:{fontSize:"1.5rem",color:"#007bff"}}),e.jsxs("span",{className:"card-text fs-3",children:[t.promedioTiempo!==null?t.promedioTiempo:"N/A"," Horas"]})]})})}),e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"card mb-4 shadow-sm mt-2",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:"Comisarías"}),e.jsx("ul",{className:"list-unstyled mb-0 text-center",children:Object.entries(t.documentosPorComisaria).map(([r,o])=>e.jsxs("li",{children:[r,": ",o]},r))}),e.jsx("hr",{}),e.jsxs("div",{className:"text-center",children:[e.jsx("strong",{children:"Total Art. por  Comisarías: "}),Object.values(t.documentosPorComisaria).reduce((r,o)=>r+o,0)]})]})})})]}),e.jsx("div",{className:"card mt-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:["Rendimiento en Personal Entrega ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Posición"}),e.jsx("th",{scope:"col",children:"Personal Entrega"}),e.jsx("th",{scope:"col",children:"Procedimientos"}),e.jsx("th",{scope:"col",children:"Distinción"})]})}),e.jsx("tbody",{children:t.personalEntrega.length>0?t.personalEntrega.map(({key:r,value:o},d)=>e.jsxs("tr",{className:d===0?"table-warning":"",children:[e.jsx("td",{children:d===0?"👑 1":d===1?"🥈 2":d===2?"🥉 3":d+1}),e.jsx("td",{children:r}),e.jsxs("td",{children:[o," Procedimientos"]}),e.jsx("td",{children:d===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):d===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):d===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:"No hay datos disponibles"})})})]})]})}),e.jsx("div",{className:"card mt-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:["Rendimiento Unidades ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Unidad"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Distinción"})]})}),e.jsx("tbody",{children:t.unidades.length>0?t.unidades.map(({unidad:r,cantidad:o},d)=>e.jsxs("tr",{className:d===0?"table-warning":"",children:[e.jsxs("td",{children:[d===0?"👑 1":d===1?"🥈 2":d===2?"🥉 3":d+1," ",r]}),e.jsx("td",{children:o}),e.jsx("td",{children:d===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):d===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):d===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center",children:"No hay datos disponibles"})})})]})]})}),e.jsx("div",{className:"card mt-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:["Rendimiento Comisarías ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Comisaría"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Distinción"})]})}),e.jsx("tbody",{children:t.comisarias.length>0?t.comisarias.map(({comisaria:r,cantidad:o},d)=>e.jsxs("tr",{className:d===0?"table-warning":"",children:[e.jsxs("td",{children:[d===0?"👑 1":d===1?"🥈 2":d===2?"🥉 3":d+1," ",r]}),e.jsx("td",{children:o}),e.jsx("td",{children:d===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):d===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):d===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center",children:"No hay datos disponibles"})})})]})]})}),e.jsx("div",{className:"card mt-4",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title text-center mb-4 bg-primary text-white rounded p-2",children:["Rendimiento Salida Art Usuario ",e.jsx("i",{className:"ms-2 bi bi-graph-up-arrow"})]}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Usuario"}),e.jsx("th",{children:"Cantidad"}),e.jsx("th",{children:"Distinción"})]})}),e.jsx("tbody",{children:t.salidasArtUsuarioMap.length>0?t.salidasArtUsuarioMap.map(({usuario:r,cantidad:o},d)=>e.jsxs("tr",{className:d===0?"table-warning":"",children:[e.jsxs("td",{children:[d===0?"👑 1":d===1?"🥈 2":d===2?"🥉 3":d+1," ",r]}),e.jsx("td",{children:o}),e.jsx("td",{children:d===0?e.jsx("span",{className:"badge bg-warning text-dark",children:"Destacado"}):d===1?e.jsx("span",{className:"badge bg-secondary",children:"Notable"}):d===2?e.jsx("span",{className:"badge bg-dark",children:"Relevante"}):null})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center",children:"No hay datos disponibles"})})})]})]})})]})};cs.register(hs,xs,bs,ps,ds,ms,us);const la=({personas:s,visible:l,setVisible:t})=>{const n=a.useMemo(()=>{const r={};s.forEach(g=>{var m,j;const x=(j=(m=g.fecha_ingreso_validado)==null?void 0:m.toDate)==null?void 0:j.call(m);if(x){const u=x.getDate().toString().padStart(2,"0"),p=(x.getMonth()+1).toString().padStart(2,"0"),c=x.getFullYear(),b=`${u}-${p}-${c}`;r[b]=(r[b]||0)+1}});const o=Object.keys(r).sort(),d=o.map(g=>r[g]);return{labels:o,datasets:[{label:"Ingresos por día",data:d,fill:!1,borderColor:"rgb(75, 192, 192)",backgroundColor:"rgb(75, 192, 192)",tension:.2}]}},[s]),i={responsive:!0,plugins:{legend:{position:"top"},title:{display:!1},datalabels:{anchor:"end",align:"top",color:"#000",font:{weight:"bold"},formatter:r=>r}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto m",onClick:()=>t(!l)})}),e.jsx("div",{className:"card shadow-sm  mt-1",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title text-center",children:"📆 Ingresos en el tiempo"}),e.jsx(es,{data:n,options:i})]})})]})},ra=({personas:s,seleccionadas:l=[],visible:t,setVisible:n})=>{const i=a.useMemo(()=>{const r=s.length,o=l.length,d={},g={};return s.forEach(x=>{const m=x.unidad||"Sin unidad",j=x.comisaria||"Sin comisaría";d[m]=(d[m]||0)+1,g[j]=(g[j]||0)+1}),{total:r,totalSeleccionadas:o,porUnidad:d,porComisaria:g}},[s,l]);return e.jsx("div",{className:"mb-4",children:t&&e.jsxs("div",{className:"text-center p-2 bg-transparent bg-opacity-50 rounded-4 shadow-lg ",children:[e.jsx("div",{className:"d-flex justify-content-end my-2 ",children:e.jsx("button",{type:"button",className:"btn-close btn-close-white ms-auto mb-2",onClick:()=>n(!t)})}),e.jsxs("div",{className:"row row-cols-1 row-cols-md-4 g-3 ",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100 bg-dark bg-opacity-50 text-light ",children:[e.jsxs("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center mb-3 bg-light",style:{width:"60px",height:"60px"},children:e.jsx("i",{className:"bi bi-people fs-3 text-dark"})}),e.jsx("h6",{className:"card-title mb-1",children:"Total registros"}),e.jsx("span",{className:"badge bg-primary fs-5 px-3 py-2 rounded-pill shadow-sm",children:i.total})]}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#0d6efd",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100 bg-dark bg-opacity-50 text-light ",children:[e.jsxs("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center text-ligh",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center mb-3 bg-light",style:{width:"60px",height:"60px"},children:e.jsx("i",{className:"bi bi-check-circle fs-3 text-secondaryM"})}),e.jsx("h6",{className:"card-title mb-1",children:"Seleccionados"}),e.jsx("span",{className:"badge bg-secondaryM fs-5 px-3 py-2 rounded-pill shadow-sm",children:i.totalSeleccionadas})]}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#03dac6",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card border-0 shadow-sm h-100 bg-dark bg-opacity-50 text-light ",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-car-front  me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Unidades"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porUnidad).map(([r,o])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsx("span",{cl:!0,children:r}),e.jsx("span",{className:"badge bg-indigo mb-2",children:o})]},r))})]})})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card border-0 shadow-sm h-100 bg-dark bg-opacity-50 text-light ",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-shield-lock me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Comisarías"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porComisaria).map(([r,o])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsx("span",{children:r}),e.jsx("span",{className:"badge bg-blue mb-2",children:o})]},r))})]})})})]})]})})},na=({searchTerm:s,setSearchTerm:l,orden:t,setOrden:n,prioridadFilter:i,setPrioridadFilter:r,comisariaFilter:o,setComisariaFilter:d,fechaInicio:g,setFechaInicio:x,fechaFin:m,setFechaFin:j,personas:u=[],visible:p,setVisible:c})=>{const b=[...new Set(u.map(N=>N.unidad))],h=[...new Set(u.map(N=>N.comisaria))],f=s||t!=="asc"||i||o||g||m,v=()=>{l(""),n("asc"),r(""),d(""),x(""),j("")};return p&&e.jsxs("div",{className:"text-center p-2 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("div",{className:"d-flex justify-content-end mt-2",children:e.jsx("button",{type:"button",className:"btn-close btn-close-white  ms-auto",onClick:()=>c(!p)})}),e.jsxs("div",{className:"card shadow-sm border-0 my-2 text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("div",{className:"card-header text-center bg-light bg-opacity-50 rounded-4 shadow-lg text-white p-1 rounded-2 mx-3 my-2",children:e.jsxs("h5",{children:[e.jsx("i",{className:"bi bi-funnel-fill me-2"}),"Filtros"]})}),e.jsxs("div",{className:"card-body px-4",children:[e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-12 col-md-3 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Buscar por Nombre"}),e.jsx("input",{type:"text",className:"form-control",value:s,onChange:N=>l(N.target.value),placeholder:"Ej: Juan Pérez"})]}),e.jsxs("div",{className:"col-12 col-md-2 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Orden"}),e.jsxs("select",{className:"form-select",value:t,onChange:N=>n(N.target.value),children:[e.jsx("option",{value:"asc",children:"Ascendente (A-Z)"}),e.jsx("option",{value:"desc",children:"Descendente (Z-A)"})]})]}),e.jsxs("div",{className:"col-12 col-md-3 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Unidad"}),e.jsxs("select",{className:"form-select",value:i,onChange:N=>r(N.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),b.map(N=>e.jsx("option",{value:N,children:N},N))]})]}),e.jsxs("div",{className:"col-12 col-md-3 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Comisaría"}),e.jsxs("select",{className:"form-select",value:o,onChange:N=>d(N.target.value),children:[e.jsx("option",{value:"",children:"Todas"}),h.map(N=>e.jsx("option",{value:N,children:N},N))]})]}),e.jsxs("div",{className:"col-12 col-md-6 mb-3",children:[e.jsx("label",{className:"form-label fw-semibold small text-light",children:"Rango de fechas (Ingreso)"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"date",className:"form-control",value:g,onChange:N=>x(N.target.value)}),e.jsx("span",{className:"input-group-text",children:"a"}),e.jsx("input",{type:"date",className:"form-control",value:m,onChange:N=>j(N.target.value)})]})]})]}),f&&e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{className:"btn btn-danger text-white rounded-circle d-flex align-items-center justify-content-center",style:{width:"45px",height:"45px",boxShadow:"0 0.5rem 1rem rgba(0,0,0,0.15)"},onClick:v,title:"Restaurar filtros",children:e.jsx("i",{className:"bi bi-trash"})})})]})]})," "]})},oa=({columnasVisibles:s,setColumnasVisibles:l,visible:t,setVisible:n})=>t&&e.jsxs("div",{className:"text-center p-2 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("div",{className:"d-flex justify-content-end mt-2",children:e.jsx("button",{type:"button",className:"btn-close btn-close-white  ms-auto",onClick:()=>n(!t)})}),e.jsx("div",{className:"card shadow-sm border-0 my-2 text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:e.jsxs("div",{className:"card-body text-light",children:[e.jsxs("h5",{className:"card-title mb-3 text-center bg-primary text-white p-1 rounded-2 bg-light bg-opacity-50 rounded-4 shadow-lg text-white p-2",children:[e.jsx("i",{className:"bi bi-sliders me-2"}),"Mostrar / Ocultar columnas"]}),e.jsx("div",{className:"row",children:Object.entries(s).map(([i,r])=>e.jsx("div",{className:"col-6 col-md-4 mb-2",children:e.jsxs("div",{className:"form-check form-switch ",children:[e.jsx("input",{className:"form-check-input bg-light bg-opacity-50",type:"checkbox",id:`columna-${i}`,checked:r,onChange:()=>l(o=>({...o,[i]:!o[i]}))}),e.jsx("label",{className:"form-check-label",htmlFor:`columna-${i}`,children:i==="usuarioSalida"?"Usuario salida":i.charAt(0).toUpperCase()+i.slice(1)})]})},i))})]})})]}),ca=({filteredPersonas:s,selectedDocs:l,toggleSelectAll:t,toggleSelectDoc:n,columnasVisibles:i})=>{const[r,o]=a.useState(!0);return e.jsx(e.Fragment,{children:s.length===0?e.jsx("div",{className:"alert alert-light text-danger shadow text-center titilar mt-3",children:"Sin registro encontrado."}):e.jsx("div",{className:"table-responsive-sm d-none d-sm-block my-4",children:e.jsxs("div",{className:"card text-center p-2 bg-transparent bg-opacity-50 rounded-4 shadow-lg  ",children:[e.jsxs("div",{className:"card-header bg-dark bg-opacity-50  text-white px-3 p-1 d-flex justify-content-between align-items-center rounded-2 mx-2 my-2",children:[e.jsx("div",{style:{width:"32px"}}),e.jsxs("h5",{className:"mb-0 text-center flex-grow-1",children:[e.jsx("i",{className:"bi bi-view-list me-2"}),"Tabla"]}),e.jsxs("button",{className:"btn btn-sm btn-outline-light",onClick:()=>o(!r),children:[e.jsx("i",{className:`bi ${r?"bi-arrows-collapse":"bi-arrows-expand"} me-1`}),r?"Contraer":"Expandir"]})]}),r&&e.jsx("div",{className:"px-3 pb-3",children:e.jsxs("table",{className:"table table-striped table-hover text-center small mb-0 table-info",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:l.length===s.length,onChange:t})}),e.jsx("th",{children:"Nombre"}),i.unidad&&e.jsx("th",{children:"Unidad"}),i.dni&&e.jsx("th",{children:"Documento"}),i.comisaria&&e.jsx("th",{children:"Comisaría"}),i.ingreso&&e.jsx("th",{children:"F Ingreso"}),i.salida&&e.jsx("th",{children:"F Salida"}),i.usuarioSalida&&e.jsx("th",{children:"Salida"})]})}),e.jsx("tbody",{children:s.map(d=>{var g,x,m;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:l.includes(d.id),onChange:()=>n(d.id)})}),e.jsx("td",{className:"text-center",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("div",{className:"rounded-circle bg-primary text-white d-flex justify-content-center align-items-center",style:{width:"30px",height:"30px",fontSize:"0.9rem"},children:((g=d.unidad)==null?void 0:g.charAt(0).toUpperCase())||"?"}),e.jsx("span",{role:"button",onClick:()=>{var f,v,N;const j=((f=d.personal_entrega)==null?void 0:f.map(S=>`${S.nombre} (NI: ${S.ni})
🏢 Unidad: ${d.unidad||"No informada"}`).join(`

`))||"Sin datos",u=((v=d.fecha_ingreso_validado)==null?void 0:v.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"}))||"Sin fecha",p=((N=d.salida_art)==null?void 0:N.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"}))||"Sin fecha",c=d.usuario_validado_ingreso||"Desconocido",b=d.comisaria||"No informada",h=d.salida_art_usuario||"No informada";alert(`👤 Personal que entregó:
${j}

🏢 Comisaría: ${b}
📅 Fecha validación: ${u}
👮 Usuario que validó: ${c}
📅 Fecha salida: ${p}
👮 Usuario que validó salida: ${h}`)},className:"text-decoration-none",children:d.nombre_apellido})]})}),i.unidad&&e.jsx("td",{children:e.jsx("span",{className:"badge bg-primary",children:d.unidad})}),i.dni&&e.jsx("td",{children:d.dni}),i.comisaria&&e.jsx("td",{children:e.jsxs("div",{className:"d-flex flex-column align-items-center gap-1",children:[e.jsx("span",{className:"badge bg-pink",children:d.comisaria}),d.comisaria_recibe===!1&&e.jsx("span",{className:"badge bg-secondaryM titilar",children:"Pendiente Validar"})]})}),i.ingreso&&e.jsx("td",{children:(x=d.fecha_ingreso_validado)==null?void 0:x.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"medium",timeZone:"America/Argentina/Buenos_Aires"})}),i.salida&&e.jsx("td",{children:(m=d.salida_art)==null?void 0:m.toDate().toLocaleString("es-AR",{dateStyle:"full",timeStyle:"medium",timeZone:"America/Argentina/Buenos_Aires"})}),i.usuarioSalida&&e.jsx("td",{children:e.jsx("span",{className:"badge bg-teal",children:d.salida_art_usuario})})]},d.id)})})]})})]})})})},Ei=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState(!0),[g,x]=a.useState(""),[m,j]=a.useState(""),[u,p]=a.useState("asc"),[c,b]=a.useState(""),[h,f]=a.useState(""),[v,N]=a.useState(""),[S,k]=a.useState(!1),[y,w]=a.useState(!1),[C,E]=a.useState(!1),[F,_]=a.useState(!1),I=[{id:"columnas",componente:"ColumnasVisiblesPanel"},{id:"resumen",componente:"ResumenTotales"},{id:"filtros",componente:"FiltrosPanel"},{id:"grafico",componente:"GraficoPorFechaIngreso"},{id:"tabla",componente:"TablaDatos"}],[P,U]=a.useState(I),[K,G]=a.useState(null),[A,V]=a.useState({unidad:!0,dni:!0,comisaria:!0,ingreso:!1,salida:!1,usuarioSalida:!1}),H=W(D,"db_art_diez_bis_desactivados"),Z=async()=>{d(!0);try{const L=(await re(H)).docs.map(Q=>({...Q.data(),id:Q.id}));l(L),n(L)}catch(T){console.error("Error al obtener personas: ",T)}finally{d(!1)}},z=T=>T.sort((L,Q)=>u==="asc"?L.nombre_apellido.localeCompare(Q.nombre_apellido):Q.nombre_apellido.localeCompare(L.nombre_apellido)),R=T=>{G(T)},J=T=>{T.preventDefault()},ne=T=>{const L=[...P],Q=L.findIndex(M=>M.id===K),X=L.findIndex(M=>M.id===T),[se]=L.splice(Q,1);L.splice(X,0,se),U(L)};a.useEffect(()=>{Z()},[]),a.useEffect(()=>{const T=s.filter(L=>L.nombre_apellido&&L.nombre_apellido.toLowerCase().includes(g.toLowerCase())).filter(L=>m?L.unidad===m:!0).filter(L=>c?L.comisaria===c:!0).filter(L=>{var M;if(!h&&!v)return!0;const Q=(M=L.fecha_ingreso_validado)==null?void 0:M.toDate();if(!Q)return!1;const X=h?new Date(h):null,se=v?new Date(v):null;return!(X&&Q<X||se&&Q>se)});n(z(T))},[g,m,c,h,v,u,s]);const me=T=>{r(L=>L.includes(T)?L.filter(Q=>Q!==T):[...L,T])},he=()=>{if(i.length===t.length)r([]);else{const T=t.map(L=>L.id);r(T)}},ae=()=>{const T=s.filter(se=>i.includes(se.id));if(T.length===0){alert("No hay personas seleccionadas para exportar.");return}const L=T.map(se=>{var M,ee;return{Nombre:se.nombre_apellido,Documento:se.dni,Unidad:se.unidad,Comisaría:se.comisaria,"Fecha Ingreso":(M=se.fecha_ingreso_validado)==null?void 0:M.toDate().toLocaleString("es-AR"),"Fecha Salida":(ee=se.salida_art)==null?void 0:ee.toDate().toLocaleString("es-AR"),"Usuario Salida":se.salida_art_usuario}}),Q=ye.json_to_sheet(L),X=ye.book_new();ye.book_append_sheet(X,Q,"Seleccionados"),Ge(X,"personas_seleccionadas.xlsx")};return e.jsxs("div",{className:"container my-0 my-5 my-sm-5 my-md-0 my-lg-5 text-light",children:[e.jsx("div",{className:"row",children:e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Listado de Art. 10 Bis Historicos"})}),e.jsxs("div",{className:"container mb-4",children:[e.jsxs("div",{className:"row g-2 align-items-center justify-content-center",children:[e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${y?"btn-light":"btn-outline-light"}`,onClick:()=>w(!y),children:[e.jsx("i",{className:`bi ${y?"bi-eye-slash":"bi-eye"} me-1`}),y?"Ocultar resumen":"Ver resumen"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${C?"btn-light":"btn-outline-light"}`,onClick:()=>E(!C),children:[e.jsx("i",{className:`bi ${C?"bi-eye-slash":"bi-eye"} me-1`}),C?"Ocultar filtro":"Ver filtro"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${F?"btn-light":"btn-outline-light"}`,onClick:()=>_(!F),children:[e.jsx("i",{className:`bi ${F?"bi-eye-slash":"bi-eye"} me-1`}),F?"Ocultar columnas":"Ver columnas"]})})]}),e.jsxs("div",{className:"row my-3 row g-2 align-items-center justify-content-center",children:["  ",e.jsx("div",{className:"col-12 col-md-auto",children:e.jsxs("button",{className:"btn btn-green w-100  bg-dark bg-opacity-50 text-light ",onClick:ae,disabled:i.length===0,children:[e.jsx("i",{className:"bi bi-file-earmark-excel me-2"}),"Exportar seleccionados a Excel"]})}),e.jsx("div",{className:"col-12 col-md-auto",children:e.jsx("button",{className:"btn btn-primary w-100  bg-light bg-opacity-75 text-dark ",onClick:()=>k(!S),children:S?"Cerrar gráfico 📉":" Gráfico Fechas 📈"})})]})]}),o?e.jsx(oe,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-block d-sm-none",children:t.map(T=>{var L,Q;return e.jsx("div",{className:"card mb-3 shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("strong",{children:T.nombre_apellido}),e.jsx("input",{type:"checkbox",checked:i.includes(T.id),onChange:()=>me(T.id)})]}),A.unidad&&e.jsx("div",{children:e.jsx("span",{className:"badge bg-primary",children:T.unidad})}),A.dni&&e.jsxs("div",{children:["DNI: ",T.dni]}),A.comisaria&&e.jsxs("div",{children:["Comisaría: ",e.jsx("span",{className:"badge bg-pink",children:T.comisaria})]}),A.ingreso&&e.jsxs("div",{children:["Ingreso: ",(L=T.fecha_ingreso_validado)==null?void 0:L.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),A.salida&&e.jsxs("div",{children:["Salida: ",(Q=T.salida_art)==null?void 0:Q.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),A.usuarioSalida&&e.jsxs("div",{children:["Usuario salida: ",e.jsx("span",{className:"badge bg-teal",children:T.salida_art_usuario})]})]})},T.id)})}),P.map(({id:T,componente:L})=>e.jsxs("div",{draggable:!0,onDragStart:()=>R(T),onDragOver:J,onDrop:()=>ne(T),className:"my-3 ",children:[L==="ColumnasVisiblesPanel"&&e.jsx(oa,{columnasVisibles:A,setColumnasVisibles:V,visible:F,setVisible:_}),L==="ResumenTotales"&&e.jsx(ra,{personas:t,seleccionadas:i,visible:y,setVisible:w}),L==="FiltrosPanel"&&e.jsx(na,{searchTerm:g,setSearchTerm:x,orden:u,setOrden:p,prioridadFilter:m,setPrioridadFilter:j,comisariaFilter:c,setComisariaFilter:b,fechaInicio:h,setFechaInicio:f,fechaFin:v,setFechaFin:N,personas:s,visible:C,setVisible:E}),L==="GraficoPorFechaIngreso"&&S&&e.jsx(la,{personas:t,visible:S,setVisible:k}),L==="TablaDatos"&&e.jsx(ca,{filteredPersonas:t,selectedDocs:i,toggleSelectAll:he,toggleSelectDoc:me,columnasVisibles:A})]},T))]})]})},Fi=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState(!0),[g,x]=a.useState(""),[m,j]=a.useState(""),[u,p]=a.useState("asc"),[c,b]=a.useState(""),[h,f]=a.useState(""),[v,N]=a.useState(""),[S,k]=a.useState(!1),[y,w]=a.useState(!1),[C,E]=a.useState(!1),[F,_]=a.useState(!1),I=[{id:"columnas",componente:"ColumnasVisiblesPanel"},{id:"resumen",componente:"ResumenTotales"},{id:"filtros",componente:"FiltrosPanel"},{id:"grafico",componente:"GraficoPorFechaIngreso"},{id:"tabla",componente:"TablaDatos"}],[P,U]=a.useState(I),[K,G]=a.useState(null),[A,V]=a.useState({unidad:!0,dni:!0,comisaria:!0,ingreso:!1,salida:!1,usuarioSalida:!1}),H=W(D,"db_art_diez_bis"),Z=async()=>{d(!0);try{const L=(await re(H)).docs.map(Q=>({...Q.data(),id:Q.id}));l(L),n(L)}catch(T){console.error("Error al obtener personas: ",T)}finally{d(!1)}},z=T=>T.sort((L,Q)=>u==="asc"?L.nombre_apellido.localeCompare(Q.nombre_apellido):Q.nombre_apellido.localeCompare(L.nombre_apellido)),R=T=>{G(T)},J=T=>{T.preventDefault()},ne=T=>{const L=[...P],Q=L.findIndex(M=>M.id===K),X=L.findIndex(M=>M.id===T),[se]=L.splice(Q,1);L.splice(X,0,se),U(L)};a.useEffect(()=>{Z()},[]),a.useEffect(()=>{const T=s.filter(L=>L.nombre_apellido&&L.nombre_apellido.toLowerCase().includes(g.toLowerCase())).filter(L=>m?L.unidad===m:!0).filter(L=>c?L.comisaria===c:!0).filter(L=>{var M;if(!h&&!v)return!0;const Q=(M=L.fecha_ingreso_validado)==null?void 0:M.toDate();if(!Q)return!1;const X=h?new Date(h):null,se=v?new Date(v):null;return!(X&&Q<X||se&&Q>se)});n(z(T))},[g,m,c,h,v,u,s]);const me=T=>{r(L=>L.includes(T)?L.filter(Q=>Q!==T):[...L,T])},he=()=>{if(i.length===t.length)r([]);else{const T=t.map(L=>L.id);r(T)}},ae=()=>{const T=s.filter(se=>i.includes(se.id));if(T.length===0){alert("No hay personas seleccionadas para exportar.");return}const L=T.map(se=>{var M,ee;return{Nombre:se.nombre_apellido,Documento:se.dni,Unidad:se.unidad,Comisaría:se.comisaria,"Fecha Ingreso":(M=se.fecha_ingreso_validado)==null?void 0:M.toDate().toLocaleString("es-AR"),"Fecha Salida":(ee=se.salida_art)==null?void 0:ee.toDate().toLocaleString("es-AR"),"Usuario Salida":se.salida_art_usuario}}),Q=ye.json_to_sheet(L),X=ye.book_new();ye.book_append_sheet(X,Q,"Seleccionados"),Ge(X,"personas_seleccionadas.xlsx")};return e.jsxs("div",{className:"container-lg my-5 my-sm-5 my-md-0 my-lg-5 text-light",children:[e.jsx("div",{className:"row",children:e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Listado de Art. 10 Bis Activos"})}),e.jsxs("div",{className:"container mb-4",children:[e.jsxs("div",{className:"row g-2 align-items-center justify-content-center",children:[e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${y?"btn-light":"btn-outline-light"}`,onClick:()=>w(!y),children:[e.jsx("i",{className:`bi ${y?"bi-eye-slash":"bi-eye"} me-1`}),y?"Ocultar resumen":"Ver resumen"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${C?"btn-light":"btn-outline-light"}`,onClick:()=>E(!C),children:[e.jsx("i",{className:`bi ${C?"bi-eye-slash":"bi-eye"} me-1`}),C?"Ocultar filtro":"Ver filtro"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${F?"btn-light":"btn-outline-light"}`,onClick:()=>_(!F),children:[e.jsx("i",{className:`bi ${F?"bi-eye-slash":"bi-eye"} me-1`}),F?"Ocultar columnas":"Ver columnas"]})})]}),e.jsxs("div",{className:"row my-3 row g-2 align-items-center justify-content-center",children:["  ",e.jsx("div",{className:"col-12 col-md-auto",children:e.jsxs("button",{className:"btn btn-green w-100",onClick:ae,disabled:i.length===0,children:[e.jsx("i",{className:"bi bi-file-earmark-excel me-2"}),"Exportar seleccionados a Excel"]})}),e.jsx("div",{className:"col-12 col-md-auto",children:e.jsx("button",{className:"btn btn-primary w-100",onClick:()=>k(!S),children:S?"Cerrar gráfico 📉":" Gráfico Fechas 📈"})})]})]}),o?e.jsx(oe,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-info mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-block d-sm-none",children:t.map(T=>{var L,Q;return e.jsx("div",{className:"card mb-3 shadow-sm",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("strong",{children:T.nombre_apellido}),e.jsx("input",{type:"checkbox",checked:i.includes(T.id),onChange:()=>me(T.id)})]}),A.unidad&&e.jsx("div",{children:e.jsx("span",{className:"badge bg-primary",children:T.unidad})}),A.dni&&e.jsxs("div",{children:["DNI: ",T.dni]}),A.comisaria&&e.jsxs("div",{children:["Comisaría: ",e.jsx("span",{className:"badge bg-pink",children:T.comisaria})]}),A.ingreso&&e.jsxs("div",{children:["Ingreso: ",(L=T.fecha_ingreso_validado)==null?void 0:L.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),A.salida&&e.jsxs("div",{children:["Salida: ",(Q=T.salida_art)==null?void 0:Q.toDate().toLocaleString("es-AR",{dateStyle:"short",timeStyle:"short",timeZone:"America/Argentina/Buenos_Aires"})]}),A.usuarioSalida&&e.jsxs("div",{children:["Usuario salida: ",e.jsx("span",{className:"badge bg-teal",children:T.salida_art_usuario})]})]})},T.id)})}),P.map(({id:T,componente:L})=>e.jsxs("div",{draggable:!0,onDragStart:()=>R(T),onDragOver:J,onDrop:()=>ne(T),className:"my-3 ",children:[L==="ColumnasVisiblesPanel"&&e.jsx(oa,{columnasVisibles:A,setColumnasVisibles:V,visible:F,setVisible:_}),L==="ResumenTotales"&&e.jsx(ra,{personas:t,seleccionadas:i,visible:y,setVisible:w}),L==="FiltrosPanel"&&e.jsx(na,{searchTerm:g,setSearchTerm:x,orden:u,setOrden:p,prioridadFilter:m,setPrioridadFilter:j,comisariaFilter:c,setComisariaFilter:b,fechaInicio:h,setFechaInicio:f,fechaFin:v,setFechaFin:N,personas:s,visible:C,setVisible:E}),L==="GraficoPorFechaIngreso"&&S&&e.jsx(la,{personas:t,visible:S,setVisible:k}),L==="TablaDatos"&&e.jsx(ca,{filteredPersonas:t,selectedDocs:i,toggleSelectAll:he,toggleSelectDoc:me,columnasVisibles:A})]},T))]})})]})},Di=()=>{const[s,l]=a.useState([]),[t,n]=a.useState(""),[i,r]=a.useState("plazas"),[o,d]=a.useState(!0),[g,x]=a.useState(!1),[m,j]=a.useState({comisariaNombre:"",comisariaNumero:"",disponibilidad:!0,plazas_art_10_bis:""}),[u,p]=a.useState({}),[c,b]=a.useState({comisariaNombre:!1,plazas_art_10_bis:!1}),h="1234",f=async()=>{d(!0);try{const I=(await re(W(D,"db_comisarias"))).docs.map(P=>({id:P.id,...P.data()}));l(I)}catch(_){console.error("Error al obtener las comisarías: ",_)}finally{d(!1)}};a.useEffect(()=>{f()},[]);const v=_=>{const{name:I,value:P,type:U,checked:K}=_.target;if(!(I==="comisariaNombre"&&(!/^[A-Za-zÁÉÍÓÚÑáéíóúñ\s]*$/.test(P)||P.startsWith(" ")))){if(I==="comisariaNumero"){if(P===""||/^\d+$/.test(P)&&Number(P)<=40&&Number(P)>=0){j({...m,[I]:P});return}return}if(I==="plazas_art_10_bis"){const G=parseInt(P,10);P!==""&&(isNaN(G)||G<0||G>99)?b({...c,plazas_art_10_bis:!0}):b({...c,plazas_art_10_bis:!1})}j({...m,[I]:U==="checkbox"?K:P})}},N=(_,I,P)=>{p({...u,[_]:{...u[_],[I]:I==="disponibilidad"?P==="true":P}})},S=async _=>{const{plazas_art_10_bis:I,disponibilidad:P}=u[_]||{};if(window.confirm("¿Estás seguro de que quieres guardar los cambios?"))try{const K=B(D,"db_comisarias",_),G={};if(I!==void 0){const A=parseInt(I,10);if(isNaN(A)||A<0||A>30){alert("Por favor, ingresa un número válido de plazas entre 0 y 30.");return}G.plazas_art_10_bis=A}P!==void 0&&(G.disponibilidad=P),await le(K,G),p(A=>{const V={...A};return delete V[_],V}),f()}catch(K){console.error("Error al actualizar comisaría: ",K)}},y=(()=>{const _=localStorage.getItem("user");return _?JSON.parse(_):null})(),w=async _=>{_.preventDefault();const I=m.comisariaNombre.trim(),P=m.comisariaNumero.trim(),U=parseInt(m.plazas_art_10_bis,10),K={comisariaNombre:!I,plazas_art_10_bis:isNaN(U)||U<0||U>99};if(b(K),Object.values(K).some(z=>z)||!window.confirm("¿Estás seguro de agregar esta comisaría?"))return;if(prompt("⚠️ Para continuar, ingresá el código llave:")!==h){alert("❌ Código incorrecto. No se agrego la comisaría.");return}const V=P?`${I} ${parseInt(P,10)}`.toLowerCase():I.toLowerCase(),H=new Date,Z=`${H.getDate().toString().padStart(2,"0")}/${(H.getMonth()+1).toString().padStart(2,"0")}/${H.getFullYear().toString().slice(-2)}`;try{await Pe(W(D,"db_comisarias"),{comisaria:V,plazas_art_10_bis:U,disponibilidad:m.disponibilidad,usuario:y.email,fecha:Z}),j({comisariaNombre:"",comisariaNumero:"",disponibilidad:!0,plazas_art_10_bis:""}),f(),alert("Comisaría agregada con éxito.")}catch(z){console.error("Error al agregar comisaría: ",z)}},C=async _=>{if(!window.confirm("¿Estás seguro de que quieres eliminar esta comisaría?"))return;if(prompt("⚠️ Para continuar, ingresá el código llave:")!==h){alert("❌ Código incorrecto. No se eliminará la comisaría.");return}try{const U=B(D,"db_comisarias",_);await je(U),f(),alert("✅ Comisaría eliminada correctamente.")}catch(U){console.error("Error al eliminar comisaría: ",U)}},F=[...s.filter(_=>_.comisaria.toLowerCase().includes(t.toLowerCase()))].sort((_,I)=>i==="plazas"?I.plazas_art_10_bis-_.plazas_art_10_bis:i==="nombre"?_.comisaria.localeCompare(I.comisaria):i==="estado"?_.disponibilidad===I.disponibilidad?0:_.disponibilidad?-1:1:0);return e.jsxs("div",{className:"container mt-0 mt-5 mt-sm-5 mt-md-0 my-lg-5 ",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0 mt-5",children:"Comisarias / Plazas"}),e.jsx("div",{className:"row",children:e.jsxs("div",{className:"card shadow position-relative  d-flex align-items-start gap-3  p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",style:{overflow:"visible"},children:[e.jsx("div",{className:"bg-red",children:e.jsx("img",{src:"img/tupel.gif",alt:"Asistente",className:"position-absolute rounded-circle shadow p-2",style:{width:"130px",height:"auto",objectFit:"contain",top:"-15px",left:"-10px"}})}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"130px"},children:[e.jsx("h5",{children:"Bienvenido 👮‍♂️ "}),e.jsx("p",{className:"mb-3 text-capitalize m-0",children:"Puedes crear una nueva comisaría, administrando sus plazas disponibles y estado"}),e.jsx("div",{className:"d-flex justify-content-end align-items-center",children:e.jsxs("button",{className:`btn fw-semibold  ${g?"btn-outline-light":"btn-light"}`,onClick:()=>x(!g),children:[e.jsx("i",{className:"bi bi-shield-plus me-2"}),g?"Cancelar":"Nueva Comisaría"]})})]})]})}),g&&e.jsx("form",{onSubmit:w,className:"my-5",children:e.jsxs("div",{className:"row g-3 justify-content-center p-4 bg-light bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("div",{className:"col-12 col-md-5",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"text",className:`form-control ${c.comisariaNombre?"is-invalid":""}`,id:"comisariaNombre",name:"comisariaNombre",value:m.comisariaNombre,onChange:v}),e.jsx("label",{htmlFor:"comisariaNombre",children:"Nombre Comisaría"}),c.comisariaNombre&&e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten letras y espacios (no al inicio)."})]})}),e.jsx("div",{className:"col-12 col-md-3",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"number",className:`form-control ${c.comisariaNumero?"is-invalid":""}`,id:"comisariaNumero",name:"comisariaNumero",value:m.comisariaNumero,onChange:v}),e.jsx("label",{htmlFor:"comisariaNumero",children:"Número Comisaría"}),c.comisariaNumero&&e.jsx("div",{className:"invalid-feedback",children:"Solo números."})]})}),e.jsx("div",{className:"col-12 col-md-3",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("input",{type:"number",className:`form-control ${c.plazas_art_10_bis?"is-invalid":""}`,id:"plazas_art_10_bis",name:"plazas_art_10_bis",value:m.plazas_art_10_bis,onChange:v}),e.jsx("label",{htmlFor:"plazas_art_10_bis",children:"Plazas Art. 10 Bis"}),c.plazas_art_10_bis&&e.jsx("div",{className:"invalid-feedback",children:"Debe ingresar un número válido de plazas."})]})}),e.jsx("div",{className:"col-12 col-md-1 d-flex align-items-center justify-content-center",children:e.jsx("button",{type:"submit",className:"btn btn-primary fw-semibold rounded-circle shadow-sm",children:e.jsx("i",{className:"bi bi-plus titilar"})})})]})}),e.jsxs("h3",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-white mt-5",children:["Administrar Comisarías ",e.jsx("i",{className:"ms-2 bi bi-list"})]}),e.jsx("div",{className:"container my-4",children:e.jsxs("div",{className:"row justify-content-center",children:[e.jsx("div",{className:"col-12 col-md-5 mb-4 mb-md-0",children:e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-dark bg-opacity-50 text-white",children:e.jsx("i",{className:"bi bi-search text-white"})}),e.jsx("input",{type:"text",className:"form-control bg-light bg-opacity-50",placeholder:"Buscar por nombre de comisaría...",value:t,onChange:_=>n(_.target.value)})]})}),e.jsx("div",{className:"col-12 col-md-5",children:e.jsxs("div",{className:"form-floating ",children:[e.jsxs("select",{id:"sortOrder",className:"form-select ",value:i,onChange:_=>r(_.target.value),children:[e.jsx("option",{value:"plazas",children:"Plazas"}),e.jsx("option",{value:"nombre",children:"Nombre"}),e.jsx("option",{value:"estado",children:"Estado"})]}),e.jsx("label",{htmlFor:"sortOrder",children:"Ordenar por:"})]})})]})}),o?e.jsx(oe,{}):e.jsx("ul",{className:"list-group justify-content-center p-4  bg-opacity-50 rounded-4 shadow-lg",children:F.length===0?e.jsxs("li",{className:"list-group-item text-center text-muted  ",children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-danger"}),e.jsx("span",{className:"text-danger",children:" No hay comisarías registradas."})]}):F.map(({id:_,comisaria:I,plazas_art_10_bis:P,disponibilidad:U})=>{var K,G;return e.jsxs("li",{className:"list-group-item mb-3 justify-content-center p-4 bg-light bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-3 d-flex align-items-center mb-2 mb-md-0",children:[e.jsx("div",{className:"spinner-grow spinner-grow-sm me-2 text-purple",role:"status"}),e.jsxs("span",{className:"badge Gradiante25 me-2 text-capitalize",children:[I,"°"]})]}),e.jsxs("div",{className:"col-12 col-md-3 d-flex align-items-center mb-2 mb-md-0",children:[e.jsx("span",{className:"badge bg-primaryMuiBlue me-2",children:"Plazas"}),e.jsx("input",{type:"number",value:((K=u[_])==null?void 0:K.plazas_art_10_bis)??P,onChange:A=>N(_,"plazas_art_10_bis",A.target.value),className:"form-control d-inline-block  bg-light bg-opacity-50",style:{maxWidth:"120px"}})]}),e.jsxs("div",{className:"col-12 col-md-4 d-flex align-items-center mb-2 mb-md-0",children:[e.jsx("span",{className:`badge ${U?"bg-teal":"bg-danger"} me-2`,children:"Estado"}),e.jsxs("select",{value:((G=u[_])==null?void 0:G.disponibilidad)??U,onChange:A=>N(_,"disponibilidad",A.target.value),className:"form-select d-inline-block  bg-light bg-opacity-50",children:[e.jsx("option",{value:!0,children:"Disponible 👍"}),e.jsx("option",{value:!1,children:"Llena ✋ "})]})]})]}),e.jsxs("div",{className:"d-flex justify-content-start justify-content-md-end w-100 mt-2 mt-md-0",children:[u[_]&&e.jsx("button",{className:"btn btn-sm btn-primary me-2 rounded-circle",onClick:()=>S(_),children:e.jsx("i",{className:"bi bi-floppy2"})}),e.jsx("button",{className:"btn btn-sm btn-danger rounded-circle text-white",onClick:()=>C(_),children:e.jsx("i",{className:"bi bi-trash"})})]})]},_)})})]})},Ai=({personas:s,seleccionadas:l=[],visible:t,setVisible:n})=>{a.useEffect(()=>{console.log("Selected IDs recibidos:",s,l)},[s,l]);const i=a.useMemo(()=>{var u,p;const r=s.length,o=l.length,d={},g={},x={};s.forEach(c=>{const b=c.unidad||"Sin unidad",h=c.comisaria||"Sin comisaría",f=c.salida_art_usuario||"Sin usuario";d[b]=(d[b]||0)+1,g[h]=(g[h]||0)+1,x[f]=(x[f]||0)+1});const m=((u=Object.entries(d).sort((c,b)=>b[1]-c[1])[0])==null?void 0:u[0])||null,j=((p=Object.entries(g).sort((c,b)=>b[1]-c[1])[0])==null?void 0:p[0])||null;return{total:r,totalSeleccionadas:o,porUnidad:d,porComisaria:g,topUnidad:m,topComisaria:j,salidaUsuarios:x}},[s,l]);return e.jsx("div",{className:"mb-4",children:t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>n(!t)})}),e.jsxs("div",{className:"row row-cols-1 row-cols-md-4 g-3",children:[e.jsx("div",{className:"col ",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100 ",children:[e.jsxs("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center mb-3",style:{width:"60px",height:"60px",backgroundColor:"rgba(13, 110, 253, 0.1)"},children:e.jsx("i",{className:"bi bi-people fs-3 text-primary"})}),e.jsx("h6",{className:"card-title text-muted mb-1",children:"Total registros"}),e.jsx("span",{className:"badge bg-primary fs-5 px-3 py-2 rounded-pill shadow-sm",children:i.total})]}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#0d6efd",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card border-0 shadow-sm h-100",children:[e.jsx("div",{className:"card-body text-center d-flex flex-column justify-content-center align-items-center",children:e.jsx("img",{src:"img/trophy.png",alt:"Trofeo",className:"rounded-circle shadow p-4",style:{width:"150px",height:"150px",objectFit:"contain"}})}),e.jsx("div",{className:"w-100",style:{height:"5px",backgroundColor:"#03dac6",borderBottomLeftRadius:"0.5rem",borderBottomRightRadius:"0.5rem"}})]})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card shadow-sm border-0 h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-car-front text-primary me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Unidades"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porUnidad).map(([r,o])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsxs("span",{children:[r," ",r===i.topUnidad&&"🏆"]}),e.jsx("span",{className:"badge bg-primary mb-2",children:o})]},r))})]})})}),e.jsx("div",{className:"col",children:e.jsx("div",{className:"card shadow-sm border-0 h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("i",{className:"bi bi-shield-lock text-primary me-2 fs-4"}),e.jsx("h6",{className:"card-title mb-0",children:"Comisarías"})]}),e.jsx("ul",{className:"list-unstyled small mb-0",children:Object.entries(i.porComisaria).map(([r,o])=>e.jsxs("li",{className:"d-flex justify-content-between",children:[e.jsxs("span",{children:[r," ",r===i.topComisaria&&"🏆"]}),e.jsx("span",{className:"badge bg-secondary mb-2",children:o})]},r))})]})})})]})]})})},Mi=({personas:s,visible:l,setVisible:t})=>{const n=a.useMemo(()=>{const r={},o={};return s.forEach(d=>{const g=d.salida_art_usuario;if(g){r[g]=(r[g]||0)+1;const x=d.comisaria||"Sin comisaría";o[g]||(o[g]={}),o[g][x]=(o[g][x]||0)+1}}),{conteo:r,comisariasPorUsuario:o}},[s]),i=a.useMemo(()=>{const r=Object.entries(n.conteo);return r.length===0?null:r.sort((o,d)=>d[1]-o[1])[0][0]},[n]);return l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>t(!1)})}),e.jsx("div",{className:"card shadow-sm border-0",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title mb-3",children:[e.jsx("i",{className:"bi bi-person-check-fill text-primary2 me-2"}),"Personal Comisaría Salida"]}),Object.keys(n.conteo).length===0?e.jsx("p",{className:"text-muted",children:"No hay registros de salida."}):e.jsx("ul",{className:"list-group list-group-flush",children:Object.entries(n.conteo).sort((r,o)=>o[1]-r[1]).map(([r,o])=>{let d="";if(r==="sistema")d="Automático DG OJO ⚠️";else{const g=n.comisariasPorUsuario[r];d=Object.entries(g).sort((x,m)=>m[1]-x[1]).map(([x,m])=>`${x} (${m})`).join(", ")}return e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"fw-semibold",children:[r===i&&"🏆","  ",r]}),e.jsxs("div",{className:"text-muted small",children:["🏢 ",d]})]}),e.jsx("span",{className:"badge bg-primary2 rounded-pill",children:o})]},r)})})]})})]}):null},Pi=({visible:s,setVisible:l})=>{const[t,n]=a.useState([]);a.useEffect(()=>{(async()=>{const g=(await re(W(D,"db_art_diez_bis_desactivados"))).docs.map(x=>x.data());n(g)})()},[]);const i=a.useMemo(()=>{const o={};return t.forEach(d=>{Array.isArray(d.personal_entrega)&&d.personal_entrega.forEach(g=>{var u;const x=g.ni,m=((u=g.nombre)==null?void 0:u.split(" ")[0])||g.nombre,j=d.comisaria;o[x]||(o[x]={nombre:m,count:0,comisarias:{}}),o[x].count+=1,j&&(o[x].comisarias[j]=(o[x].comisarias[j]||0)+1)})}),o},[t]);if(!s)return null;const r=Object.entries(i).sort((o,d)=>d[1].count-o[1].count);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"button",className:"btn-close bg-white ms-auto mb-2",onClick:()=>l(!1)})}),e.jsx("div",{className:"card shadow-sm border-0",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("h5",{className:"card-title mb-3",children:[e.jsx("i",{className:"bi bi-award-fill text-primaryMuiBlue me-2"}),"Personal Entregas Destacadas"]}),r.length===0?e.jsx("p",{className:"text-muted",children:"No hay registros de entrega."}):e.jsx("ul",{className:"list-group list-group-flush",children:r.map(([o,d],g)=>{const{nombre:x,count:m,comisarias:j}=d,u=t.find(h=>(h.personal_entrega||[]).some(f=>`${f.ni}`===o)),p=(u==null?void 0:u.unidad)||"OTROS";let c="",b="bg-primaryMuiBlue";return g===0?(c="👑",b="bg-yellowMui"):g===1?(c="🥈",b="bg-yellowMui"):g===2&&(c="🥉",b="bg-yellowMui"),e.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"fw-semibold",children:[c," ",x," - ",o]}),e.jsxs("div",{className:"text-muted small",children:[p.toUpperCase().includes("MOTORIZADA")?"🏍️":"🚓"," ",p]})]}),e.jsxs("div",{className:"text-end",children:[e.jsx("span",{className:`badge ${b} rounded-pill`,children:m}),e.jsxs("div",{className:"mt-2 text-muted small text-start",children:[e.jsx("strong",{children:"📍 Comisarías:"}),e.jsx("ul",{className:"mb-0 ps-3",children:Object.entries(j).map(([h,f])=>e.jsxs("li",{children:[h,": ",f," ",f===1?"vez":"veces"]},h))})]})]})]},`${o}-${g}`)})})]})})]})},Ii=({personas:s})=>{const[l,t]=a.useState(null);return a.useEffect(()=>{let n=0,i=0;if(s.forEach(r=>{var g,x;const o=(g=r.fecha_ingreso_validado)==null?void 0:g.toDate(),d=(x=r.salida_art)==null?void 0:x.toDate();if(o&&d&&!isNaN(o)&&!isNaN(d)){const m=d-o;m>=0&&(n+=m,i++)}}),i>0){const r=n/i,o=Math.floor(r/(1e3*60*60)),d=Math.floor(r%(1e3*60*60)/(1e3*60)),g=Math.floor(r%(1e3*60)/1e3);t({horas:o,minutos:d,segundos:g})}else t(null)},[s]),e.jsx("div",{className:"card shadow my-5 border-0 p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",children:e.jsxs("div",{className:"card-body  ",children:[e.jsx("h5",{className:"card-title rounded-3",children:"⏱️ Tiempo Promedio entre Ingreso y Salida"}),l?e.jsx("div",{className:" d-flex justify-content-end align-items-end",children:e.jsxs("p",{className:"mb-0 fs-5 me-3 ",children:[e.jsxs("strong",{children:[l.horas,"h ",l.minutos,"m ",l.segundos,"s"]})," ",e.jsx("span",{className:"titilar",children:" ⏳ "})]})}):e.jsx("p",{className:"text-muted mb-0 ",children:"No hay datos válidos para calcular."})]})})},Li=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState(!0),[g,x]=a.useState(""),[m,j]=a.useState(""),[u,p]=a.useState("asc"),[c,b]=a.useState(""),[h,f]=a.useState(""),[v,N]=a.useState(""),[S,k]=a.useState(!1),[y,w]=a.useState(!1),[C,E]=a.useState(!1),F=[{id:"columnas",componente:"ColumnasVisiblesPanel"},{id:"resumen",componente:"ResumenTotalesRendimiento"},{id:"personalEntregaCard",componente:"PersonalEntregaCard"},{id:"personalSalidaCard",componente:"PersonalSalidaCard"},{id:"filtros",componente:"FiltrosPanel"},{id:"grafico",componente:"GraficoPorFechaIngreso"},{id:"card",componente:"CardInfo"},{id:"cardComisaria",componente:"ComisariaCardInfo"},{id:"tablaRendimiento",componente:"TablaDatosRendimiento"}],[_,I]=a.useState(F),[P,U]=a.useState(null);console.log(_);const K=W(D,"db_art_diez_bis_desactivados"),G=async()=>{d(!0);try{const R=(await re(K)).docs.map(J=>({...J.data(),id:J.id}));l(R),n(R)}catch(z){console.error("Error al obtener personas: ",z)}finally{d(!1)}},A=z=>z.sort((R,J)=>u==="asc"?R.nombre_apellido.localeCompare(J.nombre_apellido):J.nombre_apellido.localeCompare(R.nombre_apellido)),V=z=>{U(z)},H=z=>{z.preventDefault()},Z=z=>{const R=[..._],J=R.findIndex(he=>he.id===P),ne=R.findIndex(he=>he.id===z),[me]=R.splice(J,1);R.splice(ne,0,me),I(R)};return a.useEffect(()=>{G()},[]),a.useEffect(()=>{const z=s.filter(R=>R.nombre_apellido&&R.nombre_apellido.toLowerCase().includes(g.toLowerCase())).filter(R=>m?R.unidad===m:!0).filter(R=>c?R.comisaria===c:!0).filter(R=>{var he;if(!h&&!v)return!0;const J=(he=R.fecha_ingreso_validado)==null?void 0:he.toDate();if(!J)return!1;const ne=h?new Date(h):null,me=v?new Date(v):null;return!(ne&&J<ne||me&&J>me)});n(A(z))},[g,m,c,h,v,u,s]),e.jsxs("div",{className:"  my-sm-5 my-md-5 my-lg-5 my-5 text-light ",children:[e.jsx("div",{className:"row",children:e.jsx("h1",{className:"text-center  animate__animated animate__bounce mt-sm-0 ",children:"Rendimiento Art. 10 Bis"})}),e.jsx("div",{className:"container my-4",children:e.jsxs("div",{className:"row g-2 align-items-center justify-content-center",children:[e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${S?"btn-light":"btn-outline-light"}`,onClick:()=>k(!S),children:[e.jsx("i",{className:`bi ${S?"bi-eye-slash":"bi-eye"} me-1`}),S?"Ocultar resumen":"Ver resumen"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${y?"btn-light":"btn-outline-light"}`,onClick:()=>w(!y),children:[e.jsx("i",{className:`bi ${y?"bi-eye-slash":"bi-eye"} me-1`}),y?"Ocultar Persdonal Salida":"Ver Personal Salida"]})}),e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-auto",children:e.jsxs("button",{className:`btn w-100 ${C?"btn-light":"btn-outline-light"}`,onClick:()=>E(!C),children:[e.jsx("i",{className:`bi ${C?"bi-eye-slash":"bi-eye"} me-1`}),C?"Ocultar Personal Entrada":"Ver Personal Entrada"]})})]})}),e.jsx(Ii,{personas:s,visible:C,setVisible:E}),o?e.jsx(oe,{}):e.jsx(e.Fragment,{children:_.map(({id:z,componente:R})=>e.jsxs("div",{draggable:!0,onDragStart:()=>V(z),onDragOver:H,onDrop:()=>Z(z),className:"my-3 ",children:[R==="ResumenTotalesRendimiento"&&e.jsx(Ai,{personas:t,seleccionadas:i,visible:S,setVisible:k}),R==="PersonalEntregaCard"&&e.jsx(Pi,{personas:s,visible:C,setVisible:E}),R==="PersonalSalidaCard"&&e.jsx(Mi,{personas:s,visible:y,setVisible:w})]},z))})]})},$i="/gif/dash3.gif",Ri=()=>e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center text-white",style:{minHeight:"55vh"},children:[e.jsx("h5",{className:" fs-1 mb-5 text-greenW ",children:"Bienvenido al Panel 10 Bis !!!"}),e.jsxs("div",{className:"row justify-content-center my-4  ",children:[e.jsxs("div",{className:"col-md-6 d-flex flex-column justify-content-center align-items-center mb-4 mb-md-0",children:[e.jsxs("p",{className:"p-2 text-center",children:[e.jsx("i",{className:"bi bi-asterisk p-3 rounded-circle me-3 bg-greenOn text-indigo"}),"Aquí podrás administrar los recursos del sistema de forma fácil y sencilla."]}),e.jsxs("p",{className:"p-2 text-center",children:[e.jsx("i",{className:"bi bi-lightbulb p-3 rounded-circle me-3 bg-greenOn text-indigo"}),"Recuerda que, ante cualquier problema, puedes solicitar asistencia técnica."]})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-center align-items-center",children:e.jsx("img",{src:$i,alt:"Descripción de la imagen",className:"img-fluid p-2 rounded-circle shadow ",style:{maxWidth:"300px",height:"auto"}})})]})]}),zi=()=>{const[s,l]=a.useState("dashboard"),[t,n]=a.useState(!1),i=()=>{switch(s){case"dashboard":return e.jsx(Ri,{});case"administar":return e.jsx(fi,{});case"exportacion":return e.jsx(Ni,{});case"graficos":return e.jsx(ki,{});case"comisarias2":return e.jsx(Di,{});case"rendimiento":return e.jsx(_i,{});case"rendimientoApp":return e.jsx(Li,{});case"desactivados":return e.jsx(Ei,{});case"activados":return e.jsx(Fi,{});default:return e.jsx("p",{children:"Selecciona una opción del menú."})}};return e.jsx("div",{className:"container-lg",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 col-md-4 col-lg-3 ",children:[e.jsx("div",{className:"text-center mb-4 text-light",children:e.jsxs("span",{className:"bg-dark bg-opacity-25 p-2 px-5 fs-6 rounded-5 text-white",children:[" ",e.jsx("i",{className:"mx-2 bi bi-menu-button-fill"}),"Menú Panel"]})}),e.jsxs("div",{className:"list-group p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="dashboard"?"active":""}`,onClick:()=>l("dashboard"),children:"Bienvenidos"}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="exportacion"?"active":""}`,onClick:()=>l("exportacion"),children:"Exportación"}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action${s==="graficos"?"active":""}`,onClick:()=>l("graficos"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Graficos",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-light",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-teal rounded-pill",children:"Nuevo"})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="rendimientoApp"?"active":""}`,onClick:()=>l("rendimientoApp"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Rendimiento Art.10 Bis",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"",children:" 🏆 "})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="comisarias2"?"active":""}`,onClick:()=>l("comisarias2"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Comisarias",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-primaryMuiBlue rounded-pill",children:"Administar"})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="activados"?"active":""}`,onClick:()=>l("activados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Art 10 Bis Activos",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-secondaryM rounded-pill",children:"Panel"})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="desactivados"?"active":""}`,onClick:()=>l("desactivados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Art 10 Bis Historicos",t?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-secondaryM rounded-pill",children:"Panel"})]})})]})]}),e.jsx("div",{className:"col-12 col-md-8 col-lg-9",children:i()})]})})},Ti=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Panel de Control"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5",children:["  ",e.jsx(Fe,{Promp:"Panel de Control 10 Bis",Promp2:"bi bi-code-slash fs-4 "}),"   "]}),e.jsx(zi,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},Bi=()=>e.jsx(e.Fragment,{children:e.jsx(Ti,{})}),Oi={nombre:"Santa Fe Tema",valor:"linear-gradient(135deg, #ec4899, #8b5cf6)",tipo:"gradiente"},Ui=[{nombre:"🎨 Santa Fe Theme",valor:"linear-gradient(135deg, #ec4899, #8b5cf6)"},{nombre:"💗 Rosa Chicle",valor:"#f73378"},{nombre:"🌞 Amarillo Sol",valor:"#ffef62"},{nombre:"💦 Celeste Aqua",valor:"#16B1FF"},{nombre:"🔮 Violeta Mágico",valor:"#8C57FF"},{nombre:"🍊 Naranja Fuego",valor:"#ff8f00"},{nombre:"🍇 Púrpura Uva",valor:"#7e57c2"},{nombre:"💙 Azul Profundo",valor:"#3c3ae5"},{nombre:"⚡ Azul Eléctrico",valor:"#0d6efd"},{nombre:"🌿 Verde Menta",valor:"#03dac6"},{nombre:"🍵 Verde Té",valor:"#20c997"},{nombre:"🧪 Verde Neón",valor:"#05F2D4"},{nombre:"🚨 Rojo Alerta",valor:"#f50057"},{nombre:"🪨 Gris Urbano",valor:"#757575"},{nombre:"🌫️ Gris Niebla",valor:"#f9f9f983"},{nombre:"🌌 Negro Noche",valor:"#212121"}],da=({setThemeBackgroundColor:s})=>{const[l,t]=a.useState(!1),[n,i]=a.useState(()=>localStorage.getItem("theme")==="dark"),[r,o]=a.useState(()=>localStorage.getItem("bgColor")||Oi.valor),d=x=>{t(!0),i(x==="dark"),localStorage.setItem("theme",x),setTimeout(()=>t(!1),500)},g=x=>{o(x),s(x),localStorage.setItem("bgColor",x)};return a.useEffect(()=>{const x=n?"dark":"light";document.body.setAttribute("data-bs-theme",x)},[n]),a.useEffect(()=>{s(r)},[r,s]),e.jsxs("div",{children:[l&&e.jsx(oe,{}),e.jsxs("div",{className:"dropdown position-fixed bottom-0 end-0 mb-3 me-3 bd-mode-toggle",children:[e.jsxs("button",{className:"btn btn-greenUi py-2 dropdown-toggle d-flex align-items-center rounded-4",id:"bd-theme",type:"button","aria-expanded":"false","data-bs-toggle":"dropdown","aria-label":"Toggle theme",children:[e.jsx("i",{className:n?"bi bi-moon-stars-fill":"bi bi-brightness-high-fill"}),e.jsx("span",{className:"visually-hidden",id:"bd-theme-text",children:"Toggle theme"})]}),e.jsxs("ul",{className:"dropdown-menu dropdown-menu-end shadow","aria-labelledby":"bd-theme-text",children:[e.jsx("li",{children:e.jsxs("button",{type:"button",className:`dropdown-item d-flex align-items-center ${n?"":"active"}`,onClick:()=>d("light"),children:[e.jsx("i",{className:"bi bi-brightness-high-fill me-2 opacity-50"}),"Modo Luz"]})}),e.jsx("li",{children:e.jsxs("button",{type:"button",className:`dropdown-item d-flex align-items-center ${n?"active":""}`,onClick:()=>d("dark"),children:[e.jsx("i",{className:"bi bi-moon-stars-fill me-2 opacity-50"}),"Modo Nocturno"]})}),e.jsx("li",{children:e.jsx("hr",{className:"dropdown-divider"})}),e.jsx("li",{className:"px-3",children:e.jsx("div",{className:"d-flex flex-wrap gap-2",children:Ui.map(({nombre:x,valor:m})=>e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>g(m),className:"rounded-circle border-0",style:{background:m,width:"24px",height:"24px",outline:m===r?"2px solid white":"none",cursor:"pointer"},title:x,"aria-label":x})},x))})})]})]})]})},qi=()=>{const[s,l]=a.useState(0);return a.useEffect(()=>{const t=[],n=()=>{l(0),t.push(setTimeout(()=>l(1),0)),t.push(setTimeout(()=>l(2),3e3)),t.push(setTimeout(()=>l(3),6e3))};n();const i=setInterval(()=>{n()},9e3);return()=>{t.forEach(clearTimeout),clearInterval(i)}},[]),e.jsx(e.Fragment,{children:e.jsx("div",{className:" text-white px-3",children:e.jsx("div",{className:"container d-flex justify-content-center align-items-center  ",children:e.jsxs("div",{className:"row align-items-center text-center text-md-start",children:[e.jsxs("div",{className:"col-12 col-md-6 mb-5 mb-md-0  ",children:[e.jsxs("div",{className:"p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg my-4",children:[e.jsx("h1",{className:"fw-bold display-1",children:"Cx2"}),e.jsx("h2",{className:"fw-semibold fs-4",children:"Santa Fe - Gestión diaria"}),e.jsx("div",{className:"badge bg-white text-dark fw-semibold px-3 py-1 my-2 ",children:" APP DIARIA, SIMPLE Y EFICIENTE.   "})]}),e.jsxs("div",{className:"p-4 bg-dark bg-opacity-25 rounded-4 shadow-lg",children:[e.jsx("p",{className:"fs-5 mt-3 text-center",children:"Tu herramienta ágil para controlar, organizar y comunicar información de forma simple y eficiente."}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("a",{href:"/denunciasimple",className:"btn btn-light  fw-semibold px-4 me-3",children:"Denuncia Simple "}),e.jsx("a",{className:"btn btn-outline-light fw-semibold px-4",children:"Administar"})]})]}),e.jsxs("div",{className:"mt-5 small ",children:[e.jsx("p",{children:"Versión: 1.0.0 | Actualización: 05/05/2025"}),e.jsxs("p",{children:["Soporte: ",e.jsx("a",{href:"mailto:ticsdesarrollo2024@gmail.com",className:"text-white text-decoration-underline",children:"ticsdesarrollo2024@gmail.com"})]})]})]}),e.jsx("div",{className:"col-12 col-md-6 d-flex justify-content-center",children:e.jsx("div",{className:"phone-frame bg-black rounded-4 p-2 shadow",children:e.jsxs("div",{className:"bg-white w-100 h-100 rounded-4 d-flex flex-column align-items-center pt-4 position-relative",children:[e.jsx("div",{className:"rounded-circle bg-gradiante2 d-flex align-items-center justify-content-center text-white fw-bold fs-3",style:{width:"80px",height:"80px"},children:e.jsx("span",{className:"shake",children:"🚀"})}),e.jsx("div",{className:"mt-1 fw-semibold text-dark",children:"Inicio App"}),e.jsxs("div",{className:"d-flex flex-column gap-3 mt-3",style:{width:"230px"},children:[s>=1&&e.jsxs("div",{className:"message-card bg-white text-dark rounded shadow p-2 align-self-start",children:[e.jsx("div",{className:"badge bg-primary text-white mb-1",children:"Usuario"}),e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("span",{className:"me-2 fs-4",children:"🗣️"}),e.jsx("p",{className:"mb-0 small",children:"¿Dónde debo registrar la denuncia?"})]})]}),s>=2&&e.jsxs("div",{className:"message-card bg-white text-dark rounded shadow p-2 align-self-end",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("div",{className:"badge bg-danger text-white mb-1",children:"Sistema BootSF"})}),e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("span",{className:"me-2 fs-4",children:"🤖"}),e.jsx("p",{className:"mb-0 small",children:"¡Hola! 🙌 Iniciá la denuncia simple y te voy guiando paso a paso 👋😉"})]}),e.jsxs("p",{className:"mb-0 small text-center mt-",children:["Tema a tratar: ",e.jsx("strong",{children:"Robo"})," • ",e.jsx("strong",{children:"Violencia"})," • ",e.jsx("strong",{children:"Otro"})," ❓"]})]}),s>=3&&e.jsxs("div",{className:"message-card bg-white text-dark rounded shadow p-2 align-self-start",children:[e.jsx("div",{className:"badge bg-primary text-white mb-1",children:"Usuario"}),e.jsxs("div",{className:"d-flex align-items-start",children:[e.jsx("span",{className:"me-2 fs-4",children:"🗣️"}),e.jsx("p",{className:"mb-0 small",children:"Entendido. Iniciaré una denuncia simple ahora."})]})]})]}),e.jsx("div",{className:"position-absolute text-center small text-muted",style:{bottom:"40px",padding:"0 1rem"},children:"“Simplificá tu jornada con Cx2”"})]})})})]})})})})},Vi=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),a.useEffect(()=>{const i=r=>{r.preventDefault(),r.returnValue="Estás a punto de dejar la página. ¿Quieres continuar?"};return window.addEventListener("beforeunload",i),()=>{window.removeEventListener("beforeunload",i)}},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Menu Inicio - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5",children:["  ",e.jsx(Fe,{Promp:"Denuncia Simple App ",Promp2:"bi bi-code-slash fs-4 "}),"   "]}),e.jsxs("div",{className:" d-flexjustify-content-center  text-white gap-5",children:[e.jsx(qi,{}),e.jsx(we,{})]})]}),e.jsx(da,{setThemeBackgroundColor:n})]})})},Gi=()=>e.jsx(e.Fragment,{children:e.jsx(Vi,{})}),Hi=({showModalNot:s,closeModalNot:l})=>{var v;const t=Ve(),[n,i]=a.useState(""),[r,o]=a.useState(""),[d,g]=a.useState("1"),[x,m]=a.useState(""),[j,u]=a.useState(!1),p=()=>{const N=new Date,S=String(N.getDate()).padStart(2,"0"),k=String(N.getMonth()+1).padStart(2,"0"),y=N.getFullYear().toString().slice(-2);return`${S}/${k}/${y}`};a.useEffect(()=>{if(t.pathname==="/informe"){const N=()=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",N),()=>{window.removeEventListener("popstate",N)}}},[t,l]);const b=(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null})();(v=b==null?void 0:b.email)!=null&&v.split("@")[0];const h=async N=>{if(N.preventDefault(),n.trim()===""){m("El informe no puede estar vacío.");return}if(n.length>500){m("El mensaje no puede exceder los 500 caracteres.");return}if(d===""){m("Por favor, selecciona una carátula.");return}m(""),u(!0);try{await Pe(W(D,"db_informes"),{titulo:r,contenido:n,timestamp:Re(),leido:!1,fecha:p(),caratula:d,usuario_posteo:b.email,perfil:"oficial",difusion:"privado"}),o(""),i(""),g("1"),l()}catch(S){console.error("Error al enviar notificación: ",S),m("Error al enviar la notificación. Inténtalo de nuevo.")}finally{u(!1)}},f=()=>{i(""),g("1"),m(""),l()};return e.jsx("div",{className:`modal bg-dark ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header text-center   text-dark",children:[e.jsxs("h3",{className:"modal-title text-center ",id:"modalTitle",children:["Crear Informe ",e.jsx("i",{className:"bi bi-code-slash ms-2 titilar ",style:{fontSize:"1.8rem"}})]}),e.jsx("button",{type:"button",className:"btn-close ",onClick:f})]}),e.jsx("div",{className:"modal-body bg-light  ",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsxs("form",{onSubmit:h,children:[e.jsx("div",{className:"mb-3 text-center  ",children:e.jsxs("div",{className:"form-floating ",children:[e.jsx("textarea",{className:"form-control shadow-sm ",placeholder:"Escribe el mensaje aquí",id:"titulo",value:r,onChange:N=>o(N.target.value)}),e.jsx("label",{className:"text-dark",children:"Titulo del Informe "})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control shadow-sm",placeholder:"Escribe el mensaje aquí",id:"mensaje",value:n,onChange:N=>i(N.target.value),style:{minHeight:"150px"}}),e.jsx("label",{className:"text-dark",children:"Contenido"})]})}),x&&e.jsx("div",{className:"alert alert-danger mt-5",children:x}),j?e.jsx(oe,{}):e.jsx("div",{className:"d-grid",children:e.jsx("button",{type:"submit",className:"btn bg-primary border-white border-3 text-white rounded-pill position-absolute top-100 start-50 shadow-sm translate-middle",children:e.jsxs("span",{children:["Crear Informe ",e.jsx("i",{className:"bi bi-code-slash p-1  text-white"})]})})})]})})})]})})})};function Wi({notificaciones:s,setNotificaciones:l,order:t,setOrder:n}){const i=o=>{n(o.target.value),r(o.target.value)},r=(o,d)=>{let g=[...s];o==="asc"?g.sort((x,m)=>{var j,u;return((j=x.timestamp)==null?void 0:j.seconds)-((u=m.timestamp)==null?void 0:u.seconds)}):g.sort((x,m)=>{var j,u;return((j=m.timestamp)==null?void 0:j.seconds)-((u=x.timestamp)==null?void 0:u.seconds)}),l(g)};return e.jsxs("div",{className:"d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-3 gap-2 text-white",children:[e.jsx("label",{className:"mx-4",children:"Orden"}),e.jsxs("select",{className:"form-select bg-light bg-opacity-25 text-dark text-center rounded-3 text-white",value:t,onChange:i,children:[e.jsx("option",{value:"desc",children:"Más recientes primero"}),e.jsx("option",{value:"asc",children:"Más antiguos primero"})]})]})}const Ji=()=>{const[s,l]=a.useState([]),[t,n]=a.useState(!0);return a.useEffect(()=>{const i=_e(W(D,"db_informes"),Be("timestamp","desc")),r=He(i,o=>{const d=o.docs.map(g=>({id:g.id,...g.data()}));l(d),n(!1)},o=>{console.error("Error al obtener informes:",o),n(!1)});return()=>r()},[]),{informes:s,loadingDb:t}},Yi=({showModalLink:s,setShowModalLink:l,selectedNotifId:t,newLink:n,setNewLink:i})=>{const[r,o]=a.useState(!0),[d,g]=a.useState(""),x=()=>{l(!1),i(""),o(!0),g("")},m=async()=>{if(!n){o(!1),g("Por favor, ingresa un enlace.");return}if(!t){o(!1),g("Por favor, selecciona un enlace.");return}try{await le(B(D,"db_informes",t),{enlace:Me(n)}),i(""),o(!0),g(""),alert("Enlace agregado correctamente."),x()}catch(j){console.error("Error al agregar el enlace:",j.code,j.message),alert("Hubo un error al agregar el enlace: "+j.message)}};return s&&e.jsx("div",{className:"modal fade show bg-dark",style:{display:"block"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!s,children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content text-white",children:[e.jsxs("div",{className:"modal-header bg-primary bg-opacity-75 ",children:[e.jsxs("h5",{className:"modal-title ",id:"modalLabel",children:["Agregar Enlace a la Notificación ",e.jsx("i",{className:"bi bi-share-fill mx-1"})]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white ",onClick:x,"aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"link",className:"form-label fw-semibold badge bg-primary ",children:"Ingrese el enlace"}),e.jsx("input",{type:"url",id:"link",className:`form-control text-center ${r?"":"is-invalid"}`,placeholder:"ejemplo.com",value:n,onChange:j=>i(j.target.value),"aria-describedby":"linkHelp"}),e.jsxs("div",{id:"linkHelp",className:"form-text text-center",children:["El enlace no incluyas  ",e.jsx("code",{children:" www. o  similares"})]}),!r&&e.jsx("div",{className:"invalid-feedback",children:d})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:x,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:m,children:"Guardar Enlace"})]})]})})})},Zi=({show:s,onClose:l,selectedNotifId:t})=>{const[n,i]=a.useState(null),[r,o]=a.useState(!1);a.useEffect(()=>{s&&(async()=>{if(t){o(!0);try{const x=B(D,"db_informes",t),m=await De(x);m.exists()&&i(m.data().chat||!1)}catch(x){console.error("Error al obtener el estado del chat:",x)}finally{o(!1)}}})()},[t,s]);const d=async()=>{if(t!=null){o(!0);try{await le(B(D,"db_informes",t),{chat:!n}),i(!n),l()}catch(g){console.error("Error al actualizar el estado del chat:",g),alert("Ocurrió un error al actualizar el chat.")}finally{o(!1)}}};return s?e.jsx(e.Fragment,{children:r?e.jsx(oe,{}):e.jsx("div",{className:"modal d-block bg-dark bg-opacity-75 ",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered  ",children:e.jsxs("div",{className:"modal-content shadow  ",children:[e.jsxs("div",{className:"modal-header bg-light text-dark border-0 border",children:[e.jsxs("h5",{className:"modal-title ",children:[e.jsx("i",{className:"bi bi-chat-dots-fill me-2"})," Estado del Chat"]}),e.jsx("button",{type:"button",className:"btn-close  ",onClick:l})]}),e.jsxs("div",{className:"modal-body text-center  bg-light text-dark",children:[e.jsxs("p",{className:"fw-semibold m-0 ",children:["Estado actual: "," ",e.jsx("span",{className:n?"badge bg-teal mx-3":"badge bg-danger mx-3",children:n?"Activo ":"Inactivo "})]}),e.jsxs("p",{children:["¿Deseás ",n?"desactivar":"activar"," el chat para esta notificación?"]})]}),e.jsxs("div",{className:"modal-footer d-flex justify-content-between  bg-light text-dark  border-0 border",children:[e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsxs("button",{className:`btn ${n?"btn-secondaryMuiRed text-light":"btn-blue"}`,onClick:d,disabled:r,children:[n?"Desactivar Chat":"Activar Chat",e.jsx("i",{className:`ms-2 bi ${n?"bi-x-circle":"bi-check-circle"}`})]})]})]})})})}):null},Qi=({showModal:s,closeModal:l,selectedNotifId:t,setSelectedNotifId:n,selectedPersona:i,setSelectedPersona:r,personas:o})=>{const[d,g]=a.useState(""),[x,m]=a.useState(!1),j=()=>{l(!1),n(null),r("")},u=async()=>{if(t&&i){m(!0);try{const c=_e(W(D,"db_personas"),Oe("nombre_apellido","==",i)),b=await re(c);if(b.empty)alert("No se encontró la persona seleccionada.");else{const h=b.docs[0];await Promise.all([le(B(D,"db_informes",t),{asociada:Me(i)}),le(B(D,"db_personas",h.id),{asociada_notificacion_id:Me(t)})]),alert(`La persona ${i} se asoció a la notificación.`),l()}}catch(c){console.error("Error al asociar captura:",c),alert("Hubo un error al asociar la captura.")}finally{m(!1)}}else alert("Por favor, selecciona una persona para asociar.")},p=c=>{switch(c){case 1:return"Normal";case 2:return"Paradero 🔎";case 3:return"Evasión 👮🏻";case 4:return"Prioritaria ⭐";default:return"No definida"}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:`modal fade bg-dark  ${s?"show":""}`,style:{display:s?"block":"none"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!s,children:e.jsx("div",{className:"modal-dialog text-white ",children:e.jsxs("div",{className:"modal-content ",children:[e.jsxs("div",{className:"modal-header bg-primary bg-opacity-75 ",children:[e.jsx("h5",{className:"modal-title ",id:"modalLabel",children:"Asociar Persona a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:j,"aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body ",children:[e.jsx("label",{htmlFor:"persona",className:"form-label mt-3 fw-semibold fw-semibold badge bg-primary ",children:"Selecciona una persona:"}),e.jsxs("div",{className:"d-flex mb-3",children:[e.jsx("input",{type:"text",className:"form-control dropdown-toggle w-100 bg-light bg-opacity-50 ",placeholder:"Buscar por nombre o DNI",value:d,onChange:c=>g(c.target.value)}),e.jsx("button",{className:"btn btn-secondaryMuiRed text-white ms-2",onClick:()=>g(""),disabled:!d,children:e.jsx("i",{className:"bi bi-trash"})})]}),d&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-start fw-bold",children:"Resultados:"}),e.jsx("ul",{className:"list-group",style:{maxHeight:"150px",overflowY:"auto"},children:o.filter(c=>`${c.nombre_apellido} ${c.documento}`.toLowerCase().includes(d.toLowerCase())).map(c=>{var b;return e.jsxs("li",{className:"list-group-item d-flex align-items-center",onClick:()=>{r(c.nombre_apellido),g("")},style:{cursor:"pointer"},children:[e.jsx("img",{src:((b=c.base64)==null?void 0:b.trim())||$e,alt:c.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{children:[e.jsxs("p",{className:"mb-0",children:[c.nombre_apellido," - ",c.documento]}),e.jsx("span",{className:`badge rounded-pill border border-white border-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[c.prioridad]||"bg-warning text-dark"}`,children:p(c.prioridad)})]})]},c.id)})})]}),e.jsxs("div",{className:"dropdown ",children:[e.jsx("button",{className:"btn btn-light dropdown-toggle w-100 bg-light bg-opacity-50 ",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",children:i||"Selecciona una persona"}),e.jsx("ul",{className:"dropdown-menu w-100","aria-labelledby":"dropdownMenuButton",style:{maxHeight:"300px",overflowY:"auto"},children:o.filter(c=>`${c.nombre_apellido} ${c.documento}`.toLowerCase().includes(d.toLowerCase())).map(c=>{var b;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center",onClick:()=>r(c.nombre_apellido),children:[e.jsx("img",{src:((b=c.base64)==null?void 0:b.trim())||$e,alt:c.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),c.nombre_apellido," - ",c.documento," -",e.jsx("span",{className:`badge rounded-pill border border-white border-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[c.prioridad]||"bg-warning text-dark"}`,children:p(c.prioridad)})]})},c.id)})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:u,disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Asociando..."]}):e.jsxs(e.Fragment,{children:["Asociar Captura ",e.jsx("i",{className:"bi bi-person-plus-fill mx-2"})]})}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:j,disabled:x,children:"Cerrar"})]})]})})})})},Xi=({showModalFotos:s,setShowModalFotos:l,selectedNotifId:t,newFoto:n,setNewFoto:i})=>{const[r,o]=a.useState(null),[d,g]=a.useState(!0),[x,m]=a.useState(""),[j,u]=a.useState(null),p=()=>{l(!1),o(null),u(null),g(!0),m(""),i(null)},c=async()=>{if(!n){g(!1),m("Debes seleccionar una imagen.");return}if(!t){g(!1),m("No se ha seleccionado una notificación válida.");return}try{await le(B(D,"db_informes",t),{imagenes:Me(n)}),i(n),alert("Imagen agregada correctamente."),p()}catch(h){console.error("Error al subir la imagen:",h.message),alert("Hubo un error al subir la imagen: "+h.message)}},b=h=>{const f=h.target.files[0];if(f){o(f);const v=new FileReader;v.onloadend=()=>{const N=new Image;N.onload=()=>{const S=document.createElement("canvas"),k=S.getContext("2d"),y=640,w=480;let C=N.width,E=N.height;C>E?C>y&&(E*=y/C,C=y):E>w&&(C*=w/E,E=w),S.width=C,S.height=E,k.drawImage(N,0,0,C,E);const F=S.toDataURL("image/jpeg",.8);i(F),u(F)},N.src=v.result},v.readAsDataURL(f)}else u(null),i(null)};return s&&e.jsx("div",{className:"modal fade show bg-dark",style:{display:"block"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!s,children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content  text-white",children:[e.jsxs("div",{className:"modal-header bg-primary bg-opacity-75",children:[e.jsxs("h5",{className:"modal-title",id:"modalLabel",children:["Agregar Imagen a la Notificación ",e.jsx("i",{className:"bi bi-image mx-1"})]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:p,"aria-label":"Close"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{htmlFor:"fileInput",className:"form-label fw-semibold badge bg-primary",children:"Selecciona una imagen"}),e.jsx("input",{type:"file",id:"fileInput",className:`form-control ${d?"":"is-invalid"}`,accept:".jpg, .jpeg",onChange:b}),!d&&e.jsx("div",{className:"invalid-feedback",children:x})]}),j&&e.jsx("div",{className:"mb-3 text-center",children:e.jsx("img",{src:j,alt:"Vista previa",className:"img-fluid rounded shadow",style:{maxHeight:"300px",objectFit:"contain"}})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:c,children:"Guardar Imagen"})]})]})})})};function Ki(){const[s,l]=a.useState([]),[t,n]=a.useState(!1),[i,r]=a.useState(!1),[o,d]=a.useState(!1),[g,x]=a.useState(null),[m,j]=a.useState(null),[u,p]=a.useState(null),[c,b]=a.useState(""),[h,f]=a.useState(""),[v,N]=a.useState([]),[S,k]=a.useState(!1),[y,w]=a.useState(null),[C,E]=a.useState(""),[F,_]=a.useState(""),[I,P]=a.useState("desc"),{informes:U,loadingDb:K}=Ji(),[G,A]=a.useState([]),[V,H]=a.useState([]),[Z,z]=a.useState(!1),R=$=>{$!=null&&$.asociada_notificacion_id&&Array.isArray($.asociada_notificacion_id)&&alert(`Esta persona está asociada a las siguientes notificaciones: ${$.asociada_notificacion_id.join(", ")}`)},J=$=>{H(ie=>ie.includes($)?ie.filter(q=>q!==$):[...ie,$])},ne=$=>V.includes($);a.useEffect(()=>{A(U)},[U]),a.useEffect(()=>{(async()=>{const ie=_e(W(D,"db_personas"),Be("nombre_apellido","asc")),de=(await re(ie)).docs.map(O=>({id:O.id,...O.data()}));l(de)})()},[]);const me=async($,ie)=>{try{if(!window.confirm("¿Desea eliminar este enlace?"))return;const de=B(D,"db_informes",ie),O=await De(de);if(O.exists()){const ce=O.data();if(Array.isArray(ce.enlace)){const be=ce.enlace.filter((Ae,Y)=>Y!==$);await le(de,{enlace:be}),alert("Enlace eliminado con exito ")}else alert("El campo 'enlace' no existe o no es un array.")}else alert("No se encontró el documento con el ID proporcionado.")}catch(q){alert.error("Error al eliminar el enlace:",q)}},he=async $=>{if(window.confirm("¿Estás seguro de que deseas eliminar esta notificación?")){k(!0);try{await je(B(D,"db_informes",$)),A(q=>q.filter(de=>de.id!==$)),alert("Se eliminó el informe")}catch(q){console.error("Error al eliminar el informe:",q),alert("Hubo un error al eliminar el informe.")}finally{k(!1)}}},ae=$=>{x($),n(!0)},T=$=>{x($),r(!0)},L=$=>{x($),d(!0)},Q=async($,ie,q)=>{if(window.confirm(`¿Estás seguro de que deseas eliminar la imagen número ${q+1}?`)){k(!0);try{const O=B(D,"db_informes",$);await le(O,{imagenes:Ie(ie)}),N(ce=>ce.filter(be=>be!==ie)),alert(`Se eliminó la imagen ${q+1} correctamente.`)}catch(O){console.error("Error al eliminar la imagen:",O),alert("Hubo un error al eliminar la imagen.")}finally{k(!1)}}else alert("La imagen no fue eliminada.")},X=async($,ie,q)=>{if(window.confirm(`¿Estás seguro de que deseas eliminar la asociación de la persona ${q} con la notificación?`)){k(!0);try{const O=B(D,"db_informes",$);await le(O,{asociada:Ie(q)});const ce=B(D,"db_personas",ie);await le(ce,{asociada_notificacion_id:Ie($)}),alert(`Se eliminó la asociación de la persona ${q} con la notificación.`)}catch(O){console.error("Error al eliminar la asociación:",O),alert("Hubo un error al eliminar la asociación.")}finally{k(!1)}}else alert(`La asociación de la persona ${q} no fue eliminada.`)},se=$=>{switch($){case"1":return"Activo";case"2":return"Paradero 🔎";case"3":return"Evasión 👮🏻";case"4":return"Prioritaria ⭐";default:return"No definida"}},M=$=>/^https?:\/\//.test($)?$:`https://${$}`,ee=async $=>{if(C.trim()){k(!0);try{const ie=B(D,"db_notificaciones",$);await le(ie,{contenido:C}),alert("Contenido actualizado correctamente"),j(null)}catch(ie){console.error("Error al actualizar contenido:",ie),alert("Hubo un error al actualizar el contenido.")}finally{k(!1)}}else alert("El contenido no puede estar vacío")},te=async $=>{if(F.trim()){k(!0);try{const ie=B(D,"db_informes",$);await le(ie,{titulo:F}),alert("titulo actualizado correctamente"),p(null)}catch(ie){console.error("Error al actualizar titulo:",ie),alert("Hubo un error al actualizar el titulo.")}finally{k(!1)}}else alert("El titulo no puede estar vacío")};return e.jsxs("div",{children:[e.jsx(Wi,{notificaciones:G,setNotificaciones:A,order:I,setOrder:P}),e.jsx("div",{className:"row g-3 justify-content-center align-items-center mt-1"}),e.jsx(e.Fragment,{children:K?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"300px"},children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("div",{className:"spinner-grow text-light spinner-grow-sm",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}),e.jsx("div",{className:"spinner-grow text-light spinner-grow-sm",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}),e.jsx("div",{className:"spinner-grow text-light spinner-grow-sm",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})})]})}):e.jsx("div",{className:"row justify-content-center  ",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"list-group",children:G.length===0?e.jsx("div",{className:"text-center p-4 text-center tex-light bg-light bg-opacity-25 rounded text-white",children:e.jsx("span",{className:"display-6",children:"No hay Informes 👎🏻"})}):G.map($=>{var ie,q,de;return e.jsxs("div",{className:"list-group-item shadow mt-5 bg-light bg-opacity-75 rounded-4",children:[e.jsxs("div",{className:"d-flex align-items-center shadow-sm text-center bg-dark bg-opacity-50 p-3 rounded-4 text-light position-relative",children:[e.jsx("button",{className:"btn bg-purple bg-opacity-75 px-5 border-white border-3 text-white rounded-pill position-absolute top-0 start-50 shadow-sm translate-middle d-none d-md-block",children:e.jsxs("span",{children:["       ",new Date(((ie=$.timestamp)==null?void 0:ie.seconds)*1e3).toLocaleString()," "]})}),e.jsx("span",{className:`badge rounded-pill me-3 ${{1:"bg-teal titilar",2:"bg-primaryMuiBlue",3:"bg-danger"}[$.caratula]||"bg-warning text-dark"}`,children:se($.caratula)}),((q=$.asociada)==null?void 0:q.length)>0&&e.jsx("span",{className:"text-light ms-2",title:"Personas asociadas",children:e.jsx("i",{className:"bi bi-person-check-fill"})}),((de=$.enlace)==null?void 0:de.length)>0&&e.jsx("span",{className:"text-light ms-2",title:"Enlaces adjuntos",children:e.jsx("i",{className:"bi bi-link-45deg"})}),$.chat&&e.jsx("span",{className:"text-light ms-2",title:"Chat activo",children:e.jsx("i",{className:"bi bi-chat-dots-fill"})}),Array.isArray($.imagenes)&&$.imagenes.length>0&&e.jsxs("span",{className:"text-light ms-2",title:"Fotos adjuntas",children:[e.jsx("i",{className:"bi bi-image-fill"})," "]}),e.jsx("div",{className:"flex-grow-1"}),e.jsx("button",{className:"btn btn-outline-light btn-sm rounded-circle ms-2",onClick:()=>J($.id),children:e.jsx("i",{className:`bi ${ne($.id)?"bi-chevron-up":"bi-chevron-down"}`})})]}),!ne($.id)&&e.jsx("h6",{className:"text-center  fw-bold my-3",children:$.titulo}),ne($.id)&&e.jsxs("div",{className:"p-3",children:[e.jsx("h6",{className:"shadow-sm text-center bg-light bg-opacity-75 p-2 rounded-4 text-dark",children:"Título"}),$.id===u?e.jsxs("div",{className:"text-center ",children:[e.jsx("input",{type:"text",value:F,onChange:O=>_(O.target.value),className:"form-control mt-3 text-center"}),e.jsx("button",{className:"btn btn-primary mt-4 ",onClick:()=>te($.id),disabled:S,children:S?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1 "})]})})]}):e.jsx("div",{className:"mt-3 text-center fw-semibold",children:e.jsx("small",{className:"mb-2 text-muted ",children:$.titulo})}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${$.id===u?"btn-danger":"btn-primary"}`,onClick:()=>{$.id===u?p(null):(_($.titulo),p($.id))},children:e.jsx("i",{className:`bi ${$.id===u?"bi-x-circle":"bi-pencil"}`})})}),e.jsx("h6",{className:"shadow-sm text-center bg-dark bg-opacity-50 p-2 rounded-4 text-light my-3",children:"Contenido"}),$.id===m?e.jsxs("div",{className:"text-center",children:[e.jsx("textarea",{value:C,onChange:O=>E(O.target.value),className:"form-control",rows:"5"}),e.jsx("button",{className:"btn btn-primary mt-4",onClick:()=>ee($.id),disabled:S,children:S?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1"})]})})]}):e.jsx("div",{className:"mt-3 text-center fw-semibold",children:e.jsx("small",{className:"mb-2 text-muted ",children:$.contenido})}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${$.id===m?"btn-danger":"btn-primary"}`,onClick:()=>{$.id===m?j(null):(E($.contenido),j($.id))},children:e.jsx("i",{className:`bi ${$.id===m?"bi-x-circle":"bi-pencil"}`})})}),$.enlace&&$.enlace.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-center bg-light bg-opacity-50 fw-semibold shadow-sm  py-1 rounded my-3 ",children:"Enlaces Asociados"}),e.jsx("ul",{className:"list-unstyled",children:$.enlace.map((O,ce)=>e.jsxs("li",{className:"d-flex align-items-center justify-content-center mb-2 p-2 shadow",children:[e.jsxs("span",{className:"badge bg-primary text-white d-flex align-items-center gap-2 px-2 py-2 ",style:{maxWidth:"250px"},children:[e.jsx("i",{className:"bi bi-browser-chrome"}),e.jsx("a",{href:M(O),target:"_blank",rel:"noopener noreferrer",className:"text-white text-decoration-none text-truncate mx-2",style:{maxWidth:"200px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:O})]}),e.jsx("button",{className:"btn btn-redUi1 btn-sm rounded-circle ms-2",onClick:()=>me(ce,$.id),children:e.jsx("i",{className:"bi bi-x-circle text-white"})})]},ce))})]}):e.jsx("span",{className:"bg-dark bg-opacity-25 p-3 rounded-3 text-light text-center d-block my-2",children:"No hay enlaces asociados"}),$.asociada&&$.asociada.length>0?e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{className:"text-center bg-light bg-opacity-50 fw-semibold shadow-sm py-1 rounded mt-3",children:"Personas Asociadas"}),$.asociada.map((O,ce)=>{var Ae,Y;const be=s.find(ue=>ue.nombre_apellido===O);return be?e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2 p-2 shadow ",children:[e.jsx("img",{src:((Ae=be.base64)==null?void 0:Ae.trim())||$e,alt:be.nombre_apellido||"Imagen no disponible",onClick:()=>{var ue;return w((ue=be.base64)==null?void 0:ue.trim())},className:"rounded-circle me-3",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1 text-center",children:[e.jsxs("span",{children:[ce+1,". ",O]}),((Y=be.asociada_notificacion_id)==null?void 0:Y.length)>0&&e.jsxs("span",{className:"badge bg-teal text-white ms-3",onClick:()=>R(be),children:["Asociado ",be.asociada_notificacion_id.length]})]}),e.jsx("button",{className:"btn btn-sm btn-redUi1 text-white ms-3",onClick:()=>X($.id,be.id,O),children:e.jsx("i",{className:"bi bi-trash"})})]},ce):null})]}):e.jsx("span",{className:"bg-dark bg-opacity-25 p-3 rounded-3 text-light text-center d-block",children:"No hay personas asociadas"}),$.imagenes&&$.imagenes.length>0?e.jsxs("div",{className:"mt-4",children:[e.jsx("h6",{className:"text-center bg-light bg-opacity-50 fw-semibold shadow-sm py-1 rounded",children:"Imágenes Asociadas"}),e.jsx("div",{className:"row mt-3",children:$.imagenes.map((O,ce)=>e.jsxs("div",{className:"col-6 col-md-4 mb-3 position-relative",children:[e.jsx("button",{className:"btn btn-sm bg-dark bg-opacity-50 text-white position-absolute top-0 end-0 m-1 rounded-circle",style:{zIndex:2},onClick:()=>Q($.id,O,ce),title:"Eliminar imagen",children:"×"}),e.jsx("img",{src:O,alt:`Imagen ${ce+1}`,className:"img-fluid rounded shadow-sm w-100",style:{height:"200px",objectFit:"cover",cursor:"pointer"},onClick:()=>w(O)})]},ce))})]}):e.jsx("span",{className:"bg-dark bg-opacity-25 p-3 rounded-3 text-light text-center d-block mt-4",children:"No hay imágenes asociadas"}),y&&e.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center",style:{backgroundColor:"rgba(0,0,0,0.85)",zIndex:1050,cursor:"zoom-out"},onClick:()=>w(null),onKeyDown:O=>{O.key==="Escape"&&w(null)},tabIndex:0,children:e.jsx("img",{src:y,alt:"Vista completa",className:"img-fluid rounded shadow",style:{maxHeight:"95%",maxWidth:"95%",cursor:"default"},onClick:O=>O.stopPropagation()})})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 p-3",children:[e.jsx("button",{className:"btn btn-cyan text-white btn-sm rounded-circle",onClick:()=>ae($.id),title:"Asociar personas",children:e.jsx("i",{className:"bi bi-person-fill-add"})}),e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle",onClick:()=>T($.id),title:"Agregar enlace",children:e.jsx("i",{className:"bi bi-link-45deg"})}),e.jsx("button",{className:"btn btn-orangeUi text-white btn-sm rounded-circle",onClick:()=>{x($.id),z(!0)},title:"Activar chat",children:e.jsx("i",{className:"bi bi-chat-dots-fill"})}),e.jsx("button",{className:"btn btn-purple text-white btn-sm rounded-circle",onClick:()=>L($.id),title:"Subir Fotos",children:e.jsx("i",{className:"bi bi-image"})}),e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:()=>he($.id),disabled:S,title:"Eliminar notificación",children:e.jsx("i",{className:"bi bi-trash3-fill"})})]})]},$.id)})})})})}),e.jsx(Yi,{showModalLink:i,setShowModalLink:r,selectedNotifId:g,newLink:h,setNewLink:f,setNotificaciones:A}),e.jsx(Xi,{showModalFotos:o,setShowModalFotos:d,selectedNotifId:g,newFoto:v,setNewFoto:N,setNotificaciones:A}),e.jsx(Zi,{show:Z,onClose:()=>z(!1),selectedNotifId:g}),e.jsx(Qi,{showModal:t,closeModal:n,selectedNotifId:g,setSelectedNotifId:x,selectedPersona:c,setSelectedPersona:b,personas:s})]})}const el=()=>{const[s,l]=a.useState(!1),[t,n]=a.useState(0),[i,r]=a.useState(0),o=()=>l(!0),d=()=>l(!1);return a.useEffect(()=>{(async()=>{const m=(await re(W(D,"db_informes"))).size;n(m);const u=(await re(W(D,"db_personas"))).size;r(u)})()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row g-4 align-items-start",children:[e.jsxs("div",{className:"col-12 col-md-6  text-white ",children:[e.jsxs("div",{className:"p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg my-4 text-center text-capitalize",children:[e.jsx("h1",{className:"fw-bold display-6 ",children:"Crear nueva Noticia "}),e.jsx("p",{className:"lead text-white text-center mt-4",children:"¿Querés registrar una nueva Noticia ? Comenzá completando los datos necesarios para dar inicio al proceso."}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{className:"btn btn-light fw-semibold px-4",onClick:o,children:"Nueva Noticia"})})]}),e.jsxs("div",{className:"p-4 bg-dark bg-opacity-25 rounded-4 shadow-lg",children:[e.jsx("p",{className:"fs-5 mt-3 text-center",children:"Tu herramienta ágil para controlar, organizar y comunicar información de forma simple y eficiente."}),e.jsxs("div",{className:"mt-3 text-center",children:[e.jsxs("p",{className:"text-light mb-1",children:["Total de Noticias registrados: ",e.jsx("strong",{children:t})]}),e.jsxs("p",{className:"text-light",children:["Total personas registradas : ",e.jsx("strong",{children:i})]})]})]}),e.jsx("div",{className:"mt-3 small d-flex flex-column align-items-end",children:e.jsxs("p",{className:"mb-0",children:["Soporte: ",e.jsx("a",{href:"mailto:ticsdesarrollo2024@gmail.com",className:"text-white text-decoration-underline",children:"ticsdesarrollo2024@gmail.com"})]})})]}),e.jsx("div",{className:" col-12 col-md-6  ",children:e.jsx(Ki,{})})]})}),e.jsx(Hi,{showModalNot:s,closeModalNot:d})]})},sl=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Crear Noticias"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsx("div",{className:"my-5 ",children:e.jsx(Fe,{Promp:"Crear Administar Noticias ",Promp2:"bi bi-code-slash fs-4 "})}),e.jsx(el,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},al=()=>e.jsx(e.Fragment,{children:e.jsx(sl,{})}),tl=({informeId:s})=>{const[l,t]=a.useState(null),[n,i]=a.useState(!1),[r,o]=a.useState(0);a.useEffect(()=>{const x=localStorage.getItem("user");if(x){const m=JSON.parse(x);t(m.email),d(m.email)}},[s]);const d=async x=>{var u,p;const m=B(D,"db_informes",s),j=await De(m);if(j.exists()){const c=j.data();o(((u=c.me_sirve)==null?void 0:u.length)||0),i((p=c.me_sirve)==null?void 0:p.includes(x))}},g=async()=>{if(!l)return;const x=B(D,"db_informes",s);await le(x,{me_sirve:n?Ie(l):Me(l)}),i(!n),o(m=>n?m-1:m+1)};return e.jsxs("div",{onClick:g,style:{cursor:"pointer"},className:`d-flex align-items-center gap-1 ${n?"text-muted fw-bold":"text-muted"}`,children:[e.jsx("i",{className:`bi ${n?"bi-hand-thumbs-up-fill":"bi-hand-thumbs-up"} mx-1`}),"Me sirve"]})},il=["😀","👍","❤️","🎉","😄","😁","😆","😅","😂","🤣","😊","😇","🙂","🙃","😉","😌","😍","🥰","😘","😗","😙","😚","😋","😜","🤪","😝","🤑","🤗","🤭","🤫","🤔","🤐","🤨","😐","😑","😶","🙄","😏","😣","😥","😮","😯","😪","😫","🥱","😴","😛","🤓","😎","🤩","🥳","😕","😟","🙁","☹️","😮‍💨","😤","😢","😭","😦","😧","😨","😩","🤯","😬","😰","😱","🥵","🥶","😳","😵","😡","😠","🤬","😷","🤒","🤕","🤢"],ll=({show:s,onClose:l,informeId:t,count:n,onUpdateCount:i})=>{const[r,o]=a.useState(""),[d,g]=a.useState(!1),x=a.useRef(null),[m,j]=a.useState(null);a.useEffect(()=>{const b=localStorage.getItem("user");if(b){const h=JSON.parse(b);j(h.email)}},[t]);const u=()=>{g(!1),l()},p=async()=>{if(!m)return;if(r.trim()===""){alert("No se puede enviar un comentario vacío");return}const b=B(D,"db_informes",t),h=await De(b);if(h.exists()){const v=h.data().comentarios||[],N={texto:r.trim(),autor:m,timestamp:new Date};await le(b,{comentarios:[...v,N]}),i&&typeof n=="number"&&i(n+1),alert("Comentario enviado"),o(""),g(!1),l()}},c=b=>{const h=x.current;if(!h)return;const f=h.selectionStart,v=h.selectionEnd,N=r.slice(0,f)+b+r.slice(v);o(N),setTimeout(()=>{h.selectionStart=h.selectionEnd=f+b.length,h.focus()},0)};return s?e.jsx("div",{className:"modal d-block",tabIndex:"-1",role:"dialog","aria-modal":"true",onClick:u,style:{backgroundColor:"rgba(0,0,0,0.9)"},children:e.jsx("div",{className:"modal-dialog text-dark",onClick:b=>b.stopPropagation(),children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Comentar"}),e.jsx("button",{type:"button",className:"btn-close",onClick:u})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("textarea",{ref:x,className:"form-control",rows:4,placeholder:"Escribe tu comentario...",value:r,onChange:b=>o(b.target.value)}),e.jsx("button",{type:"button",className:"btn btn-light mt-2",onClick:()=>g(b=>!b),children:d?"Ocultar emojis":"Mostrar emojis"}),d&&e.jsx("div",{className:"mt-2",style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #ddd",padding:"8px",borderRadius:"4px"},children:il.map(b=>e.jsx("button",{type:"button",className:"btn btn-light me-1 mb-1",onClick:()=>c(b),style:{fontSize:"1.4rem",lineHeight:"1"},children:b},b))})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:u,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",onClick:p,disabled:!r.trim(),children:"Enviar"})]})]})})}):null},rl=({comentarios:s=[],usuarioActual:l})=>{const[t,n]=a.useState(!1);return!s||s.length===0?e.jsx("div",{className:"mt-3 text-end",children:e.jsx("button",{className:"btn btn-sm btn-link p-0 text-decoration-none",disabled:!0,children:"Sin comentarios"})}):e.jsxs("div",{className:"my-3 text-end",children:[e.jsx("button",{className:"btn btn-sm btn-link p-0 text-decoration-none",onClick:()=>n(!t),children:t?"Ocultar comentarios":"Ver comentarios "}),t&&e.jsx("div",{className:"d-flex flex-column gap-2 mt-2",children:s.map((i,r)=>{var o,d;return e.jsxs("div",{className:"border rounded p-2 bg-light",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("strong",{className:"text-dark small text-capitalize",children:((o=i.autor)==null?void 0:o.split("@")[0])||"Anónimo"}),e.jsx("span",{className:"text-muted small r",children:new Date(((d=i.timestamp)==null?void 0:d.seconds)*1e3).toLocaleString()})]}),e.jsx("div",{className:"text-dark small mt-1 d-flex justify-content-between",children:i.texto}),i.autor===l&&e.jsx("div",{className:"text-end mt-1",children:e.jsx("span",{className:"badge bg-secondary small",children:"Tu comentario"})})]},r)})})]})},nl=({imagenes:s=[],onExpand:l})=>!s||s.length===0?null:s.length===1?e.jsx("div",{className:"text-center mb-3",children:e.jsx("img",{src:s[0],alt:"Imagen",className:"img-fluid rounded shadow-sm",style:{width:"50%",maxWidth:"500px",height:"300px",objectFit:"cover",cursor:"pointer"},onClick:()=>l(s[0])})}):e.jsxs("div",{id:"carouselPublicacion",className:"carousel slide mb-3","data-bs-ride":"carousel",children:[e.jsx("div",{className:"carousel-inner",style:{maxHeight:"300px"},children:s.map((t,n)=>e.jsx("div",{className:`carousel-item ${n===0?"active":""}`,style:{cursor:"pointer"},onClick:()=>l(t),children:e.jsx("img",{src:t,className:"d-block w-100 rounded",alt:`Imagen ${n+1}`,style:{height:"300px",objectFit:"cover",width:"100%",maxWidth:"500px",margin:"0 auto"}})},n))}),e.jsxs("button",{className:"carousel-control-prev ",type:"button","data-bs-target":"#carouselPublicacion","data-bs-slide":"prev",children:[e.jsx("span",{className:"carousel-control-prev-icon bg-dark rounded-circle bg-opacity-75","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden  ",children:"Anterior"})]}),e.jsxs("button",{className:"carousel-control-next",type:"button","data-bs-target":"#carouselPublicacion","data-bs-slide":"next",children:[e.jsx("span",{className:"carousel-control-next-icon bg-dark rounded-circle bg-opacity-75","aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:"Siguiente"})]})]}),ol=({perfilSeleccionado:s,onFiltrar:l})=>e.jsxs("div",{className:"mb-4  bg-light bg-opacity-25 p-4 rounded text-white",children:[e.jsx("label",{className:"form-label fw-bold",children:"Filtrar tipo de Información :"}),e.jsxs("select",{className:"form-select",value:s,onChange:t=>l(t.target.value),children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"personal",children:"👮‍♀️ Información del Personal"}),e.jsx("option",{value:"oficial",children:"📢 Información Oficial"})]})]}),cl=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState(null),[o,d]=a.useState(!1),[g,x]=a.useState(null),[m,j]=a.useState(""),[u,p]=a.useState(0),[c,b]=a.useState(""),h=S=>{x(S),d(!0)},f=s.filter(S=>{var k;return c===""?!0:((k=S.perfil)==null?void 0:k.toLowerCase())===c});a.useEffect(()=>{const S=localStorage.getItem("user");if(S){const k=JSON.parse(S);j(k.email)}},[]),a.useEffect(()=>{(async()=>{try{const y=(await re(W(D,"db_informes"))).docs.map(w=>{const C=w.data();return{id:w.id,...C,comentarios:C.comentarios||[]}}).sort((w,C)=>{var _,I;const E=((_=w.timestamp)==null?void 0:_.seconds)||0;return(((I=C.timestamp)==null?void 0:I.seconds)||0)-E});l(y)}catch(k){console.error("Error al obtener los informes:",k)}})()},[]);const v=(S=[])=>S.filter(k=>k.autor===m).length,N=S=>{p(S)};return a.useEffect(()=>{(async()=>{const y=(await re(W(D,"db_personas"))).docs.map(w=>w.data());n(y)})()},[]),a.useEffect(()=>{if(i){window.history.pushState({modalOpen:!0},"");const S=k=>{r(null)};return window.addEventListener("popstate",S),()=>{window.removeEventListener("popstate",S)}}},[i]),e.jsxs("div",{className:"container py-4",children:[e.jsx(ol,{perfilSeleccionado:c,onFiltrar:b}),f.map(S=>{var k,y,w,C,E,F,_,I;return e.jsxs("div",{className:"bg-white rounded-3 shadow p-3 mb-4 mx-auto",style:{maxWidth:"600px"},children:[e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"rounded-circle bg-primary text-white d-flex align-items-center justify-content-center me-3 shadow-sm",style:{width:"40px",height:"40px",fontWeight:"bold",fontSize:"1rem",textTransform:"uppercase"},children:((k=S.usuario_posteo)==null?void 0:k.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold small text-dark text-capitalize",children:((y=S.usuario_posteo)==null?void 0:y.split("@")[0])||"Usuario"}),e.jsxs("div",{className:"text-muted text-capitalize",style:{fontSize:"0.75rem"},children:[new Date(((w=S.timestamp)==null?void 0:w.seconds)*1e3).toLocaleString()," ·"," ",((C=S.difusion)==null?void 0:C.trim().toLowerCase())==="publico"?"🌍 Público ":((E=S.difusion)==null?void 0:E.trim().toLowerCase())==="privado"?"🔒 Privado ":S.difusion?"🔒 "+S.difusion:"🌍 Público ",S.perfil==="oficial"?"📢 Contenido oficial":"👮‍♀️ Personal Policial"]})]})]}),e.jsx("div",{className:"mb-2 text-dark",children:e.jsx("strong",{children:S.titulo})}),e.jsx("div",{className:"mb-2 text-dark ",children:S.contenido}),e.jsx("div",{className:"container ",children:e.jsx("div",{className:"row",children:e.jsx(nl,{imagenes:S.imagenes,onExpand:r})})}),Array.isArray(S.enlace)&&S.enlace.length>0&&e.jsx("div",{className:"mb-2 text-secondary border border-1 bg-opacity-25 rounded  p-2  ",children:e.jsxs("small",{children:["Enlaces Compartidos:",e.jsx("ul",{className:"mb-0 ps-3 ",children:S.enlace.filter(P=>typeof P=="string"&&P.trim()!=="").map((P,U)=>{const K=P.startsWith("http://")||P.startsWith("https://")?P:`https://${P}`;return e.jsx("li",{children:e.jsx("a",{href:K,target:"_blank",rel:"noopener noreferrer",children:P})},U)})})]})}),Array.isArray(S.asociada)&&S.asociada.length>0&&e.jsxs("div",{className:"mb-2",children:[e.jsx("small",{className:"text-dark d-block mb-1",children:"Personas asociadas:"}),e.jsx("div",{className:"d-flex flex-wrap gap-2 ",children:S.asociada.map((P,U)=>{const K=t.find(G=>{var A;return((A=G.nombre_apellido)==null?void 0:A.toLowerCase())===P.toLowerCase()});return K?e.jsxs("div",{className:"d-flex align-items-center gap-2 border rounded px-2 py-1",children:[e.jsx("div",{onClick:()=>r(K.base64),className:"rounded-circle",style:{width:"32px",height:"32px",backgroundImage:`url(${K.base64})`,backgroundSize:"cover",backgroundPosition:"center"}}),e.jsx("span",{className:"small text-dark ",children:K.nombre_apellido})]},U):null})})]}),e.jsx(rl,{comentarios:S.comentarios,usuarioActual:m}),e.jsxs("div",{className:"d-flex justify-content-between text-muted small mb-2",children:[e.jsx("div",{children:((F=S.me_sirve)==null?void 0:F.length)>0&&e.jsxs("div",{children:["👍 ",S.me_sirve.length]})}),e.jsxs("div",{children:[((_=S.comentarios)==null?void 0:_.length)||0," comentario",((I=S.comentarios)==null?void 0:I.length)===1?"":"s"," · 0 compartidos"]})]}),e.jsxs("div",{className:"d-flex justify-content-around border-top border-bottom py-2 text-muted",children:[e.jsx(tl,{informeId:S.id}),e.jsxs("div",{className:`d-flex align-items-center gap-1 ${S.chat?"":"text-muted"}`,style:{pointerEvents:S.chat?"auto":"none",opacity:S.chat?1:.6,cursor:S.chat?"pointer":"default"},onClick:()=>S.chat&&h(S.id),children:[e.jsx("i",{className:"bi bi-chat-dots mx-1"}),"Comentar ",v(S.comentarios)>0?`(${v(S.comentarios)})`:""]}),e.jsxs("div",{className:"d-flex align-items-center gap-1 text-muted",style:{pointerEvents:"none",opacity:.6},children:[e.jsx("i",{className:"bi bi-share mx-1"}),"Compartir"]})]})]},S.id)}),i&&e.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center",style:{backgroundColor:"rgba(0,0,0,0.85)",zIndex:1050,cursor:"zoom-out"},onClick:()=>r(null),onKeyDown:S=>{S.key==="Escape"&&r(null)},tabIndex:0,children:e.jsx("img",{src:i,alt:"Vista completa",className:"img-fluid rounded shadow",style:{maxHeight:"95%",maxWidth:"95%",cursor:"default"},onClick:S=>S.stopPropagation()})}),e.jsx(ll,{show:o,onClose:d,informeId:g,count:u,onUpdateCount:N})]})},dl=()=>{var j,u;const[s,l]=a.useState(null),t=((j=s==null?void 0:s.email)==null?void 0:j.split("@")[0])||"Usuario Sin Registro",[n,i]=a.useState(!1),[r,o]=a.useState(""),[d,g]=a.useState(!1);a.useEffect(()=>{const p=localStorage.getItem("user");if(p){const c=JSON.parse(p);l(c)}},[]);const x=async()=>{if(!r.trim())return alert("El contenido no puede estar vacío");try{i(!0),await Pe(W(D,"db_informes"),{email:(s==null?void 0:s.email)||"invitado",usuario_posteo:(s==null?void 0:s.email)||"invitado",contenido:r,timestamp:Re(),chat:!0,perfil:"personal",difusion:"publico"}),o(""),alert("Publicación fue creada correctamente")}catch(p){console.error("Error al publicar:",p),alert("Error al publicar. Intenta nuevamente.")}finally{i(!1)}},m=p=>{o(c=>c+p),g(!1)};return e.jsx(e.Fragment,{children:e.jsx("div",{className:" rounded-4 my-4 d-flex justify-content-center",children:e.jsxs("div",{className:"bg-light  rounded shadow p-3 w-100",style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:"rounded-circle bg-purple me-2 d-flex justify-content-center align-items-center text-white",style:{width:"40px",height:"40px",fontSize:"14px"},children:((u=s==null?void 0:s.email)==null?void 0:u.charAt(0).toUpperCase())||"?"}),e.jsx("div",{className:"fw-bold small text-dark",children:t||"Invitado"})]}),e.jsx("textarea",{className:"form-control border-0 text-center ",rows:"2",value:r,onChange:p=>o(p.target.value),placeholder:`¿ Qué quieres informar, ${t||"invitado"} ?`}),e.jsx("hr",{className:"my-3 bg-dark"}),e.jsxs("div",{className:"d-flex justify-content-between flex-wrap text-secondary small",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 px-2 py-1 rounded disabled",style:{cursor:"not-allowed",opacity:.5},children:[e.jsx("img",{src:"ico/camera.png",alt:"Foto/Video",width:"18",height:"18"}),"Foto/Video"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2 px-2 py-1 rounded",role:"button",onClick:()=>g(!d),children:[e.jsx("img",{src:"ico/happy--v1.png",alt:"Sentimiento",width:"18",height:"18"}),"Sentimiento"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2 px-2 py-1 rounded disabled",style:{cursor:"not-allowed",opacity:.5},children:[e.jsx("img",{src:"ico/location.png",alt:"Ubicación",width:"18",height:"18"}),"Ubicación"]})]}),d&&e.jsx("div",{className:"d-flex justify-content-center mt-2",children:e.jsxs("div",{className:"border rounded p-3 bg-light mt-3 text-center text-dark",style:{maxWidth:"500px",margin:"0 auto"},children:[e.jsx("h6",{className:"mb-3",children:"Selecciona un emoji"}),e.jsxs("div",{className:"mb-2 text-start",children:[e.jsx("strong",{children:" Más populares"}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-1",children:["😂","❤️","😍","😭","😊","🔥","😅","👍","🥰","🤔"].map(p=>e.jsx("span",{style:{fontSize:"20px",cursor:"pointer"},onClick:()=>m(p),children:p},p))})]}),e.jsxs("div",{className:"mb-2 text-start",children:[e.jsx("strong",{children:" Entidad "}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-1",children:["🕵️‍♂️","👮","👮‍♀️","👨‍⚖️","👨‍⚕️","👨‍🚒","🚒","🚑","🚓","🏍️"].map(p=>e.jsx("span",{style:{fontSize:"20px",cursor:"pointer"},onClick:()=>m(p),children:p},p))})]}),e.jsxs("div",{className:"mb-2 text-start",children:[e.jsx("strong",{children:"😀 Emociones"}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-1",children:["😀","😂","😅","😊","😍","🥰","😭","😡","🤯","🤔"].map(p=>e.jsx("span",{style:{fontSize:"20px",cursor:"pointer"},onClick:()=>m(p),children:p},p))})]}),e.jsxs("div",{className:"mb-2 text-start",children:[e.jsx("strong",{children:"❤️ Sentimientos"}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-1",children:["❤️","💔","💕","💖","💯","👏","🙏","🤝","🙌","💪"].map(p=>e.jsx("span",{style:{fontSize:"20px",cursor:"pointer"},onClick:()=>m(p),children:p},p))})]}),e.jsxs("div",{className:"mb-2 text-start",children:[e.jsx("strong",{children:"🥳 Celebración"}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-1",children:["🎉","🥳","🎂","🎁","🍰","🍻","🤩","😎","💃","🕺"].map(p=>e.jsx("span",{style:{fontSize:"20px",cursor:"pointer"},onClick:()=>m(p),children:p},p))})]}),e.jsxs("div",{className:"mb-2 text-start",children:[e.jsx("strong",{children:"✨ Útiles"}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-1",children:["⚠️","✅","❌","🔔","📢","📷","📍","📌","📝","📎"].map(p=>e.jsx("span",{style:{fontSize:"20px",cursor:"pointer"},onClick:()=>m(p),children:p},p))})]})]})}),e.jsx("button",{className:"btn btn-primary w-100 mt-3 fw-bold",onClick:x,disabled:n,children:n?"Publicando...":"Publicar"})]})})})},ml=()=>{const[s,l]=a.useState([]),[t,n]=a.useState(!0);return a.useEffect(()=>{(async()=>{try{const r=_e(W(D,"db_informes"),Be("timestamp","desc"),Ca(3)),d=(await re(r)).docs.map(g=>({id:g.id,...g.data()}));l(d)}catch(r){console.error("Error al obtener los informes:",r)}finally{n(!1)}})()},[]),t?e.jsx("div",{className:"d-flex justify-content-center align-items-center my-5",role:"status","aria-live":"polite",children:[...Array(3)].map((i,r)=>e.jsx("div",{className:"spinner-grow text-light mx-2",role:"status",style:{width:"2rem",height:"2rem"},"aria-label":"Cargando vehículos",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})},r))}):s.length===0?e.jsx("div",{className:"alert alert-info my-4 text-center",role:"alert",children:"No hay informes cargados aún."}):e.jsxs("div",{className:"container my-5",style:{maxWidth:"700px"},children:[e.jsx("h5",{className:"mb-3 text-center",children:"Últimas Publicaciones 🔥"}),e.jsx("div",{className:"row g-3",children:s.map(i=>{var r;return e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card shadow-sm shadowh-100",children:[e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{className:"card-title text-truncate text-capitalize",title:i.titulo,children:i.perfil==="oficial"?"📢 Contenido Oficial ":"👮‍♀️ Personal Policial "}),e.jsx("p",{className:"card-text text-truncate",title:i.contenido,children:i.contenido||"Sin descripción"})]}),e.jsxs("div",{className:"card-footer text-muted d-flex justify-content-between align-items-center small",children:[e.jsx("div",{children:i.usuario_posteo?i.usuario_posteo.split("@")[0]:"Usuario desconocido"}),e.jsx("div",{children:(r=i.timestamp)!=null&&r.seconds?new Date(i.timestamp.seconds*1e3).toLocaleString():"Fecha no disponible"})]})]})},i.id)})})]})},ul=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row g-4 align-items-start",children:[e.jsxs("div",{className:"col-12 col-md-6   text-white ",children:[e.jsxs("div",{className:"p-4 bg-dark bg-opacity-25 rounded-4 shadow-lg my-4 text-center text-capitalize",children:[e.jsx("h1",{className:"fw-bold display-6 ",children:"Bienvenido "}),e.jsx("p",{className:"mb-1",children:"Acá vas a recibir notificaciones importantes, publicaciones recientes y actualizaciones en tiempo real."})]}),e.jsx(dl,{}),e.jsx(ml,{}),e.jsx("div",{className:"mt-3 small d-flex flex-column align-items-end",children:e.jsxs("p",{className:"mb-0",children:["Soporte: ",e.jsx("a",{href:"mailto:ticsdesarrollo2024@gmail.com",className:"text-white text-decoration-underline",children:"ticsdesarrollo2024@gmail.com"})]})})]}),e.jsx("div",{className:" col-12 col-md-6  ",children:e.jsx(cl,{})})]})})}),hl=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Noticias - Cx2 "})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsx("div",{className:"my-5 ",children:e.jsx(Fe,{Promp:" Informes + Noticias ",Promp2:"bi bi-code-slash fs-4 "})}),e.jsx(ul,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},xl=()=>e.jsx(e.Fragment,{children:e.jsx(hl,{})}),bl=({onCiudadChange:s,onComisariaChange:l,clearSignal:t})=>{const[n,i]=a.useState(null),[r,o]=a.useState(null),d=[{ciudad:"Santa Fe",unidad:"UR I"},{ciudad:"Rosario",unidad:"UR II"},{ciudad:"Rafaela",unidad:"UR V"},{ciudad:"Venado Tuerto",unidad:"UR VIII"},{ciudad:"Reconquista",unidad:"UR IX"},{ciudad:"Villa Gobernador Gálvez",unidad:"UR II"},{ciudad:"San Lorenzo",unidad:"UR XVII"},{ciudad:"Esperanza",unidad:"UR XI"},{ciudad:"Casilda",unidad:"UR IV"},{ciudad:"Cañada de Gómez",unidad:"UR X"},{ciudad:"Sunchales",unidad:"UR V"},{ciudad:"Firmat",unidad:"UR VIII"},{ciudad:"Arroyo Seco",unidad:"UR II"},{ciudad:"Tostado",unidad:"UR XII"},{ciudad:"San Jorge",unidad:"UR XVIII"},{ciudad:"Gálvez",unidad:"UR XV"},{ciudad:"Coronda",unidad:"UR XV"},{ciudad:"Avellaneda",unidad:"UR IX"},{ciudad:"El Trébol",unidad:"UR XVIII"},{ciudad:"Las Parejas",unidad:"UR X"},{ciudad:"Funes",unidad:"UR II"},{ciudad:"Puerto General San Martín",unidad:"UR XVII"},{ciudad:"Ceres",unidad:"UR XIII"},{ciudad:"San Justo",unidad:"UR XVI"},{ciudad:"Laguna Paiva",unidad:"UR I"},{ciudad:"Granadero Baigorria",unidad:"UR II"},{ciudad:"Villa Ocampo",unidad:"UR IX"},{ciudad:"Helvecia",unidad:"UR I"},{ciudad:"San Cristóbal",unidad:"UR XIII"},{ciudad:"Carcarañá",unidad:"UR IV"},{ciudad:"Teodelina",unidad:"UR VIII"},{ciudad:"Humboldt",unidad:"UR XI"}],g={"Santa Fe":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barranquitas","Comisaría 3ra. - Sección Rivadavia","Comisaría 4ta. - Sección Las Flores","Comisaría 5ta. - Sección El Pozo","Comisaría 6ta. - Sección Fomento 9 de Julio"],Rosario:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Puerto Norte","Comisaría 3ra. - Sección Tucumán","Comisaría 4ta. - Sección Echesortu","Comisaría 5ta. - Sección Pichincha","Comisaría 6ta. - Sección Zona Sur","Comisaría 7ma. - Sección La Florida","Comisaría 8va. - Sección Zona Oeste"],Rafaela:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Belgrano","Comisaría 3ra. - Sección 9 de Julio","Comisaría 4ta. - Sección Barrio 2 de Abril","Comisaría 5ta. - Sección Barrio La Cañada"],"Venado Tuerto":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio Santa Fe","Comisaría 3ra. - Sección Malabrigo"],"San Lorenzo":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Zona Norte","Comisaría 3ra. - Sección Villa Felisa"],Firmat:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio Las Delicias"],Casilda:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio San Pedro","Comisaría 3ra. - Sección Barrio Granaderos"],"Cañada de Gómez":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio Sarmiento"],Reconquista:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio La Cortada","Comisaría 3ra. - Sección Barrio El Ombú"],Ceres:["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio San José"],"San Justo":["Comisaría 1ra. - Sección Centro","Comisaría 2da. - Sección Barrio El Paraíso","Comisaría 3ra. - Sección Barrio San Carlos"],Alcorta:["Comisaría 1ra. - Sección Centro"],Totoras:["Comisaría 1ra. - Sección Centro"],"Las Parejas":["Comisaría 1ra. - Sección Centro"]},x=j=>{const u=d.find(p=>p.ciudad===j.target.value);i(u),s(u)},m=j=>{const u=j.target.value;o(u),l(u)};return a.useEffect(()=>{i(""),o(null),s(null),l(null)},[t]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row ",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"¿Cuál es la Localidad?"}),e.jsxs("select",{className:"form-select text-center",onChange:x,defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Elige una ciudad..."}),d.map(j=>e.jsx("option",{value:j.ciudad,children:j.ciudad},j.ciudad))]})]})}),e.jsx("div",{className:"col-6",children:n&&e.jsx("div",{className:"mb-3",children:g[n.ciudad]?e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Comisarías disponibles:"}),e.jsxs("select",{className:"form-select text-center",value:r||"_none_",onChange:m,children:[e.jsx("option",{value:"_none_",disabled:!0,children:"Selecciona una comisaría..."}),g[n.ciudad].map((j,u)=>e.jsx("option",{value:j,children:j},u))]})]}):e.jsx("p",{className:"text-light titilar",children:"No hay comisarías cargadas para esta ciudad."})})})]})})},pl=({ciudadSeleccionada:s,comisariaSeleccionada:l,datosTiempo:t,sumario:n,pdfFile:i,relato:r,people:o})=>{if(!s||!l||!t)return e.jsx("div",{className:"alert alert-danger mt-3 text-center text-dark",children:"Por favor, selecciona la ciudad, comisaría y horario para generar el texto de denuncia."});const d=s.ciudad,g=s.unidad,x=l.split("-")[0].trim(),m=(o==null?void 0:o.filter(u=>u.caridad==="denunciante"))||[],j=m.length>0?m.map((u,p)=>{const c=`${u.nombreApellido} (DNI ${u.dni}, ${u.sexo})`;return m.length===1?c:p===m.length-1?`y ${c}`:c}).join(", ")+(m.length===1?" como denunciante ":" como denunciantes "):"la persona denunciante ";return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-light bg-opacity-50 rounded-4 shadow-lg p-4 mt-3",children:[e.jsx("h5",{className:"text-primary mb-3",children:"Denuncia Generada 👮"}),e.jsxs("p",{className:"text-dark fs-5",children:["Siendo aproximadamente las ",e.jsxs("strong",{children:[t," hs"]}),", se presenta ",j,"en la ",e.jsx("strong",{children:x})," de la ciudad de ",e.jsx("strong",{children:d}),", correspondiente a la ",e.jsx("strong",{children:g}),n&&e.jsxs(e.Fragment,{children:[" con número de sumario ",e.jsx("strong",{children:n})]}),", con el fin de radicar una denuncia por hechos que serán detallados a continuación."]}),r&&e.jsx("p",{className:"text-dark mt-2",children:r})]}),e.jsx("div",{className:"mt-4",children:i?e.jsxs("p",{className:"text-secondaryMuiRed fs-6 bg-light bg-opacity-50 rounded-4 shadow-lg p-2",children:["Se ha adjuntado un archivo PDF junto a la denuncia. ",e.jsx("i",{className:"bi bi-file-earmark-pdf ms-1"})]}):e.jsx("p",{className:"text-muted fs-6",children:"No se adjuntó archivo PDF junto a esta denuncia."})})]})},gl=({ciudadSeleccionada:s,comisariaSeleccionada:l,datosTiempo:t,sumario:n,pdfFile:i,relato:r,people:o})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"  text-dark text-center p-2 bg-light bg-opacity-50 rounded-4 shadow-lg  text-capitalize  ",children:[e.jsxs("p",{className:"mt-3",children:[e.jsxs("span",{children:[e.jsx("span",{className:"spinner-grow spinner-grow-sm me-2 text-primary"}),"👮 Iniciando Denuncia -"]}),e.jsxs("span",{className:" fw-semibold",children:[" ",s.ciudad," - "]}),e.jsxs("span",{children:[t," hs"]})]}),l&&e.jsxs("span",{className:"badge bg-primary me-3",children:[l.split("-")[0].trim()," ",e.jsxs("span",{className:"text-indigo border border-indigo border-2 bg-white rounded-pill px-2 py-1 ms-2",children:[s.unidad," "]})]}),n&&e.jsxs("span",{className:"badge bg-purpleUi me-3",children:["Sumario: ",n]}),i&&e.jsxs("span",{className:"rounded-circle p-2 bg-secondaryMuiRed  ",children:["  ",e.jsx("i",{className:" bi bi-filetype-pdf fs-5  text-light  ",children:" "})]}),r&&e.jsx("span",{className:"badge  bg-teal mt-2 d-inline-block",children:"Posee Relato"}),e.jsx("p",{})]}),o.length>0&&e.jsxs("div",{className:"mt-0",children:[e.jsxs("div",{className:"text-purple",children:[" ",e.jsx("i",{className:"bi bi-arrow-down fs-3"})]}),e.jsx("div",{className:"  text-dark text-center p-2 bg-light bg-opacity-50 rounded-4 shadow-lg  text-capitalize  ",children:o.map((d,g)=>e.jsxs("div",{children:[e.jsx("span",{children:"🧑🏻"}),e.jsx("small",{className:"me-2",children:d.dni}),"  ",e.jsx("small",{className:"me-2",children:d.nombreApellido}),e.jsxs("small",{className:"ms-2",children:[d.sexo==="femenino"&&e.jsx("i",{className:"bi bi-gender-female  text-pink"}),d.sexo==="masculino"&&e.jsx("i",{className:"bi bi-gender-male  text-blue"}),d.sexo==="otros"&&e.jsx("i",{className:"bi bi-gender-ambiguous  text-teal"})]})," ",e.jsx("small",{className:`badge ms-2 text-capitalize ${d.caridad==="denunciante"?"text-bg-dark bg-opacity-50  text-white ":d.caridad==="imputado"?"text-bg-pink":""}`,children:d.caridad}),e.jsx("button",{type:"button",className:"btn text-danger btn-sm ms-3",onClick:()=>handleRemovePerson(d),children:e.jsx("i",{className:"bi bi-trash3"})})]},g))})]})]}),jl=({show:s,handleClose:l,people:t,setPeople:n})=>{if(!s)return null;const[i,r]=a.useState({sexo:"otros",nombreApellido:"",dni:"",caridad:"denunciante"}),o=()=>{if(i){const d={sexo:i.sexo||"otros",nombreApellido:i.nombreApellido||"NN",dni:i.dni||"",caridad:i.caridad||"denunciante"};n([...t,d]),console.log("Nueva persona agregada:",d),r({sexo:"otros",nombreApellido:"",dni:"",caridad:"denunciante"}),l()}};return e.jsx("div",{className:"modal fade show bg-dark bg-opacity-75   ",style:{display:"block"},tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-gradiante2",children:[e.jsx("h5",{className:"modal-title",children:"Agregar Persona"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","aria-label":"Close",onClick:l})]}),e.jsxs("div",{className:"modal-body text-dark",children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-8",children:[e.jsx("label",{htmlFor:"nombreApellido",children:"Nombre y Apellido:"}),e.jsx("input",{id:"nombreApellido",type:"text",className:"form-control",value:i.nombreApellido,onChange:d=>r({...i,nombreApellido:d.target.value})})]}),e.jsxs("div",{className:"col-4 ",children:[e.jsx("label",{htmlFor:"sexo",children:"Sexo:"}),e.jsxs("select",{id:"sexo",className:"form-control",value:i.sexo,onChange:d=>r({...i,sexo:d.target.value}),children:[e.jsx("option",{disabled:!0,children:"Seleccione"}),e.jsx("option",{value:"masculino",children:"👨 Masculino"}),e.jsx("option",{value:"femenino",children:"👩 Femenino"}),e.jsx("option",{value:"otros",children:"🧑‍🤝‍🧑 Otros"})]})]})]}),e.jsxs("div",{className:"row mt-3",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"dni",children:"DNI:"}),e.jsx("input",{id:"dni",type:"text",className:"form-control",value:i.dni,onChange:d=>r({...i,dni:d.target.value})})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("label",{htmlFor:"caridad",children:"Caridad:"}),e.jsxs("select",{id:"caridad",className:"form-control",value:i.caridad,onChange:d=>r({...i,caridad:d.target.value}),children:[e.jsx("option",{value:"denunciante",children:"Denunciante"}),e.jsx("option",{value:"victima",children:"Victima"}),e.jsx("option",{value:"imputado",children:"Imputado"})]})]})]})]}),e.jsxs("div",{className:"modal-footer bg-light",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:l,children:"Cerrar"}),e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:o,children:[e.jsx("i",{className:"bi bi-person-fill-add  mx-1 "}),"     Agregar"]})]})]})})})},Os=[{categoria:"Delitos contra la persona",tipos:["Homicidio","Lesiones","Violencia de género","Abuso sexual","Secuestro"]},{categoria:"Delitos patrimoniales",tipos:["Robos","Hurtos","Estafas","Fraude"]},{categoria:"Delitos contra la administración pública",tipos:["Abuso de autoridad","Soborno","Corrupción"]},{categoria:"Delitos contra la propiedad intelectual",tipos:["Contrabando de mercancías","Violación de derechos de autor"]},{categoria:"Delitos ambientales",tipos:["Contaminación","Tráfico ilegal de especies"]},{categoria:"Delitos contra el orden público",tipos:["Disturbios","Desobediencia a la autoridad"]},{categoria:"Delitos contra la fe pública",tipos:["Falsificación de documentos","Falsificación de moneda"]},{categoria:"Delitos de índole federal",tipos:["Narcotráfico","Trata de personas","Lavado de activos"]},{categoria:"Acoso laboral",tipos:["Acoso moral","Acoso sexual","Discriminación"]},{categoria:"Faltas a la probidad administrativa",tipos:["Soborno","Conflicto de intereses","Uso indebido de fondos públicos"]},{categoria:"Violaciones de derechos humanos",tipos:["Violencia de género","Discriminación","Explotación"]},{categoria:"Violaciones de leyes especiales",tipos:["Delitos electorales","Delitos ambientales"]},{categoria:"Denuncias laborales",tipos:["No pago de salarios","Despido injustificado","Incumplimiento contractual"]},{categoria:"Denuncias relacionadas con la salud",tipos:["Atención médica negligente","Falsificación de medicamentos"]},{categoria:"Delitos rurales y abigeato",tipos:["Robo de ganado","Invasión de propiedad rural","Daños a instalaciones agropecuarias"]},{categoria:"Narcotráfico local",tipos:["Tenencia de estupefacientes","Narcomenudeo","Asociación ilícita vinculada"]},{categoria:"Violencia institucional/policial",tipos:["Apremios ilegales","Detenciones arbitrarias","Uso excesivo de la fuerza","Tortura o tratos inhumanos"]},{categoria:"Bandas criminales y mafias locales",tipos:["Extorsión","Balaceras","Intimidación pública","Amenazas"]},{categoria:"Corrupción local",tipos:["Enriquecimiento ilícito","Licitaciones irregulares","Nepotismo","Tráfico de influencias"]},{categoria:"Conflictos urbanos/barriales",tipos:["Usurpación de viviendas","Toma de terrenos","Violencia vecinal"]},{categoria:"Delitos contra menores",tipos:["Grooming","Abandono de persona","Trabajo infantil"]},{categoria:"Situaciones adicionales",tipos:["Conflicto de intereses","Problemas de salud pública"]}],fl=({show:s,handleClose:l,onAceptar:t})=>{var x;const[n,i]=a.useState(""),[r,o]=a.useState(""),d=((x=Os.find(m=>m.categoria===n))==null?void 0:x.tipos)||[],g=()=>{n&&r?(t(n,r),l()):alert("Debe seleccionar una categoría y un tipo.")};return s?e.jsx("div",{className:"modal fade show bg-dark ",style:{display:"block"},tabIndex:"-1","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-gradiante2",children:[e.jsx("h5",{className:"modal-title text-light",children:"Agregar Categoría del Hecho"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","aria-label":"Close",onClick:l})]}),e.jsxs("div",{className:"modal-body text-dark",children:[e.jsxs("div",{className:"mb-3 ",children:[e.jsx("label",{className:"form-label ",children:"Categoría"}),e.jsxs("select",{className:"form-select ",value:n,onChange:m=>{i(m.target.value),o("")},children:[e.jsx("option",{value:"",children:"Seleccionar categoría..."}),Os.map((m,j)=>e.jsx("option",{value:m.categoria,children:m.categoria},j))]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Tipo"}),e.jsxs("select",{className:"form-select",value:r,onChange:m=>o(m.target.value),disabled:!n,children:[e.jsx("option",{value:"",children:"Seleccionar tipo..."}),d.map((m,j)=>e.jsx("option",{value:m,children:m},j))]})]})]}),e.jsxs("div",{className:"modal-footer d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:g,children:"Aceptar"})]})]})})}):null},Nl=({show:s,handleClose:l,onAceptar:t})=>{const[n,i]=a.useState(""),r=d=>{i(d.target.value)},o=()=>{n.trim()?(t(n),l()):alert("Debe escribir un relato.")};return s?e.jsx("div",{className:"modal fade show bg-dark bg-opacity-75",style:{display:"block"},tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-gradiante2",children:[e.jsx("h5",{className:"modal-title text-light",children:"Agregar Relato de la Denuncia"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white","aria-label":"Close",onClick:l})]}),e.jsx("div",{className:"modal-body text-dark",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"form-floating text-dark",children:[e.jsx("textarea",{className:"form-control",placeholder:"Completa",id:"relatoDenuncia",value:n,onChange:r,style:{height:"150px"}}),e.jsx("label",{htmlFor:"relatoDenuncia",children:"Relato de la denuncia"})]})})}),e.jsxs("div",{className:"modal-footer d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:l,children:"Cancelar"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:o,children:"Aceptar"})]})]})})}):null},vl=()=>{const[s,l]=a.useState(!1),[t,n]=a.useState(!1),[i,r]=a.useState(null),[o,d]=a.useState(null),g=(m,j)=>{r({categoria:m,tipo:j}),l(!1)},x=m=>{const j=m;console.log("Relato recibido:",m),d(j),n(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-3",children:i&&e.jsx("div",{className:"card text-dark text-center p-2 bg-light bg-opacity-75 rounded-4 shadow-lg my-3",children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("span",{className:"card-title",children:"Categoría Seleccionada"}),e.jsxs("p",{className:"card-text fs-5",children:[e.jsx("span",{className:"fw-bold",children:i.categoria})," - ",i.tipo]})]})})}),e.jsx("div",{className:"mb-3",children:o&&e.jsx("div",{className:"card text-dark text-center p-2 bg-light bg-opacity-75 rounded-4 shadow-lg my-3",children:e.jsxs("div",{className:"card-body text-center",children:[e.jsx("span",{className:"card-title",children:"Realto del Hecho"}),e.jsxs("p",{className:"card-text fs-5",children:[e.jsx("span",{className:"fw-bold",children:o})," - ",o]})]})})}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3 flex-wrap text-white text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",title:"Agregar Categoría",onClick:()=>l(!0),children:e.jsx("i",{className:"bi bi-tags fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:"Categoria"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",title:"Agregar Lugar",children:e.jsx("i",{className:"bi bi-geo-alt-fill fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:"Lugar"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",title:"Agregar Relato",onClick:()=>n(!0),children:e.jsx("i",{className:"bi bi-chat-left-text fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:"Relato"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",title:"Herramienta  Asociar",children:e.jsx("i",{className:"bi bi-person-lines-fill fs-5"})}),e.jsx("div",{className:"mt-1 small text-white",children:"Asociar"})]})]}),e.jsx(fl,{show:s,handleClose:()=>l(!1),onAceptar:g}),e.jsx(Nl,{show:t,handleClose:()=>n(!1),onAceptar:x})]})},yl=()=>{const[s,l]=a.useState([]),t=()=>{l([...s,{categoria:"",tipo:"",lugar:""}])},n=i=>{const r=s.filter((o,d)=>d!==i);l(r)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"form-footer d-flex flex-row-reverse my-5 ",children:e.jsxs("button",{type:"button",className:"btn text-light text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg   ",onClick:t,children:[e.jsx("i",{className:"bi bi-puzzle mx-2"})," Agregar Hecho/s"]})}),e.jsx("div",{className:"container",children:s.map((i,r)=>e.jsxs("div",{className:"text-dark text-center p-4 bg-light bg-opacity-75 rounded-4 shadow-lg mb-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsx("div",{className:"flex-grow-1 text-start fw-bold ",children:e.jsxs("span",{className:"bg-light bg-opacity-75 p-2 rounded-4",children:[" Hecho N° ",r+1]})}),e.jsx("button",{type:"button",className:"btn-close ms-2",onClick:()=>n(r)})]}),e.jsx("div",{className:"mb-3",children:e.jsx(vl,{})})]},r))})]})},wl=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(null),[i,r]=a.useState(null),[o,d]=a.useState(null),[g,x]=a.useState(""),[m,j]=a.useState(null),[u,p]=a.useState(""),[c,b]=a.useState(!1),[h,f]=a.useState([]),[v,N]=a.useState(!1),S=()=>{N(!0)},k=()=>{N(!1)},y=E=>{if(!E)return"";const F=new Date(E),_=F.getHours().toString().padStart(2,"0"),I=F.getMinutes().toString().padStart(2,"0");return`${F.getDate()}/${F.getMonth()+1}/${F.getFullYear()} ${_}:${I}`},w=E=>{const F=E.target.files[0];j(F)},C=()=>{n(null),r(null),d(null),x(""),p(""),j(null),b(E=>!E),localStorage.removeItem("denuncia")};return e.jsx("div",{className:"container  d-flex justify-content-center align-items-center",children:e.jsxs("div",{className:"row w-100",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3 flex-wrap text-white text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("strong",{className:"d-flex align-items-center",children:[s?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-easel me-2"}),"Modo Gráfico"]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-file-text me-2"}),"Modo Texto"]})," ACTIVO"]}),e.jsxs("span",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-arrow-left-right me-2"}),"Cambiar a modo"]}),e.jsx("button",{type:"button",onClick:()=>l(!0),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${s?"active":""}`,title:"Vista en gráfico",children:e.jsx("i",{className:`bi bi-easel fs-5 ${s?"titilar":""}`})}),e.jsx("button",{type:"button",onClick:()=>l(!1),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${s?"":"active"}`,title:"Vista en texto",children:e.jsx("i",{className:`bi bi-card-text fs-5 ${s?"":"titilar"}`})}),e.jsx("button",{type:"button",onClick:()=>l(!s),className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",title:"Mostrar/Ocultar filtros",children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})})]}),e.jsx("div",{className:"text-dark text-center p-4 bg-light bg-opacity-75 rounded-4 shadow-lg mb-4",children:s?e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-3",children:[e.jsx("i",{className:"bi bi-easel me-2"}),"Modo Gráfico"]}),t?e.jsx(gl,{ciudadSeleccionada:t,comisariaSeleccionada:i,datosTiempo:y(o),sumario:g,pdfFile:m,relato:u,people:h}):e.jsxs("p",{className:"fs-6",children:["Listo para trabajar"," ",e.jsx("span",{className:"spinner-grow mx-2 text-light",style:{width:"1rem",height:"1rem"},role:"status"})]})]}):e.jsxs("div",{children:[e.jsxs("h4",{className:"mb-3",children:[e.jsx("i",{className:"bi bi-file-text me-2"}),"Modo Texto"]}),e.jsx(pl,{ciudadSeleccionada:t,comisariaSeleccionada:i,datosTiempo:y(o),sumario:g,pdfFile:m,relato:u,people:h})]})}),e.jsxs("div",{className:"mt-auto small text-light  ",children:[e.jsx("i",{className:"bi bi-info-circle me-1"}),"Ayuda rápida disponible"]})]}),e.jsxs("div",{className:"col-md-6 text-dark text-center p-4 bg-light bg-opacity-50 rounded-4 shadow-lg mb-4 text-capitalize ",children:[e.jsx("div",{className:"text-center p-4 bg-light bg-opacity-75 rounded-4 shadow-lg mb-4 ",children:e.jsxs("h5",{className:"mb-0",children:[" Comenzamos con la denuncia ",e.jsx("i",{className:"bi bi-flag ms-2 "})]})}),e.jsx("form",{children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-25 rounded-4 shadow-lg text-light ",children:[e.jsx(bl,{onCiudadChange:E=>{n(E),d(Date.now())},onComisariaChange:E=>r(E),clearSignal:c}),i&&e.jsxs("div",{className:"row mt-text-center",children:[e.jsxs("div",{className:"col-3 mb-3",children:[e.jsx("label",{htmlFor:"numeroSumario",className:"form-label",children:"N° de sumario"}),e.jsx("input",{type:"number",id:"numeroSumario",className:"form-control",placeholder:"Ej: 123/24",value:g,onChange:E=>x(E.target.value)})]}),i&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-9 mb-3",children:[e.jsx("label",{htmlFor:"pdfFile",className:"form-label",children:"¿Posee archivo PDF asociado?"}),e.jsx("input",{type:"file",id:"pdfFile",className:"form-control",accept:"application/pdf",onChange:w}),m&&e.jsx("div",{className:"mt-2",children:e.jsxs("span",{className:"text-yellow",children:["Archivo PDF cargado: ",m.name]})})]})})]})]})}),g&&e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3 flex-wrap text-white text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",onClick:()=>l(!0),title:"Agregar Vehiculo",children:e.jsx("i",{className:"bi bi-bicycle  fs-5 "})}),e.jsx("div",{className:"mt-1 small text-white",children:"Vehículo"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",onClick:S,title:"Agregar Personas",children:e.jsx("i",{className:"bi bi-person-fill-add  fs-5 "})}),e.jsx("div",{className:"mt-1 small text-white",children:"Personas"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",onClick:()=>l(!0),title:"Agregar Armas",children:e.jsx("i",{className:"bi bi-shield fs-5 "})}),e.jsx("div",{className:"mt-1 small text-white",children:"Armas"})]}),e.jsxs("div",{className:"text-center mx-2",children:[e.jsx("button",{className:"btn btn-outline-light rounded-circle shadow-sm border-2",type:"button",onClick:()=>l(!0),title:"Agregar elementos",children:e.jsx("i",{className:"bi bi-boxes fs-5 "})}),e.jsx("div",{className:"mt-1 small text-white",children:"Elementos"})]})]}),e.jsx(yl,{})]}),t&&e.jsx("div",{className:"form-footer d-flex flex-row-reverse mt-3 ",children:e.jsxs("button",{type:"button",className:"btn text-light text-center p-2 bg-dark bg-opacity-50 rounded-4 shadow-lg mb-4 text-capitalize  ",onClick:C,children:[e.jsx("i",{className:"bi bi-trash mx-2"})," Restablecer Campos"]})}),e.jsx(jl,{show:v,handleClose:k,people:h,setPeople:f})]})})},Cl=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),a.useEffect(()=>{const i=r=>{r.preventDefault(),r.returnValue="Estás a punto de dejar la página. ¿Quieres continuar?"};return window.addEventListener("beforeunload",i),()=>{window.removeEventListener("beforeunload",i)}},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Menu Inicio - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5",children:["  ",e.jsx(Fe,{Promp:"Denuncia Simple App ",Promp2:"bi bi-code-slash fs-4 "}),"   "]}),e.jsxs("div",{className:" d-flexjustify-content-center  text-white gap-5",children:[e.jsx(wl,{}),e.jsx(we,{})]})]}),e.jsx(da,{setThemeBackgroundColor:n})]})})};function Sl(){const[s,l]=a.useState({carta:null,fechaHora:"",tipo:"",marca:"",modelo:"",color:"",dominio:"",nroChasis:"",nroMotor:"",qth:"",ciudad:"",titular:"",telefono:"",observaciones:""}),[t,n]=a.useState({}),[i,r]=a.useState(!1),o=p=>{const{name:c,value:b}=p.target;l({...s,[c]:["carta","nroChasis","nroMotor"].includes(c)?b===""?null:Number(b):b})},g=(()=>{const p=localStorage.getItem("user");return p?JSON.parse(p):null})(),x=p=>/^[a-zA-ZáéíóúÁÉÍÓÚüÜ\s]*$/.test(p),m=p=>/^[0-9]*$/.test(p),j=()=>{const p=s.dominio.toUpperCase();if(!p)return!0;const c=/^\d{3}[A-Z]{3}$/,b=/^[A-Z]\d{2}\d[A-Z]{3}$/,h=/^[A-Z]{3}\d{3}$/,f=/^[A-Z]{2}\d{3}[A-Z]{2}$/;return s.tipo==="moto"||s.tipo==="cuatriciclo"?c.test(p)||b.test(p):h.test(p)||f.test(p)},u=async p=>{p.preventDefault(),r(!0);const c={};if(s.tipo||(c.tipo=!0),(!s.dominio||!j())&&(c.dominio=!0),x(s.marca)||(c.marca=!0),x(s.modelo)||(c.modelo=!0),x(s.ciudad)||(c.ciudad=!0),x(s.titular)||(c.titular=!0),m(s.nroChasis)||(c.nroChasis=!0),m(s.nroMotor)||(c.nroMotor=!0),m(s.carta)||(c.carta=!0),Object.keys(c).length>0){n(c),alert("Por favor, complete todos los campos requeridos correctamente ❌"),r(!1);return}try{await Pe(W(D,"db_vehiculos"),{...s,fechaHora:s.fechaHora?Ps.fromDate(new Date(s.fechaHora)):null,createdAt:Ps.now(),usuario:g?g.email:"Desconocido"}),alert(`Captura de Vehículo guardada, Gracias ${g?g.email:"Desconocido"} ✅`),l({fechaHora:"",tipo:"",marca:"",modelo:"",color:"",dominio:"",nroChasis:"",nroMotor:"",qth:"",ciudad:"",titular:"",telefono:"",observaciones:"",carta:null}),n({})}catch(b){console.error("Error guardando vehículo:",b),alert("Error al guardar vehículo ❌")}finally{r(!1)}};return e.jsx("div",{className:"container my-5",children:e.jsxs("div",{className:"card shadow border-0 rounded-3 bg-dark bg-opacity-50 text-white",children:[e.jsx("div",{className:"card-header bg-dark text-white bg-opacity-50 rounded-top-3 p-4",children:e.jsxs("h4",{className:"mb-0",children:[e.jsx("i",{className:"bi bi-car-front-fill me-2"})," Registro de Vehículo"]})}),e.jsx("div",{className:"col-12 mt-3",children:s.dominio&&e.jsx("div",{className:"d-flex justify-content-center",children:s.tipo==="moto"||s.tipo==="cuatriciclo"?(()=>{const p=s.dominio.toUpperCase(),c=/^\d{3}[A-Z]{3}$/,b=/^[A-Z]\d{2}\d[A-Z]{3}$/;if(c.test(p)){const h=p.slice(0,3),f=p.slice(3,6);return e.jsx("div",{className:"card text-center shadow-sm",style:{width:"150px",borderRadius:"0.5rem",backgroundColor:"black",color:"white"},children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("div",{style:{fontWeight:"bold",fontSize:"0.7rem",marginBottom:"0.2rem"},children:"ARGENTINA"}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:h}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:f})]})})}else if(b.test(p)){const h=p.slice(0,3),f=p.slice(3,7);return e.jsx("div",{className:"card text-center shadow-sm",style:{width:"150px",borderRadius:"0.5rem",backgroundColor:"#f5f5f5",color:"black"},children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("div",{className:"bg-primary text-white py-1 mb-2",style:{fontWeight:"bold",fontSize:"0.7rem",marginBottom:"0.2rem"},children:"ARGENTINA"}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:h}),e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:f})]})})}else return null})():e.jsx("div",{className:"card text-center shadow-sm",style:{width:"250px",borderRadius:"0.5rem",backgroundColor:"#f5f5f5"},children:e.jsxs("div",{className:"card-body p-2",children:[e.jsx("div",{className:"bg-primary text-white py-1 mb-2",style:{borderRadius:"0.5rem 0.5rem 0 0",fontWeight:"bold",fontSize:"0.9rem"},children:"ARGENTINA"}),e.jsx("h4",{className:"card-title m-0",style:{letterSpacing:"0.2rem",fontWeight:"bold"},children:s.dominio.toUpperCase()}),e.jsx("p",{className:"card-text m-0",style:{fontSize:"0.8rem",color:"#555"},children:s.ciudad||"Ciudad"})]})})})}),e.jsx("div",{className:"card-body p-4",children:e.jsxs("form",{onSubmit:u,className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Numero de Carta"}),e.jsx("input",{type:"number",className:`form-control ${s.carta&&!m(s.carta)?"is-invalid":""}`,name:"carta",value:s.carta,onChange:o,placeholder:"Número de carta "}),e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten números."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Fecha y Hora"}),e.jsx("input",{type:"datetime-local",className:"form-control",name:"fechaHora",value:s.fechaHora,onChange:o})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Tipo de Vehículo"}),e.jsxs("select",{className:`form-select ${t.tipo?"is-invalid":""}`,name:"tipo",value:s.tipo,onChange:o,children:[e.jsx("option",{value:"",children:"Seleccione un tipo..."}),e.jsx("option",{value:"auto",children:"🚗 Auto"}),e.jsx("option",{value:"moto",children:"🏍️ Moto"}),e.jsx("option",{value:"camioneta",children:"🚙 Camioneta"}),e.jsx("option",{value:"camion",children:"🚚 Camión"}),e.jsx("option",{value:"colectivo",children:"🚌 Colectivo"}),e.jsx("option",{value:"cuatriciclo",children:"🏍️ Cuatriciclo"}),e.jsx("option",{value:"tractor",children:"🚜 Tractor"}),e.jsx("option",{value:"ambulancia",children:"🚑 Ambulancia"}),e.jsx("option",{value:"policial",children:"🚓 Patrullero"}),e.jsx("option",{value:"bomberos",children:"🚒 Bomberos"}),e.jsx("option",{value:"otros",children:"Otros"})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Marca"}),e.jsx("input",{type:"text",className:`form-control text-uppercase ${s.marca&&!x(s.marca)?"is-invalid":""}`,name:"marca",value:s.marca,onChange:o}),e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten letras."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Modelo"}),e.jsx("input",{type:"text",className:`form-control text-uppercase ${s.modelo&&!x(s.modelo)?"is-invalid":""}`,name:"modelo",value:s.modelo,onChange:o}),e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten letras."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Color"}),e.jsxs("select",{className:"form-select",name:"color",value:s.color,onChange:o,children:[e.jsx("option",{value:"",children:"Seleccione un color..."}),e.jsx("option",{value:"blanco",children:"⚪ Blanco"}),e.jsx("option",{value:"negro",children:"⚫ Negro"}),e.jsx("option",{value:"gris",children:"⚪ Gris"}),e.jsx("option",{value:"plata",children:"⚪ Plata"}),e.jsx("option",{value:"rojo",children:"🔴 Rojo"}),e.jsx("option",{value:"bordo",children:"🔴 Bordó"}),e.jsx("option",{value:"azul",children:"🔵 Azul"}),e.jsx("option",{value:"verde",children:"🟢 Verde"}),e.jsx("option",{value:"amarillo",children:"🟡 Amarillo"}),e.jsx("option",{value:"dorado",children:"🟡 Dorado"}),e.jsx("option",{value:"naranja",children:"🟠 Naranja"}),e.jsx("option",{value:"violeta",children:"🟣 Violeta"}),e.jsx("option",{value:"marron",children:"🟤 Marrón"}),e.jsx("option",{value:"otros",children:"Otros"})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Dominio"}),e.jsx("input",{type:"text",className:`form-control text-uppercase ${s.dominio&&!j()||t.dominio?"is-invalid":""}`,name:"dominio",placeholder:"Ej: 111AAA o A11BCD",value:s.dominio,onChange:o}),e.jsx("div",{className:"invalid-feedback",children:t.dominio?"Dominio es obligatorio":"Formato inválido. Use "+(s.tipo==="moto"||s.tipo==="cuatriciclo"?"111AAA o A11BCD":"AAA123 o AB123CD")+"."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Nro. Chasis"}),e.jsx("input",{type:"text",className:`form-control ${s.nroChasis&&!m(s.nroChasis)?"is-invalid":""}`,name:"nroChasis",value:s.nroChasis,onChange:o}),e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten números."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Nro. Motor"}),e.jsx("input",{type:"text",className:`form-control ${s.nroMotor&&!m(s.nroMotor)?"is-invalid":""}`,name:"nroMotor",value:s.nroMotor,onChange:o}),e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten números."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"QTH Sustracción"}),e.jsx("input",{type:"text",className:"form-control",name:"qth",value:s.qth,onChange:o})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Ciudad"}),e.jsx("input",{type:"text",className:`form-control text-uppercase ${s.ciudad&&!x(s.ciudad)?"is-invalid":""}`,name:"ciudad",value:s.ciudad,onChange:o}),e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten letras."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Nombre y Apellido Titular"}),e.jsx("input",{type:"text",className:`form-control text-uppercase ${s.titular&&!x(s.titular)?"is-invalid":""}`,name:"titular",value:s.titular,onChange:o}),e.jsx("div",{className:"invalid-feedback",children:"Solo se permiten letras."})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Teléfono"}),e.jsx("input",{type:"tel",className:"form-control",name:"telefono",placeholder:"+54 9 341 ...",value:s.telefono,onChange:o})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Observaciones"}),e.jsx("textarea",{className:"form-control",name:"observaciones",rows:"3",value:s.observaciones,onChange:o})]}),e.jsx("div",{className:"col-12 text-end my-5",children:e.jsxs("button",{type:"submit",className:"btn btn-primary px-4",disabled:i,children:[i&&e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),e.jsx("i",{className:"bi bi-save me-2"})," Guardar Captura Vehículo"]})})]})})]})})}const kl=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Formulario Vehiculos - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsx("div",{className:"my-5 ",children:e.jsx(Fe,{Promp:"Nueva Captura ",Promp2:"bi bi-car-front-fill fs-4 "})}),e.jsx("div",{className:"my-5",children:e.jsx(Sl,{})})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},_l=()=>e.jsx(e.Fragment,{children:e.jsx(kl,{})});function El(){const[s,l]=a.useState([]),[t,n]=a.useState(""),[i,r]=a.useState(""),[o,d]=a.useState(!0),[g,x]=a.useState({});a.useEffect(()=>{(async()=>{d(!0);try{const f=(await re(W(D,"db_vehiculos"))).docs.map(v=>({id:v.id,...v.data()}));l(f)}catch(h){console.error("Error cargando vehículos:",h)}finally{d(!1)}})()},[]);const m=b=>b?(b.toDate?b.toDate():new Date(b)).toLocaleString():"",j=(b,h=!1)=>{if(!(b!=null&&b.dominio))return null;const f=b.dominio.toUpperCase(),v=h?{width:"100px",fontSize:"0.8rem"}:{width:"140px",fontSize:"1rem"},N=/^\d{3}[A-Z]{3}$/.test(f),S=/^[A-Z]\d{2}\d[A-Z]{3}$/.test(f),k=h?"card text-center shadow-sm bg-light":b.tipo==="moto"||b.tipo==="cuatriciclo"?"card text-center shadow-sm bg-dark text-white":"card text-center shadow-sm bg-light";if((b.tipo||"").toLowerCase()==="moto"||(b.tipo||"").toLowerCase()==="cuatriciclo"){if(N)return e.jsx("div",{className:k,style:{...v},children:e.jsxs("div",{className:"card-body bg-dark text-white p-1",children:[e.jsx("div",{style:{fontSize:h?"0.65rem":"0.8rem",fontWeight:"700"},children:"ARGENTINA"}),e.jsx("div",{style:{fontSize:h?"1rem":"1.2rem",fontWeight:"700"},children:f.slice(0,3)}),e.jsx("div",{style:{fontSize:h?"1rem":"1.2rem",fontWeight:"700"},children:f.slice(3,6)})]})});if(S)return e.jsx("div",{className:k,style:{...v},children:e.jsxs("div",{className:"card-body p-1",children:[e.jsx("div",{className:"bg-primary text-white py-1 mb-1",style:{fontSize:h?"0.65rem":"0.8rem",fontWeight:700},children:"ARGENTINA"}),e.jsx("div",{style:{fontSize:h?"1rem":"1.2rem",fontWeight:700},children:f.slice(0,3)}),e.jsx("div",{style:{fontSize:h?"1rem":"1.2rem",fontWeight:700},children:f.slice(3)})]})})}return e.jsx("div",{className:"card text-center shadow-sm bg-light",style:{...v},children:e.jsxs("div",{className:"card-body p-1",children:[e.jsx("div",{className:"bg-primary text-white py-1 mb-1",style:{fontWeight:700,fontSize:h?"0.65rem":"0.8rem"},children:"ARGENTINA"}),e.jsx("div",{style:{fontSize:h?"0.95rem":"1.15rem",fontWeight:700},children:f})]})})},u=b=>{switch((b||"").toLowerCase()){case"auto":return"bi-car-front-fill";case"moto":return"bi-bicycle";case"cuatriciclo":return"bi-bicycle";case"camioneta":return"bi-truck";case"camion":return"bi-truck";case"colectivo":return"bi-bus-front-fill";case"bicicleta":return"bi-bicycle";case"tractor":return"bi-gear-fill";case"ambulancia":return"bi-truck";case"policial":return"bi-shield-lock-fill";case"bomberos":return"bi-fire";default:return"bi-car-front-fill"}},p=Array.from(new Set(s.map(b=>b.tipo).filter(Boolean))),c=s.filter(b=>t?b.tipo===t:!0).filter(b=>{var h;return i?(h=b.dominio)==null?void 0:h.toUpperCase().includes(i.toUpperCase()):!0});return o?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx("i",{className:"bi bi-gear-fill text-white girar display-1"})}):e.jsxs("div",{className:"container my-5",children:[e.jsx("h3",{className:"text-white mb-4 d-flex justify-content-center d-lg-none bg-dark p-3 bg-opacity-25 rounded-pill m-2",children:"Listado de Vehículos"}),e.jsx("div",{className:"mb-4 p-4 bg-light bg-opacity-50 rounded-4 shadow-sm",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsxs("div",{className:"col-12 col-md-6 d-flex flex-column",children:[e.jsx("label",{className:"form-label text-white",children:"Filtrar Tipo"}),e.jsxs("select",{className:"form-select bg-light bg-opacity-75 text-dark text-center rounded-3 text-capitalize",value:t,onChange:b=>n(b.target.value),children:[e.jsx("option",{value:"",children:"Todos los tipos"}),p.map(b=>e.jsx("option",{value:b,children:b},b))]})]}),e.jsxs("div",{className:"col-12 col-md-6 d-flex flex-column",children:[e.jsx("label",{className:"form-label text-white",children:"Buscar Dominio"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",className:"form-control bg-light bg-opacity-75 text-dark text-center",placeholder:"🔍 Buscar por dominio...",value:i,onChange:b=>r(b.target.value)}),i&&e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle m-2",onClick:()=>r(""),title:"Eliminar búsqueda",children:e.jsx("i",{className:"bi bi-trash3-fill"})})]})]})]})}),e.jsx("div",{className:"list-group",children:c.map(b=>{var N,S,k,y,w;const h=!!g[b.id],f=()=>x(C=>({...C,[b.id]:!C[b.id]})),v=C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),f())};return e.jsxs("div",{className:"card shadow-lg border-0 my-4 bg-dark bg-opacity-75 text-white rounded-4 overflow-hidden",children:[e.jsxs("div",{className:"card-header d-flex align-items-center gap-3 px-3 py-3",role:"button",tabIndex:0,"aria-expanded":h,onClick:f,onKeyDown:v,style:{cursor:"pointer",background:"linear-gradient(90deg, rgba(255,255,255,0.03), rgba(0,0,0,0.03))"},children:[e.jsx("div",{className:"d-flex align-items-center",style:{minWidth:110},children:j(b,!0)}),e.jsxs("div",{className:"d-flex flex-column flex-grow-1",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("h5",{className:"mb-0 fw-bold text-truncate d-none d-md-block",style:{maxWidth:"min(65vw, 600px)"},children:[e.jsx("span",{className:"text-white",children:((N=b.marca)==null?void 0:N.toUpperCase())||"—"})," ",e.jsx("span",{className:"text-white-50",children:((S=b.modelo)==null?void 0:S.toUpperCase())||""})]}),e.jsxs("div",{className:"small text-white-50 mt-1 d-block d-md-none",style:{maxWidth:"min(65vw, 600px)"},children:[e.jsx("span",{className:"fw-bold",children:((k=b.marca)==null?void 0:k.toUpperCase())||"—"})," ",e.jsx("span",{children:((y=b.modelo)==null?void 0:y.toUpperCase())||""})]}),b.tipo&&e.jsxs("span",{className:"badge bg-light text-dark text-capitalize d-flex align-items-center px-2 py-1",children:[e.jsx("i",{className:`bi ${u(b.tipo)} fs-6 me-1`}),e.jsx("span",{className:"small",children:b.tipo})]})]}),e.jsx("div",{className:"small text-white-50 mt-1",children:((w=b.dominio)==null?void 0:w.toUpperCase())||""})]}),e.jsx("div",{className:"ms-3 d-none d-md-block",children:e.jsx("i",{className:`bi ${h?"bi-dash-circle-fill text-light":"bi-plus-circle-fill text-light titilar"} fs-4`,"aria-hidden":"true"})})]}),e.jsxs("div",{className:`collapse ${h?"show":""}`,children:[e.jsxs("div",{className:"card-body text-light",children:[e.jsxs("div",{className:"row g-3 text-capitalize",children:[e.jsxs("div",{className:"col-12 col-md-6  text-center",children:[b.color&&e.jsxs("p",{className:"mb-2",children:[e.jsx("i",{className:"bi bi-palette2 me-2"})," ",e.jsx("strong",{children:"Color:"})," ",b.color]}),b.nroChasis&&e.jsxs("p",{className:"mb-2",children:[e.jsx("i",{className:"bi bi-hammer me-2"})," ",e.jsx("strong",{children:"Chasis:"})," ",b.nroChasis]}),b.nroMotor&&e.jsxs("p",{className:"mb-2",children:[e.jsx("i",{className:"bi bi-cpu me-2"})," ",e.jsx("strong",{children:"Motor:"})," ",b.nroMotor]})]}),e.jsxs("div",{className:"col-12 col-md-6 text-center",children:[b.ciudad&&e.jsxs("p",{className:"mb-2",children:[e.jsx("i",{className:"bi bi-geo-alt me-2"})," ",e.jsx("strong",{children:"Ciudad:"})," ",b.ciudad]}),b.titular&&e.jsxs("p",{className:"mb-2",children:[e.jsx("i",{className:"bi bi-person-badge me-2"})," ",e.jsx("strong",{children:"Titular:"})," ",b.titular]}),b.telefono&&e.jsxs("p",{className:"mb-2",children:[e.jsx("i",{className:"bi bi-telephone-forward me-2"})," ",e.jsx("strong",{children:"Teléfono:"})," ",b.telefono]})]})]}),b.qth&&e.jsxs("div",{className:"alert bg-white bg-opacity-75 mt-3 mb-0 text-center text-dark",children:[e.jsx("i",{className:"bi bi-exclamation-triangle me-2"})," ",e.jsx("strong",{children:"Sustracción QTH:"})," ",b.qth]}),b.observaciones&&e.jsxs("div",{className:"alert bg-white bg-opacity-50 mt-3 mb-0 text-center",children:[e.jsx("i",{className:"bi bi-journal-text me-2"})," ",e.jsx("strong",{children:"Observaciones:"})," ",b.observaciones]})]}),e.jsxs("div",{className:"card-footer bg-dark bg-opacity-50 text-center text-white small",children:[e.jsx("i",{className:"bi bi-person-circle me-1"})," Registrado por:"," ",e.jsx("span",{className:"fw-semibold",children:"911"})," |"," ",e.jsx("i",{className:"bi bi-calendar-date me-1"})," ",m(b.fechaHora)]})]})]},b.id)})})]})}const Fl=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Captura  Vehiculos - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsx("div",{className:"my-5 my-5 animate__animated animate__lightSpeedInRight ",children:e.jsx(Fe,{Promp:"Capturas de Vehiculos ",Promp2:"bi bi-car-front-fill fs-4 "})}),e.jsx("div",{className:"my-5",children:e.jsx(El,{})})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},Dl=()=>e.jsx(e.Fragment,{children:e.jsx(Fl,{})}),Us=({onImageSave:s})=>{const[l,t]=a.useState(!1),[n,i]=a.useState(null),[r,o]=a.useState(""),d=a.useRef(null),[g,x]=a.useState(!1),[m,j]=a.useState({x:0,y:0}),[u,p]=a.useState({x:0,y:0}),[c,b]=a.useState(1),h=a.useRef(null),f=C=>{x(!0);const{offsetX:E,offsetY:F}=C.nativeEvent;p({x:E,y:F})},v=C=>{if(!g||!n)return;const{offsetX:E,offsetY:F}=C.nativeEvent;j(_=>({x:_.x+(E-u.x),y:_.y+(F-u.y)})),p({x:E,y:F})},N=()=>{x(!1)},S=()=>{t(!1),o(""),i(null),j({x:0,y:0}),b(1);const C=document.getElementById("file-input");C&&(C.value=""),h.current&&(URL.revokeObjectURL(h.current),h.current=null)},k=()=>t(!0),y=C=>{const E=C.target.files[0];if(E){if(!E.type.startsWith("image/")){o("Por favor, selecciona un archivo de imagen.");return}if(E.size>5*1024*1024){o("La imagen debe ser menor de 5 MB.");return}const F=URL.createObjectURL(E);h.current=F,i(F),o("")}},w=()=>{if(!n||!d.current){o("Por favor, selecciona una imagen antes de guardar.");return}const C=d.current,E=C.width,F=C.height,_=document.createElement("canvas");_.width=E,_.height=F;const I=_.getContext("2d"),P=new Image;P.src=n,P.onload=()=>{I.clearRect(0,0,E,F),I.drawImage(P,m.x,m.y,P.width*c,P.height*c);const U=_.toDataURL("image/jpeg",.92);s(U),S()}};return a.useEffect(()=>{if(n&&d.current){const C=d.current,E=C.getContext("2d"),F=new Image;F.src=n,F.onload=()=>{E.clearRect(0,0,C.width,C.height),E.drawImage(F,m.x,m.y,F.width*c,F.height*c)}}},[n,m,c]),a.useEffect(()=>{const C=d.current,E=F=>{if(F.preventDefault(),!n)return;const _=1.1,I=F.deltaY<0?c*_:c/_;b(Math.max(I,.1))};if(C)return C.addEventListener("wheel",E,{passive:!1}),()=>{C.removeEventListener("wheel",E)}},[n,c]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3",children:e.jsx("button",{type:"button",onClick:k,className:"btn  text-light  ",title:"Crear nuevo",children:e.jsx("i",{className:"bi bi-plus-circle-fill display-1  "})})}),e.jsx("div",{className:`modal fade  bg-dark ${l?"show":""}`,style:{display:l?"block":"none"},tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!l,children:e.jsx("div",{className:"modal-dialog modal-lg",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"modal-header bg-gradiante2",children:e.jsx("h5",{className:"modal-title text-light  ",id:"modalLabel ",children:"Selecciona tu imagen  / Edita "})}),e.jsxs("div",{className:"modal-body",children:[e.jsx("input",{id:"file-input",type:"file",className:"form-control",accept:"image/*",onChange:y}),n&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("canvas",{ref:d,className:"shadow",onMouseDown:f,onMouseMove:v,onMouseUp:N,onMouseLeave:N,width:500,height:500,style:{border:"1px solid black",cursor:g?"grabbing":"grab"}})}),e.jsxs("p",{className:"alert alert-light text-redUi1 fs-6 text-center mt-4 d-flex justify-content-center align-items-center gap-2",children:[e.jsx("span",{className:"spinner-grow text-pink",style:{width:"1rem",height:"1rem"},role:"status"}),"Para hacer zoom en la imagen, simplemente usa el scroll (la rueda) de tu mouse. 🖲️"]}),e.jsxs("p",{className:"alert alert-light text-indigoMui fs-6 text-center mt-4 d-flex justify-content-center align-items-center gap-2",children:[e.jsx("span",{className:"spinner-grow text-indigoMui",style:{width:"1rem",height:"1rem"},role:"status"}),"Mantén presionado el botón del mouse para arrastrar la imagen. 🖱️"]})]}),r&&e.jsx("div",{className:"mt-2 text-danger",children:r})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:S,children:"Cerrar"}),e.jsx("button",{type:"button",className:"btn text-white bg-indigoMui",onClick:w,children:"Guardar Imagen"})]})]})})}),e.jsx("div",{className:`modal-backdrop fade ${l?"show":""}`,style:{display:l?"block":"none"}})]})},Al=({onSubmit:s,savedImage:l,resetImage:t,formRef:n})=>{const[i,r]=a.useState(()=>{const c=localStorage.getItem("formData");return c?JSON.parse(c):{nombreApellido:"",documento:"",sexo:"",entidad:"",numeroContacto:"911",descripcionFisica:"",motivoCaptura:"",imagen:"",alerta:!1,paradero:!1,captura:!1,prioridad:5,alertaParaderoCaptura:"",montoRecompensa:null}}),[o,d]=a.useState({}),[g,x]=a.useState(!1);a.useEffect(()=>{localStorage.setItem("formData",JSON.stringify(i))},[i]);const m=({target:{id:c,value:b,type:h,checked:f}})=>{r(v=>{let N={...v,[c]:h==="checkbox"?f:b};if(c==="alertaParaderoCaptura")switch(b){case"paradero":N={...N,prioridad:2,paradero:!0,alerta:!1};break;case"evadido":N={...N,prioridad:3,captura:!0,alerta:!0};break;case"prioritaria":N={...N,prioridad:4,alerta:!1};break;default:N={...N,prioridad:1,paradero:!1,alerta:!1};break}return N}),d(v=>({...v,[c]:""}))},j=()=>{const c={};return l?(i.nombreApellido.match(/[A-Za-zÑñÁáÉéÍíÓóÚú\s]+/)||(c.nombreApellido="Ingrese solo letras y espacios."),i.documento&&i.documento.length<6&&(c.documento="El número de documento debe tener al menos 6 caracteres."),(!i.montoRecompensa||i.montoRecompensa.length<7)&&(c.montoRecompensa="El monto de recompensa debe tener al menos 7 dígitos."),d(c),Object.keys(c).length===0):(alert("Debes cargar una imagen antes de enviar el formulario."),!1)},u=async c=>{if(c.preventDefault(),!j())return;if(!window.confirm("¿Estás seguro de que deseas enviar este formulario?")){alert("El envío ha sido cancelado.");return}x(!0);try{const h={...i,imagen:l};if(typeof s=="function")await s(h),alert("Formulario enviado correctamente.");else throw new Error("onSubmit no es una función válida")}catch(h){console.error(h),alert("Hubo un error al enviar el formulario.")}finally{x(!1),p()}},p=()=>{localStorage.removeItem("formData"),r({nombreApellido:"",documento:"",sexo:"",entidad:"",numeroContacto:"911",descripcionFisica:"",motivoCaptura:"",imagen:"",alerta:!1,paradero:!1,prioridad:5,alertaParaderoCaptura:"",montoRecompensa:0}),d({}),t()};return e.jsxs("div",{className:" mt-3",children:[g&&e.jsx(oe,{})," ",e.jsxs("form",{ref:n,onSubmit:u,children:[e.jsx(Qe,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-person-fill text-greenUi me-3 p-1"})," Nombre y Apellido"]}),id:"nombreApellido",type:"text",value:i.nombreApellido,error:o.nombreApellido,onChange:m,required:!0,className:"text-center"}),e.jsxs("div",{className:"row  text-center",children:[e.jsx(Qe,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-building text-greenUi me-3 p-1"})," Entidad Solicita Captura"]}),id:"entidad",type:"text",value:i.entidad,onChange:m,className:"col"}),e.jsx(Qe,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-telephone text-greenUi me-3 p-1"})," Número de Contacto"]}),id:"numeroContacto",type:"tel",value:i.numeroContacto,error:o.numeroContacto,onChange:m,className:"col"})]}),e.jsx(qs,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-pencil text-greenUi me-3 p-1"})," Info Adicional"]}),id:"descripcionFisica",value:i.descripcionFisica,onChange:m,className:"text-center"}),e.jsx(qs,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-pencil-square text-greenUi me-3 p-1"})," ","Motivo Captura"," "]}),id:"motivoCaptura",value:i.motivoCaptura,onChange:m,className:"text-center"}),e.jsx(Ml,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill p-1 text-white me-3 titilar "})," ","Selecciona una Tipo de Alerta"]}),id:"alertaParaderoCaptura",value:i.alertaParaderoCaptura,options:[{label:"Captura Recompensa 💰",value:"normal"}],onChange:m}),e.jsx(Qe,{label:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-cash-coin text-warning me-3 p-1"})," Monto de Recompensa"]}),id:"montoRecompensa",type:"number",value:i.montoRecompensa,error:o.montoRecompensa,onChange:m,className:"text-center",required:!0}),e.jsxs("div",{className:"d-flex justify-content-end pt-4  mt-3",children:[e.jsxs("button",{type:"button",onClick:p,className:"btn btn-danger text-light shadow",children:[e.jsx("i",{className:"bi bi-x-circle "})," Limpiar Formulario"]}),e.jsxs("button",{type:"submit",className:"btn btn-primary2 shadow ms-2",disabled:g,children:[e.jsx("i",{className:"bi bi-send"})," Enviar Formulario"]})]})]})]})},Qe=({label:s,id:l,type:t="text",value:n,error:i,onChange:r,className:o="",required:d=!1})=>e.jsxs("div",{className:`mb-4 ${o}`,children:[e.jsx("span",{htmlFor:l,className:"input-group-text bg-light bg-opacity-25 border-white  text-white text-center mb-1",children:s}),e.jsx("input",{type:t,className:`form-control bg-transparent text-white border-white ${i?"is-invalid":""}`,id:l,value:n,onChange:r,required:d}),e.jsx("div",{className:"invalid-feedback text-light",children:i})]}),Ml=({label:s,id:l,value:t,options:n,onChange:i,className:r=""})=>e.jsxs("div",{className:`mb-5 ${r} text-center`,children:[e.jsx("span",{htmlFor:l,className:`input-group-text bg-light bg-opacity-25 text-white text-center d-flex justify-content-center shadow ${l==="alertaParaderoCaptura"?"bg-danger text-white":""}`,children:s}),e.jsx("select",{className:"form-select text-center",id:l,value:t,onChange:i,style:{color:"white",backgroundColor:"transparent",borderColor:"white"},children:n.map(({label:o,value:d})=>e.jsx("option",{value:d,style:{backgroundColor:"#5F3F8B",color:"white"},children:o},d))})]}),qs=({label:s,id:l,value:t,onChange:n,className:i=""})=>e.jsxs("div",{className:`form-floating mb-4 ${i}`,children:[e.jsx("textarea",{className:"form-control bg-transparent text-white border-white",id:l,value:t,onChange:n,style:{height:"100px"},placeholder:" "}),e.jsx("label",{htmlFor:l,className:"text-",children:s})]}),Pl=()=>{const[s,l]=a.useState(null),[t,n]=a.useState(!1),[i,r]=a.useState(!1),[o,d]=a.useState(!1),g=a.useRef(null);a.useEffect(()=>{const p=()=>{n(window.innerWidth<576)};return window.addEventListener("resize",p),p(),()=>window.removeEventListener("resize",p)},[]);const x=p=>{l(p),r(!1)},m=async p=>{var v;const c=()=>{const N=new Date,S=String(N.getDate()).padStart(2,"0"),k=String(N.getMonth()+1).padStart(2,"0"),y=String(N.getFullYear()).slice(-2);return`${S}/${k}/${y}`},h=(()=>{const N=localStorage.getItem("user");return N?JSON.parse(N):null})(),f={documento:p.documento,nombre_apellido:p.nombreApellido.toLowerCase(),sexo:p.sexo,entidad:p.entidad,numero_contacto:p.numeroContacto,descripcion_fisica:p.descripcionFisica,motivo_captura:p.motivoCaptura,base64:s,date:c(),usuario:h?h.email:"Desconocido",prioridad:p.prioridad,alerta:p.alerta||!1,paradero:p.paradero||!1,montoRecompensa:p.montoRecompensa?Number(p.montoRecompensa):!1};try{await Pe(W(D,"db_buscados"),f),console.log("Datos guardados en Firebase:",f),(v=g.current)==null||v.reset(),j()}catch(N){console.error("Error al guardar los datos en Firebase:",N)}},j=()=>{l(null),r(!1),d(!1)},u=p=>{const c=p.target.files[0];if(c){const b=new FileReader;b.onloadend=()=>{const h=new Image;h.onload=()=>{const f=document.createElement("canvas"),v=f.getContext("2d"),N=500,S=500;let k=h.width,y=h.height;k>y?k>N&&(y*=N/k,k=N):y>S&&(k*=S/y,y=S),f.width=k,f.height=y,v.drawImage(h,0,0,k,y);const w=f.toDataURL("image/jpeg");l(w),r(!1)},h.src=b.result},b.readAsDataURL(c)}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"container-lg",children:o?e.jsx("div",{className:"container",children:e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10 col-lg-8 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h1",{className:"display-5 fw-bold",children:"Formulario"}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:"bi bi-ui-checks fs-4 text-dark"})})]}),e.jsx("p",{className:"mt-2 text-white",children:"Gestioná tus registros de ingreso."}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 col-md-5 mb-4",children:e.jsxs("div",{className:"text-center position-relative",children:[!i&&s&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-secondaryM text-purple position-absolute end-0 top-0 mt-5 m-2","aria-label":"Editar",onClick:()=>{l(null),r(!0)},children:e.jsx("i",{className:"bi bi-pencil-fill"})}),e.jsx("h5",{className:"text-light mt-4",children:"Vista previa "}),e.jsx("img",{src:s,alt:"Captura subida",className:"img-fluid rounded-4 border border-light shadow mt-2",style:{maxWidth:"100%"}})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("h5",{className:"text-light",children:"Subí una nueva imagen"}),t?e.jsx("div",{className:"mb-3 w-100 px-3",children:e.jsx("input",{type:"file",className:"form-control bg-gradiante2 text-white",onChange:p=>{u(p)}})}):e.jsx(Us,{onImageSave:p=>{x(p)}})]})]})}),e.jsx("div",{className:"col-12 col-md-7",children:e.jsx(Al,{onSubmit:m,savedImage:s,resetImage:j,formRef:g})})]})]})})})}):e.jsx("div",{className:"w-100 text-white",children:e.jsxs("div",{className:"text-center py-5 px-3 bg-dark bg-opacity-25 rounded-4 shadow-lg",children:[e.jsxs("h2",{className:"mb-4 display-5 fw-bold text-white",children:[e.jsx("i",{className:"bi bi-image me-2"}),"Selecciona imagen para comenzar"]}),e.jsx("div",{className:"d-flex justify-content-center align-items-center gap-3 flex-column flex-md-row",children:t?e.jsxs("div",{className:"mb-3 w-100 px-3",children:[e.jsxs("label",{className:"form-label fw-semibold text-white",children:[e.jsx("i",{className:"bi bi-upload me-2"}),"Subir solo imagen"]}),e.jsx("input",{type:"file",className:"form-control bg-light text-dark rounded-3 shadow-sm",onChange:p=>{u(p),d(!0)}})]}):e.jsx("div",{className:"p-3 bg-body bg-opacity-10 rounded-4 shadow-sm",children:e.jsx(Us,{onImageSave:p=>{x(p),d(!0)}})})})]})})})})},Il=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Formulario Buscados - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsx("div",{className:"my-5",children:e.jsx(Pl,{})})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},Ll=()=>e.jsx(e.Fragment,{children:e.jsx(Il,{})}),$l=({show:s,onClose:l,datos:t})=>{a.useState(!1);const[n,i]=a.useState(!1);a.useEffect(()=>{if(s){window.history.pushState({modalOpen:!0},"");const o=d=>{l()};return window.addEventListener("popstate",o),()=>{window.removeEventListener("popstate",o)}}},[s]);const r=o=>{if(!o)return;/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?window.location.href=`tel:${o}`:alert(`Tu dispositivo no puede realizar llamadas. Número: ${o}`)};return s?e.jsxs("div",{className:"modal fade show bg-dark",style:{display:"block"},"aria-labelledby":"captureDetailsModalLabel","aria-hidden":"false",children:[e.jsx("div",{className:"modal-dialog   ",children:e.jsxs("div",{className:"modal-content  bg-light  border-0",children:[e.jsx("div",{className:"modal-header",children:e.jsx("button",{type:"button",className:"btn-close ",onClick:l})}),e.jsxs("div",{className:"modal-body text-center ",children:[e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:()=>i(!0),children:[e.jsx("div",{className:"fs-4 position-absolute top-0 start-50 translate-middle-x bg-secondary  text-center w-100 rounded-top small",style:{opacity:.8},children:t.documento}),e.jsx("img",{src:t.base64&&t.base64.trim()!==""&&t.base64.trim()!=="null"?t.base64:"https://via.placeholder.com/150",className:"img-fluid mb-3 shadow-lg rounded-2 ",alt:t.nombre_apellido||"Imagen no disponible",style:{width:"500px",height:"auto"},loading:"lazy"}),e.jsx("div",{className:"display-6 position-absolute text-capitalize bottom-0 start-50 translate-middle-x bg-primary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:t.nombre_apellido})]}),e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 text-dark",children:["Datos de la Solicitud ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-primary border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2",children:"Motivo Captura"})}),t.motivo_captura&&t.motivo_captura.trim()!==""?e.jsx("p",{className:"form-control bg-blueW2 text-dark",style:{minHeight:"auto"},children:t.motivo_captura}):null,(!t.motivo_captura||t.motivo_captura.trim()==="")&&e.jsxs("button",{className:"btn btn-sm btn-outline-secondary  mx-4",onClick:()=>alert("Solicitud enviada. La información que requirió se le informará a los cargadores de captura para su carga. 🏤"),children:["Solicitar Información ",e.jsx("i",{className:"bi bi-person-raised-hand"})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary2 text-white me-2",children:"Información Adicional"})}),t.descripcion_fisica&&t.descripcion_fisica.trim()!==""?e.jsx("p",{className:"form-control bg-blueW2 text-dark",style:{minHeight:"auto"},children:t.descripcion_fisica}):null,(!t.descripcion_fisica||t.descripcion_fisica.trim()==="")&&e.jsxs("button",{className:"btn btn-sm btn-outline-secondary  mx-4",onClick:()=>alert("Solicitud enviada. La información que requirió se le informará a los cargadores de captura para su carga. 🏤"),children:["Solicitar Información ",e.jsx("i",{className:"bi bi-person-raised-hand"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("hr",{className:"border border-white border-1 opacity-75"}),t.entidad&&t.entidad.trim()!==""&&e.jsxs("span",{className:"badge text-bg-primaryM text-white my-1 text-capitalize mx-3 p-2",children:[e.jsx("i",{className:"bi bi-exclamation-triangle-fill me-2"}),"Solicita - ",t.entidad]}),t.numero_contacto&&t.numero_contacto.trim()!==""&&e.jsx("div",{className:"d-flex justify-content-center my-3",children:e.jsxs("button",{className:"badge btn text-bg-primaryMuiBlue text-white text-capitalize p-2 d-flex align-items-center gap-2 mx-auto",onClick:()=>r(t.numero_contacto),children:[e.jsx("i",{className:"bi bi-telephone-forward-fill"}),"Contactar ",t.numero_contacto]})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed rounded-circle text-white",onClick:l,children:e.jsx("i",{className:"bi bi-x-lg"})})})]})}),n&&e.jsx("div",{className:"modal fade show d-flex align-items-center justify-content-center bg-dark ",style:{display:"block",width:"100vw",height:"100vh",position:"fixed",top:0,left:0,zIndex:1050},onClick:()=>i(!1),children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:o=>o.stopPropagation(),children:e.jsxs("div",{className:"modal-content bg-transparent border-0 text-center",children:[e.jsx("button",{type:"button",className:"btn-close btn-close-dark position-absolute top-0 end-0 m-3 bg-red",onClick:()=>i(!1)}),e.jsx("img",{src:t.base64||"https://via.placeholder.com/40",alt:"Imagen Ampliada",className:"img-fluid rounded shadow-lg",style:{maxWidth:"200vw",maxHeight:"200vh",objectFit:"contain"}})]})})})]}):null},Rl=({show:s,onClose:l,datos:t})=>{var d;const[n,i]=a.useState(!1),[r,o]=a.useState(!1);return a.useEffect(()=>{if(location.pathname==="/dashboard"){const g=()=>{l()};return window.history.pushState(null,document.title),window.addEventListener("popstate",g),()=>{window.removeEventListener("popstate",g)}}},[l]),s?e.jsxs("div",{className:"modal fade show bg-dark",style:{display:"block"},"aria-labelledby":"captureDetailsModalLabel","aria-hidden":"false",children:[e.jsx("div",{className:"modal-dialog modal-dialog-centered ",children:e.jsxs("div",{className:"modal-content bg-gradiante2 border-0",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{className:"modal-title text-center text-white fw-semibold",children:"Detalles de la Captura 👮"}),e.jsx("button",{type:"button",className:"btn-close btn-close-dark",onClick:l})]}),e.jsxs("div",{className:"modal-body text-white",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-4 d-flex justify-content-center align-items-start mb-3",children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:()=>o(!0),children:[e.jsx("img",{src:t.base64||"https://via.placeholder.com/150",alt:t.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle shadow mt-2",style:{width:"130px",height:"130px",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:"Capturado"})]})}),e.jsxs("div",{className:"col-md-8",children:[e.jsxs("small",{className:"d-flex gap-2 justify-content-end mb-1",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-white border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control text-center text-capitalize",value:t.nombre_apellido,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control text-center",value:t.documento,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Documento"})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end",children:["Detalles de la Captura ",e.jsx("i",{className:"bi bi-journal-text"})]}),e.jsx("hr",{className:"border border-white border-1 opacity-75"}),((d=t.capturas_informacion_estados)==null?void 0:d.length)>0?e.jsxs(e.Fragment,{children:[t.capturas_informacion_estados.slice().reverse().slice(0,n?t.capturas_informacion_estados.length:1).map((g,x)=>e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:`rounded-pill px-3 py-2 text-white ${g.captura_fecha?"bg-primary":"bg-secondaryMuiRed"}`,children:[e.jsx("strong",{className:"me-3",children:g.captura_autor||"Sistema"}),g.captura_fecha||g.captura_quita_fecha]}),g.captura_fecha&&e.jsxs("p",{children:["Relato: ",e.jsx("span",{className:"fw-semibold",children:g.captura_descripcion||"Sin relato"})]})]},x)),t.capturas_informacion_estados.length>1&&e.jsx("div",{className:"text-center",children:e.jsx("button",{className:"btn btn-link text-white text-decoration-none",onClick:()=>i(!n),children:n?"Ver menos":"Ver historial completo"})})]}):e.jsx("p",{className:"text-center",children:"No hay detalles de captura disponibles."})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-secondaryMuiRed rounded-circle text-white",onClick:l,children:e.jsx("i",{className:"bi bi-x-lg"})})})]})}),r&&e.jsx("div",{className:"modal fade show d-flex align-items-center justify-content-center bg-dark",style:{display:"block",width:"100vw",height:"100vh",position:"fixed",top:0,left:0,zIndex:1050},onClick:()=>o(!1),children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",onClick:g=>g.stopPropagation(),children:e.jsxs("div",{className:"modal-content bg-transparent border-0 text-center",children:[e.jsx("button",{type:"button",className:"btn-close btn-close-dark position-absolute top-0 end-0 m-3 bg-red",onClick:()=>o(!1)}),e.jsx("img",{src:t.base64||"https://via.placeholder.com/150",alt:"Imagen Ampliada",className:"img-fluid rounded shadow-lg",style:{maxWidth:"90vw",maxHeight:"90vh",objectFit:"contain"}})]})})})]}):null};function zl({setGridView:s,gridView:l,sortOrder:t,setSortOrder:n,sortBy:i,setSortBy:r,searchTerm:o,setSearchTerm:d,priorityFilter:g,setPriorityFilter:x,currentPage:m,handlePriorityChange:j,entidadSeleccionada:u,setEntidadSeleccionada:p,entidades:c}){const[b,h]=a.useState(!1),f=()=>{h(!1),r("fecha"),n("desc"),x([])};return e.jsx("div",{className:"container-lg  ",children:e.jsx("div",{className:"d-flex justify-content-center align-items-center ",children:e.jsx("div",{className:"w-100 text-white",children:e.jsxs("div",{className:"text-center p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg",children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center text-center my-3 gap-3 flex-wrap",children:[e.jsx("h1",{className:"display-5 fw-bold",children:"Recompensas"}),e.jsx("button",{type:"button",className:"btn btn-light position-relative",children:e.jsx("i",{className:"bi bi-currency-exchange fs-4 text-dark"})})]}),e.jsx("form",{className:"d-flex justify-content-center my-4",onSubmit:v=>v.preventDefault(),children:e.jsxs("div",{className:"input-group input-group-lg w-100",style:{maxWidth:"600px"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Buscar en Rosario...","aria-label":"Buscar",value:o,onChange:v=>d(v.target.value)}),e.jsx("button",{className:"btn btn-outline-light",type:"submit",children:e.jsx("i",{className:"bi bi-search"})})]})}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-3 my-3",children:[e.jsx("button",{type:"button",onClick:()=>s(!0),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${l?"active":""}`,title:"Vista en cuadrícula",children:e.jsx("i",{className:`bi bi-grid-3x3-gap-fill fs-5 ${l?"titilar":""}`})}),e.jsx("button",{type:"button",onClick:()=>s(!1),className:`btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2 ${l?"":"active"}`,title:"Vista en lista",children:e.jsx("i",{className:`bi bi-list fs-5 ${l?"":"titilar"}`})}),e.jsx("button",{type:"button",onClick:()=>h(!b),className:"btn btn-outline-light rounded-circle shadow-sm border-2 px-3 py-2",title:"Mostrar/Ocultar filtros",children:e.jsx("i",{className:"bi bi-plus-lg fs-5"})})]}),b&&e.jsxs("div",{className:"card shadow  bg-dark p-4 bg-opacity-25  rounded-4 shadow-lg text-white",style:{backgroundColor:"transparent",color:"white"},children:[e.jsxs("div",{className:"card-header fw-semibold  bg-light bg-opacity-25 rounded-4  p-3 text-ligh d-flex justify-content-between align-items-center ",children:[e.jsxs("span",{children:[e.jsx("i",{className:"bi bi-sort-alpha-down mx-1"})," Filtros de Galería"]}),e.jsx("i",{className:"bi bi-x-lg cursor-pointer",onClick:f,style:{cursor:"pointer"}})]}),e.jsxs("div",{className:"card-body ",children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-12 col-md-6 mb-3",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select   border-white shadow-sm text-center ",value:i,onChange:v=>r(v.target.value),children:[e.jsx("option",{value:"fecha",children:"Fecha"}),e.jsx("option",{value:"nombreApellido",children:"Nombre"})]}),e.jsx("label",{className:" p-2",children:"Filtrar por"})]})}),e.jsx("div",{className:"col-12 col-md-6 mb-3",children:e.jsxs("div",{className:"form-floating ",children:[e.jsx("select",{className:"form-select  border-white shadow-sm text-center",value:t,onChange:v=>n(v.target.value),children:i==="fecha"?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"asc",children:"Antiguo - Reciente"}),e.jsx("option",{value:"desc",children:"Reciente - Antiguo"})]}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"asc",children:"A - Z"}),e.jsx("option",{value:"desc",children:"Z - A"})]})}),e.jsx("label",{className:" p-2",children:"Ordenar Prioridad"})]})})]}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12 col-md-12 mb-3",children:e.jsxs("div",{className:"position-relative",children:[e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select bg-light rounded-4 shadow-sm text-center pe-5",value:u,onChange:v=>p(v.target.value),children:[e.jsx("option",{value:"",children:"Todas las Entidades"}),c.map((v,N)=>e.jsx("option",{value:v,children:v},N))]}),e.jsx("label",{className:"p-2 m-2",children:"Filtrar por Entidad"})]}),u&&e.jsx("button",{type:"button",className:"btn btn-sm btn-danger text-white position-absolute top-50 end-0 translate-middle-y me-3 shadow-sm rounded-circle",onClick:()=>p(""),title:"Quitar filtro",children:e.jsx("i",{className:"bi bi-x-lg"})})]})})})]})]})]})})})})}const Tl=({informeId:s})=>{const[l,t]=a.useState(null),[n,i]=a.useState(!1),[r,o]=a.useState(0);a.useEffect(()=>{const x=localStorage.getItem("user");if(x){const m=JSON.parse(x);t(m.email),d(m.email)}},[s]);const d=async x=>{var u,p;const m=B(D,"db_personas",s),j=await De(m);if(j.exists()){const c=j.data();o(((u=c.me_sirve)==null?void 0:u.length)||0),i((p=c.me_sirve)==null?void 0:p.includes(x))}},g=async()=>{if(!l)return;const x=B(D,"db_personas",s);await le(x,{me_sirve:n?Ie(l):Me(l)}),i(!n),o(m=>n?m-1:m+1)};return e.jsx("button",{onClick:g,className:"btn btn-outline-light bg-dark bg-opacity-50 d-flex align-items-center justify-content-center rounded-circle",style:{width:"50px",height:"50px"},"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Me sirve",children:e.jsx("i",{className:`bi ${n?"bi-hand-thumbs-up-fill text-secondaryM":"bi-hand-thumbs-up"} fs-4`})})},Bl=({informeId:s,objeto:l})=>{const[t,n]=a.useState(!1),[i,r]=a.useState(""),[o,d]=a.useState([]),[g,x]=a.useState(0),[m,j]=a.useState(!0);a.useEffect(()=>{l&&Array.isArray(l.InfoUsuario)?(d(l.InfoUsuario),x(l.InfoUsuario.length)):(d([]),x(0))},[l]),a.useEffect(()=>{document.body.style.overflow=t?"hidden":"auto"},[t]),a.useEffect(()=>{if(!t)return;window.history.pushState({modalOpen:!0},"");const p=()=>n(!1);return window.addEventListener("popstate",p),()=>window.removeEventListener("popstate",p)},[t]);const u=async()=>{const p=localStorage.getItem("user"),c=p?JSON.parse(p):null;if(!c||!i.trim()){alert("No se puede enviar un comentario vacío.");return}const b={comentario:i.trim(),usuario:c.email,timestamp:new Date().toISOString()};try{const h=B(D,"db_buscados",s);await le(h,{InfoUsuario:Me(b)}),d(f=>[b,...f]),x(f=>f+1),r(""),alert("Comentario enviado correctamente ✅"),n(!1)}catch(h){console.error("Error al guardar el comentario:",h),alert("Error al enviar el comentario.")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"position-relative d-inline-block",children:[e.jsx("button",{className:"btn btn-outline-light bg-dark bg-opacity-50 d-flex align-items-center justify-content-center p-3 rounded-circle",style:{width:"50px",height:"50px"},onClick:()=>n(!0),"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Informar",children:e.jsx("i",{className:"bi bi-chat-dots fs-4 text-white"})}),g>0&&e.jsx("span",{className:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger",style:{fontSize:"0.7rem"},children:g})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"modal d-block",tabIndex:"-1",role:"dialog","aria-modal":"true",style:{zIndex:1055},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header d-flex justify-content-between align-items-center border-0",children:[e.jsx("h5",{className:"modal-title",children:m?"Agregar información":"Comentarios"}),e.jsxs("div",{children:[e.jsx("button",{className:"btn btn-sm text-primary me-2",onClick:()=>j(!m),children:m?`Ver comentarios (${o.length})`:"Agregar información"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:()=>n(!1)})]})]}),e.jsx("div",{className:"modal-body",children:m?e.jsx("textarea",{className:"form-control",placeholder:"Escribí tu comentario...",value:i,onChange:p=>r(p.target.value),rows:4}):o.length>0?e.jsx("ul",{className:"list-group",children:o.slice().reverse().map((p,c)=>{const h=(p.usuario||"Usuario").charAt(0).toUpperCase(),f=p.timestamp?new Date(p.timestamp).toLocaleString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"";return e.jsxs("li",{className:"list-group-item d-flex align-items-center my-2 shadow border-0",children:[e.jsx("span",{className:"rounded-circle bg-primary text-white d-flex justify-content-center align-items-center me-3",style:{width:"40px",height:"40px",flexShrink:0},children:h}),e.jsxs("div",{className:"flex-grow-1 text-center",children:[p.comentario,e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:f})]})]},c)})}):e.jsx("p",{children:"No hay comentarios aún."})}),e.jsxs("div",{className:"modal-footer border-0",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>n(!1),children:"Cerrar"}),m&&e.jsx("button",{className:"btn btn-primary",onClick:u,children:"Guardar / Informar"})]})]})})}),e.jsx("div",{className:"position-fixed top-0 start-0 w-100 h-100",style:{backgroundColor:"rgba(0,0,0,0.75)",zIndex:1050},onClick:()=>n(!1)})]})]})},os=15;function Vs(s){const[l,t,n]=s.split("/").map(Number),i=2e3+n;return new Date(i,t-1,l)}const Ol=()=>{const[s,l]=a.useState(!1),[t,n]=a.useState(!1),[i,r]=a.useState(!1),[o,d]=a.useState(!1),[g,x]=a.useState([]),[m,j]=a.useState(1),[u,p]=a.useState(0),[c,b]=a.useState(null),[h,f]=a.useState(null),[v,N]=a.useState(null),[S,k]=a.useState(null),[y,w]=a.useState(!0),[C,E]=a.useState(!1),[F,_]=a.useState(null),[I,P]=a.useState("fecha"),[U,K]=a.useState("desc"),[G,A]=a.useState(""),[V,H]=a.useState(!0),[Z,z]=a.useState(""),[R,J]=a.useState(!0),[ne,me]=a.useState([]),[he,ae]=a.useState(""),T=async()=>{try{w(!0);const O=await re(W(D,"db_buscados")),ce=[],be=new Set;O.forEach(Ae=>{const Y={id:Ae.id,...Ae.data()};ce.push(Y),Y.entidad&&be.add(Y.entidad)}),x(ce),me(Array.from(be)),p(Math.ceil(ce.length/os))}catch(O){console.error("Error obteniendo documentos: ",O),_("No se pudieron cargar los documentos.")}finally{w(!1)}};a.useEffect(()=>{T()},[]);const L=O=>{const ce=O.target.value;z(be=>be.includes(ce)?be.filter(Ae=>Ae!==ce):[...be,ce])},Q=a.useMemo(()=>g.filter(O=>{var Y;const ce=(Y=O.nombre_apellido)==null?void 0:Y.toLowerCase().includes(G.toLowerCase()),be=Z.length===0||Z.includes(String(O.prioridad)),Ae=!he||O.entidad===he;return ce&&be&&Ae}),[g,G,Z,he]),X=a.useMemo(()=>Q.sort((O,ce)=>{if(O.prioridad===3&&ce.prioridad!==3)return-1;if(ce.prioridad===3&&O.prioridad!==3)return 1;if(O.prioridad===4&&ce.prioridad!==4)return-1;if(ce.prioridad===4&&O.prioridad!==4)return 1;if(I==="fecha"){const be=Vs(O.date)||0,Ae=Vs(ce.date)||0;return U==="asc"?be-Ae:Ae-be}else return U==="asc"?O.nombre_apellido.localeCompare(ce.nombre_apellido):ce.nombre_apellido.localeCompare(O.nombre_apellido)}),[Q,I,U]),se=(m-1)*os,M=X.slice(se,se+os),ee=()=>{m<u&&(E(!0),j(O=>O+1),setTimeout(()=>E(!1),500))},te=()=>{m>1&&(E(!0),j(O=>O-1),setTimeout(()=>E(!1),500))},$=O=>{k(!0),f(O)},ie=()=>{b(null),k(null)},q=O=>{N(!0),f(O)},de=()=>N(!1);return e.jsxs(e.Fragment,{children:[e.jsx(zl,{setGridView:H,gridView:V,sortOrder:U,sortBy:I,setSortOrder:K,setSortBy:P,searchTerm:G,setSearchTerm:A,showFilters:R,priorityFilter:Z,setPriorityFilter:z,currentPage:m,handlePriorityChange:L,entidadSeleccionada:he,setEntidadSeleccionada:ae,entidades:ne}),e.jsxs("div",{className:"container-lg",children:[y&&e.jsx(oe,{leyendaSet:"Cargado Base - Cx2"}),F&&e.jsx("div",{className:"alert alert-danger",children:F}),C?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(oe,{})}):e.jsx("div",{className:V?"row mt-5":"d-flex flex-column align-items-center mt-5",children:M.map(O=>e.jsx("div",{className:V?"col-6 col-sm-6 col-md-4 mb-4":"col-12 col-sm-6 col-md-6 mb-4",children:e.jsx("div",{className:"card py-4  shadow-sm text-center bg-dark bg-opacity-50  rounded-4",children:e.jsxs("div",{className:"position-relative",children:[O.alerta&&!O.captura&&e.jsx("div",{onClick:()=>n(!t),children:t?e.jsx("div",{className:"position-absolute top-1  start-50 translate-middle text-center d-flex justify-content-center align-items-center bg-redUi1  p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark  fw-semibold text-white ",children:[e.jsx("i",{className:" bi bi-exclamation-triangle-fill me-2 text-white titilar fs-5 shadow-sm "}),"Evadido ",O.date," "]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-redUi1   p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-exclamation-triangle-fill fs-5 mx-1 text-white titilar "})})}),O.prioridad===5&&e.jsx("div",{onClick:()=>d(!o),children:o?e.jsx("div",{className:"position-absolute top-1 bg-greenMui start-50 translate-middle text-center d-flex justify-content-center align-items-center p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark fw-semibold text-white",children:[e.jsx("i",{className:"bi bi-cash-coin fs-5 mx-2 text-white titilar"}),"Monto : $"," ",O.montoRecompensa?O.montoRecompensa.toLocaleString("es-AR"):"Sin datos"]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-greenMui p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-cash-coin fs-5 mx-1 text-white"})})}),O.paradero&&e.jsx("div",{onClick:()=>l(!s),children:s?e.jsx("div",{className:"position-absolute top-1 bg-blueMui start-50 translate-middle text-center d-flex justify-content-center align-items-center bg-redUi1  p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark  fw-semibold text-white ",children:[e.jsx("i",{className:" bi bi-search fs-5 mx-2 text-white  "}),"Paradero "]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-blueMui   p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-search fs-5 mx-1 text-white "})})}),O.prioridad===4&&e.jsx("div",{onClick:()=>r(!i),children:i?e.jsx("div",{className:"position-absolute top-1 bg-yellowMui start-50 translate-middle text-center d-flex justify-content-center align-items-center bg-redUi1  p-1 rounded shadow-sm",style:{width:"80%"},children:e.jsxs("span",{className:"fs-6 text-dark  fw-semibold text-white ",children:[e.jsx("i",{className:"bi bi-star-fill fs-5 mx-2 text-white "}),"Prioritaria"]})}):e.jsx("div",{className:"position-absolute end-0 translate-middle text-center text-dark bg-yellowMui   p-1 rounded-circle shadow-sm border border-white border-5",children:e.jsx("i",{className:"bi bi-star-fill fs-5 mx-1 text-white "})})}),O.captura&&e.jsxs("div",{className:"captura-cinta d-flex flex-column flex-md-row justify-content-between align-items-center p-2",style:{maxWidth:"100%",cursor:"pointer"},onClick:()=>q(O),children:[e.jsx("span",{className:"text-white fw-bold",children:"Capturado"}),e.jsx("button",{className:"btn btn-link p-0 text-white ms-md-2 mt-2 mt-md-0",onClick:ce=>{ce.stopPropagation(),q(O)},children:"Ver Detalles"})]}),e.jsx("div",{}),e.jsx("img",{src:O.base64&&O.base64.trim()!==""&&O.base64.trim()!=="null"?O.base64:$e,className:`card-img-top img-fluid  ${O.captura?"grayscale":""}`,alt:O.nombre_apellido||"Imagen no disponible",loading:"lazy",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"cover"},onClick:()=>$(O)}),e.jsx("h5",{className:"card-title text-white text-capitalize mt-4",children:O.nombre_apellido}),e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-2 mt-3",children:[e.jsx("button",{onClick:()=>$(O),className:"btn btn-outline-light bg-dark bg-opacity-50 d-flex align-items-center justify-content-center rounded-circle",style:{width:"50px",height:"50px"},"data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Ver detalles",children:e.jsx("i",{className:"bi bi-eye fs-4"})}),e.jsx(Tl,{informeId:O.id}),e.jsx(Bl,{informeId:O.id,objeto:O})]})]})})},O.id))}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center mt-4",children:[m>1&&e.jsx("button",{className:"btn btn rounded-pill shadow-sm text-center bg-dark bg-opacity-50 rounded-4 shadow-lg text-white",onClick:te,children:e.jsx("i",{className:"bi bi-arrow-left fw-semibold fs-3 titilar"})}),e.jsxs("span",{className:"fs-6 mx-3  text-light",children:["Página ",m," de ",u]}),m<u&&e.jsx("button",{className:"btn rounded-pill shadow-sm text-center bg-dark bg-opacity-50 rounded-4 shadow-lg text-white ",onClick:ee,children:e.jsx("i",{className:"bi bi-arrow-right fw-semibold fs-3 titilar"})})]})]}),e.jsx($l,{show:S,datos:h,onClose:ie}),e.jsx(Rl,{show:v,datos:h,onClose:de})]})},Ul=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Recompensa - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsx("div",{className:"my-5 ",children:e.jsx(Fe,{Promp:"Geleria Buscados SF ",Promp2:"bi bi-people-fill  fs-4 "})}),e.jsx(Ol,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},ql=()=>e.jsx(e.Fragment,{children:e.jsx(Ul,{})});cs.register(ds,ms,us,Qs,hs,xs,Xs,bs,ps);const Vl=(s,l)=>{const t=parseInt(s.replace("#",""),16),n=Math.max((t>>16)-l,0),i=Math.max((t>>8&255)-l,0),r=Math.max((t&255)-l,0);return`#${(n<<16|i<<8|r).toString(16).padStart(6,"0")}`},Gl=({totalAutos:s,totalMotos:l,totalCuatriciclos:t,totalCamionetas:n,totalCamiones:i,totalColectivos:r,totalBicicletas:o,totalTractores:d,totalAmbulancias:g,totalPoliciales:x,totalBomberos:m})=>{const[j,u]=a.useState("bar"),p=["#03dac6","#ffef62","#f73378","#2196f3","#7c4dff","#00e676","#ff9100","#ff1744","#00b0ff","#cddc39","#8d6e63"],b=[{label:"Autos",value:s},{label:"Motos",value:l},{label:"Cuatriciclos",value:t},{label:"Camionetas",value:n},{label:"Camiones",value:i},{label:"Colectivos",value:r},{label:"Bicicletas",value:o},{label:"Tractores",value:d},{label:"Ambulancias",value:g},{label:"Policiales",value:x},{label:"Bomberos",value:m}].filter(v=>v.value>0),h={labels:b.map(v=>v.label),datasets:[{label:"Vehículos por tipo",data:b.map(v=>v.value),backgroundColor:p.slice(0,b.length),borderColor:p.slice(0,b.length).map(v=>Vl(v,40)),borderWidth:1}]},f={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"#ffffff"}},title:{display:!0,text:"Vehículos por Tipo",color:"#ffffff",font:{size:20}},tooltip:{bodyColor:"#ffffff",titleColor:"#ffffff"}},scales:j==="pie"||j==="doughnut"?{}:{x:{ticks:{color:"#ffffff"},grid:{color:"rgba(255, 255, 255, 0.2)"}},y:{beginAtZero:!0,ticks:{color:"#ffffff",stepSize:1},grid:{color:"rgba(255, 255, 255, 0.2)"}}}};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-center my-5 text-light",children:"Vehículos por Tipo"}),e.jsx("div",{className:"row justify-content-center mb-4",children:e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"input-group input-group-sm shadow-sm",children:[e.jsx("span",{className:"input-group-text bg-dark bg-opacity-50 text-light",children:"Tipo de gráfico"}),e.jsxs("select",{className:"form-select text-center",onChange:v=>u(v.target.value),value:j,children:[e.jsx("option",{value:"bar",children:"Barra"}),e.jsx("option",{value:"line",children:"Línea"}),e.jsx("option",{value:"pie",children:"Pastel"}),e.jsx("option",{value:"doughnut",children:"Doughnut"})]})]})})}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-12 col-md-10",style:{height:"400px"},children:j==="scatter"?e.jsx(Ks,{data:h,options:f}):j==="bar"?e.jsx(gs,{data:h,options:f}):j==="line"?e.jsx(es,{data:h,options:f}):j==="pie"?e.jsx(js,{data:h,options:f}):j==="doughnut"?e.jsx(fs,{data:h,options:f}):null})})]})},Hl=({title:s="app",ImagenDash:l="/gif/dash.gif"})=>e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center  mt-5 text-light",children:[e.jsxs("span",{className:"display-4 mb-2",children:["¡Bienvenido a ",s,"!"]}),e.jsxs("span",{className:"mb-5 ",children:["Este panel de control te permite gestionar ",s,", ver estadísticas y configurar las opciones del sistema."]}),e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-md-6 d-flex flex-column justify-content-center align-items-center mb-4 mb-md-0",children:[e.jsxs("p",{className:"text-center d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"bi bi-asterisk p-3 rounded-circle me-3 bg-dark bg-opacity-25"}),e.jsx("span",{className:"p-2",children:"Desde aquí podrás administrar los recursos del sistema de forma fácil y eficiente."})]}),e.jsxs("p",{className:"text-center d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"bi bi-lightbulb  p-3 rounded-circle me-3 bg-dark bg-opacity-25"}),e.jsx("span",{className:"p-2",children:"Ante cualquier inconveniente, no dudes en solicitar asistencia técnica."})]})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-center align-items-center",children:e.jsx("img",{src:l,alt:"Panel de control gráfico",className:"img-fluid p-2 rounded-circle shadow",style:{maxWidth:"300px",height:"auto"}})})]})]}),Wl=({loading:s})=>{const[l,t]=a.useState([]),[n,i]=a.useState([]),r=["ciudad","color","createdAt","dominio","fechaHora","marca","modelo","nroChasis","nroMotor","observaciones","qth","telefono","tipo","titular","carta"],o={ciudad:"Ciudad",color:"Color",createdAt:"Fecha de creación",dominio:"Dominio / Patente",fechaHora:"Fecha y Hora",marca:"Marca",modelo:"Modelo",nroChasis:"Número de Chasis",nroMotor:"Número de Motor",observaciones:"Observaciones",qth:"QTH (Ubicación)",telefono:"Teléfono",tipo:"Tipo",titular:"Titular",carta:"Carta"},d=async()=>{try{const p=(await re(W(D,"db_vehiculos"))).docs.map(c=>({id:c.id,...c.data()}));t(p)}catch(u){console.error("Error al obtener los datos:",u)}},g=u=>{i(p=>p.includes(u)?p.filter(c=>c!==u):[...p,u])},x=()=>{i(r)},m=()=>{i([])},j=()=>{if(l.length===0||n.length===0)return;const u=l.map(b=>{const h={};return n.forEach(f=>{h[o[f]||f]=b[f]}),h}),p=ye.json_to_sheet(u),c=ye.book_new();ye.book_append_sheet(c,p,"Datos Seleccionados"),Ge(c,"Datos_Seleccionados.xlsx")};return a.useEffect(()=>{d()},[]),e.jsx(e.Fragment,{children:s?e.jsx(oe,{leyendaSet:"Exportar - Cx2"}):e.jsx("div",{className:"container-lg  mt-5 mt-md-0 text-white",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center ",children:[e.jsxs("span",{className:"mb-4 display-5",children:["Exportar Datos  ",e.jsx("i",{className:"bi bi-filetype-xml"})]}),e.jsx("h5",{className:"mb-5 fw-light",children:"Selecciona los campos que deseas incluir en la exportación."}),e.jsxs("div",{className:"d-flex justify-content-center mb-4 flex-wrap gap-2",children:[e.jsx("button",{className:"btn btn-outline-light",onClick:x,children:"Seleccionar todos"}),e.jsx("button",{className:"btn btn-outline-light",onClick:m,children:"Limpiar selección"})]}),e.jsx("form",{className:"mb-4 w-100 px-3 ",children:e.jsx("div",{className:"row p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg border border-1",children:r.map(u=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 mb-3",children:e.jsxs("div",{className:"form-check w-100 d-flex align-items-center",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:u,value:u,onChange:()=>g(u),checked:n.includes(u)}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:u,children:o[u]||u})]})},u))})}),n.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn bg-green bg-opacity-50 text-white fw-semibold",onClick:j,children:["Descargar datos seleccionados ",e.jsx("i",{className:"bi bi-file-earmark-arrow-down-fill ms-2"})]})})]})})})},Jl=({data1:s,data2:l})=>{const[t,n]=a.useState(!1),i=()=>n(!0),r=()=>n(!1),[o,d]=a.useState(""),x=(()=>{const u=localStorage.getItem("user");return u?JSON.parse(u):null})(),m=async u=>{if(window.confirm("¿Estás seguro de que deseas eliminar este vehículo?"))try{const p=B(D,"db_vehiculos_desactivados",u.id),c=new Date,b=`${c.getDate().toString().padStart(2,"0")}/${(c.getMonth()+1).toString().padStart(2,"0")}/${c.getFullYear().toString().slice(-2)}`;await Ne(p,{...u,usuario_baja:x.email||"usuario_desconocido",usuario_baja_fecha:b});const h=B(D,"db_vehiculos",u.id);await je(h),l(),d("vehiculo eliminado y copiado a la colección de desactivados."),setTimeout(()=>d(""),3e3)}catch(p){console.error("Error al eliminar vehiculo: ",p),d("Error al eliminar la vehiculo. Inténtalo de nuevo."),setTimeout(()=>d(""),3e3)}},j=u=>{m(u),r()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-trash3-fill"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("h5",{className:"modal-title ",children:"Eliminar Vehículo"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:r})]}),"  ",e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Dominio:"})," ",(s==null?void 0:s.dominio)||"NN"," - ",e.jsx("strong",{children:"Tipo:"}),"  ",e.jsx("span",{className:"text-capitalize",children:(s==null?void 0:s.tipo)||"Sin documento"})]}),e.jsxs("p",{className:"text-danger  bg-redW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas eliminar este vehiculo ?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:()=>{j(s)},children:"Confirmar Eliminación"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Yl=({data1:s,data2:l})=>{const[t,n]=a.useState(!1),i=()=>n(!0),r=()=>n(!1),[o,d]=a.useState(!1),[g,x]=a.useState(s.ciudad||""),[m,j]=a.useState(s.color||""),[u]=a.useState(s.createdAt||""),[p,c]=a.useState(s.dominio||""),[b,h]=a.useState(s.fechaHora||""),[f,v]=a.useState(s.marca||""),[N,S]=a.useState(s.modelo||""),[k,y]=a.useState(s.nroChasis||""),[w,C]=a.useState(s.nroMotor||""),[E,F]=a.useState(s.observaciones||""),[_,I]=a.useState(s.qth||""),[P,U]=a.useState(s.telefono||""),[K,G]=a.useState(s.tipo||""),[A,V]=a.useState(s.titular||""),[H,Z]=a.useState(s.usuario||""),[z,R]=a.useState("edición desde menú de vehículos"),J=()=>{const ae={ciudad:g,color:m,createdAt:u,dominio:p,fechaHora:b,marca:f,modelo:N,nroChasis:k,nroMotor:w,observaciones:E,qth:_,telefono:P,tipo:K,titular:A,usuario:H};return["ciudad","color","dominio","fechaHora","marca","modelo","nroChasis","nroMotor","observaciones","qth","telefono","tipo","titular","usuario"].filter(L=>ae[L]!==s[L])},ne=async()=>{if(!p.trim()){alert("El campo Dominio es obligatorio.");return}if(!f.trim()){alert("El campo Marca es obligatorio.");return}if(!N.trim()){alert("El campo Modelo es obligatorio.");return}if(!z.trim()){alert("La descripción de las ediciones es obligatoria.");return}const ae=B(D,"db_vehiculos",s.id),T=J();try{d(!0);const L=new Date,Q=`${L.getDate().toString().padStart(2,"0")}/${(L.getMonth()+1).toString().padStart(2,"0")}/${L.getFullYear().toString().slice(-2)}`;await le(ae,{ciudad:g,color:m,dominio:p,fechaHora:b,marca:f,modelo:N,nroChasis:k,nroMotor:w,observaciones:E,qth:_,telefono:P,tipo:K,titular:A,usuario:H,ediciones:[...s.ediciones||[],{motivo:z,usuario:he.email,fecha:Q,campos:T}]}),l(),alert("Los cambios se han guardado correctamente.")}catch(L){console.error("Error al actualizar el vehículo: ",L),alert("Error al guardar los cambios. Inténtalo de nuevo.")}d(!1)},he=(()=>{const ae=localStorage.getItem("user");return ae?JSON.parse(ae):null})();return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-primary text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-pen"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark ",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-lg ",role:"document",children:e.jsxs("div",{className:"modal-content shadow ",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title mx-2",children:"Editar Vehículo 🚗 "}),e.jsx("button",{type:"button",className:"btn-close",onClick:r})]}),e.jsx("hr",{className:"border border-primary border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body row ",children:[e.jsxs("div",{className:"col-md-6 ",children:[e.jsxs("div",{className:"form-floating mb-2  ",children:[e.jsx("input",{type:"text",className:"form-control ",value:g,onChange:ae=>x(ae.target.value),disabled:!0}),e.jsx("label",{children:"Ciudad"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsxs("select",{className:"form-select",id:"colorSelect",value:m,onChange:ae=>j(ae.target.value),children:[e.jsx("option",{value:"",children:"Seleccione un color..."}),e.jsx("option",{value:"blanco",children:"⚪ Blanco"}),e.jsx("option",{value:"negro",children:"⚫ Negro"}),e.jsx("option",{value:"gris",children:"⚪ Gris"}),e.jsx("option",{value:"plata",children:"⚪ Plata"}),e.jsx("option",{value:"rojo",children:"🔴 Rojo"}),e.jsx("option",{value:"bordo",children:"🔴 Bordó"}),e.jsx("option",{value:"azul",children:"🔵 Azul"}),e.jsx("option",{value:"verde",children:"🟢 Verde"}),e.jsx("option",{value:"amarillo",children:"🟡 Amarillo"}),e.jsx("option",{value:"dorado",children:"🟡 Dorado"}),e.jsx("option",{value:"naranja",children:"🟠 Naranja"}),e.jsx("option",{value:"violeta",children:"🟣 Violeta"}),e.jsx("option",{value:"marron",children:"🟤 Marrón"}),e.jsx("option",{value:"otros",children:"Otros"})]}),e.jsx("label",{htmlFor:"colorSelect",children:"Color"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:p,onChange:ae=>c(ae.target.value)}),e.jsx("label",{children:"Dominio"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:b,onChange:ae=>h(ae.target.value)}),e.jsx("label",{children:"Fecha y Hora"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:f,onChange:ae=>{const T=ae.target.value.replace(/[^A-Za-z\s]/g,"");v(T)}}),e.jsx("label",{children:"Marca"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:N,onChange:ae=>{const T=ae.target.value.replace(/[^A-Za-z0-9\s]/g,"");S(T)}}),e.jsx("label",{children:"Modelo"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:k,onChange:ae=>y(ae.target.value)}),e.jsx("label",{children:"Nro Chasis"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:w,onChange:ae=>C(ae.target.value)}),e.jsx("label",{children:"Nro Motor"})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("textarea",{className:"form-control",value:E,onChange:ae=>F(ae.target.value),style:{minHeight:"80px"}}),e.jsx("label",{children:"Observaciones"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:_,onChange:ae=>I(ae.target.value)}),e.jsx("label",{children:"QTH"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"number",className:"form-control",value:P,onChange:ae=>U(ae.target.value),min:"0",step:"1"}),e.jsx("label",{children:"Teléfono"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:K,onChange:ae=>G(ae.target.value)}),e.jsx("label",{children:"Tipo"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:A,onChange:ae=>{const T=ae.target.value.replace(/[^A-Za-zÁÉÍÓÚáéíóúÑñ\s]/g,"");V(T)},pattern:"[A-Za-zÁÉÍÓÚáéíóúÑñ\\s]+",title:"Solo se permiten letras y espacios"}),e.jsx("label",{children:"Titular"})]}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:H,onChange:ae=>Z(ae.target.value),disabled:!0}),e.jsx("label",{children:"Usuario"})]})]}),e.jsxs("div",{className:"form-floating mt-3",children:[e.jsx("textarea",{className:"form-control",value:z,onChange:ae=>R(ae.target.value),style:{minHeight:"100px"}}),e.jsx("label",{children:"Descripción de Edición"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:r,children:e.jsx("i",{className:"bi bi-x-circle"})}),e.jsx("button",{className:`btn btn-primary text-white btn-sm rounded-circle ${o?"titilar":""}`,onClick:ne,disabled:o,children:e.jsx("i",{className:"bi bi-floppy2"})})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Zl=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1),[o,d]=a.useState(""),[g,x]=a.useState(!1),m=()=>r(!0),j=()=>r(!1),u=()=>{n([])},c=(()=>{const h=localStorage.getItem("user");return h?JSON.parse(h):null})(),b=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas copiar estos vehículos a la colección de desactivados?"))){x(!0);try{const v=l.filter(N=>s.includes(N.id)).map(async N=>{const S=W(D,"db_vehiculos_desactivados"),k=new Date,y=`${k.getDate().toString().padStart(2,"0")}/${(k.getMonth()+1).toString().padStart(2,"0")}/${k.getFullYear().toString().slice(-2)}`;await Pe(S,{...N,usuario_baja:(c==null?void 0:c.email)||"usuario_desconocido",usuario_baja_fecha:y});const w=B(D,"db_vehiculos",N.id);await je(w)});await Promise.all(v),d("Vehículos copiados a la colección de desactivados y eliminados de la colección original."),t(),u()}catch(f){console.error("Error al eliminar vehículos:",f),d("Hubo un error al copiar o eliminar algunos vehículos.")}setTimeout(()=>d(""),3e3),x(!1),j()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:m,disabled:g,children:e.jsx("i",{className:"bi bi-trash3-fill"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Eliminar Vehículos del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:j})]}),e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-redW p-2 rounded-pill text-secondaryMuiRed fw-bold",children:["Se eliminarán ",s.length," vehículo",s.length!==1&&"s"," seleccionado",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(h=>s.includes(h.id)).map(h=>e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsxs("span",{className:"text-capitalize mx-1",children:[" ",h.tipo||"NN"," "]}),h.dominio||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(f=>f.filter(v=>v!==h.id)),title:"Quitar de la selección"})]},h.id))}),e.jsxs("p",{className:"text-danger text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas eliminar estos Vehiculos?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:j,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:b,disabled:g,children:g?"Eliminando...":"Confirmar Eliminación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"}),o&&e.jsx("div",{className:"alert alert-success mt-2",children:o})]})},ma=({Date1:s,Date2:l,setSelectedDocs:t,onCerrar:n,color:i})=>{const r=o=>{if(!o)return"❓";switch(o.toLowerCase()){case"auto":return"🚗";case"moto":return"🏍️";case"cuatriciclo":return"🛵";case"camioneta":return"🚙";case"camion":return"🚚";case"colectivo":return"🚌";case"bicicleta":return"🚲";case"tractor":return"🚜";case"ambulancia":return"🚑";case"policial":return"🚓";case"bomberos":return"🔥";default:return"❓"}};return e.jsxs("div",{className:`card bg-${i} shadow my-4 position-relative text-dark d-flex align-items-start gap-3 p-4 card text-center p-2 bg-dark bg-opacity-75 rounded-4 shadow-lg`,style:{overflow:"visible"},children:[e.jsx("button",{type:"button",className:"btn-close position-absolute top-0 end-0 m-2","aria-label":"Cerrar",onClick:n}),e.jsx("img",{src:"img/Perfiles/9.png",alt:"Asistente",className:" position-absolute",style:{width:"120px",height:"200px",objectFit:"contain",top:"-30px",left:"-20px"}}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"130px"},children:[e.jsx("h5",{children:e.jsx("strong",{children:"Asistente de Selección"})}),e.jsxs("p",{className:"mb-3",children:["Vehículos Seleccionadas: ",e.jsxs("strong",{children:[s.length," 🚗"]})]}),e.jsx("strong",{children:s.length>0?e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-start p-2 rounded mb-3  ",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(o=>s.includes(o.id)).map(o=>e.jsxs("div",{className:"badge text-dark shadow d-flex align-items-center p-2 mx-2 position-relative bg-light bg-opacity-50 m-1",style:{fontSize:"0.75rem"},children:[r(o.tipo),"  ",o.dominio||"Sin Dominio",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>t(d=>d.filter(g=>g!==o.id)),title:"Quitar de la selección"})]},o.id))}):e.jsx("span",{className:"text-danger",children:"Ninguna"})})]})]})},ua=({orden:s,setOrden:l})=>e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Ordenar alfabéticamente",value:s,onChange:t=>l(t.target.value),children:[e.jsx("option",{value:"asc",children:"Orden A-Z"}),e.jsx("option",{value:"desc",children:"Orden Z-A"})]}),e.jsxs("label",{children:["Ordenar ",e.jsx("i",{className:"bi bi-alphabet"})]})]}),ha=({searchTerm:s,setSearchTerm:l})=>e.jsxs("div",{className:"form-floating mb-3 position-relative  ",children:[e.jsx("input",{type:"text",className:"form-control  shadow-sm pe-5 bg-dark bg-opacity-50 text-light",placeholder:"Buscar por dominio",value:s,onChange:t=>l(t.target.value)}),e.jsx("label",{children:"Buscar por Dominio"}),s&&e.jsx("button",{type:"button",className:"btn btn-link position-absolute top-50 end-0 translate-middle-y pe-3 ",onClick:()=>l(""),"aria-label":"Cancelar búsqueda",children:e.jsx("i",{className:"bi bi-x-circle text-light "})})]}),xa=({tipoFilter:s,setTipoFilter:l})=>e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Seleccione tipo de vehículo",value:s,onChange:t=>l(t.target.value),children:[e.jsx("option",{value:"",children:"Todos los Tipos"}),e.jsx("option",{value:"auto",children:"Auto 🚗"}),e.jsx("option",{value:"moto",children:"Moto 🏍️"}),e.jsx("option",{value:"cuatriciclo",children:"Cuatriciclo 🛺"}),e.jsx("option",{value:"camioneta",children:"Camioneta 🚙"}),e.jsx("option",{value:"camion",children:"Camión 🚚"}),e.jsx("option",{value:"colectivo",children:"Colectivo 🚌"}),e.jsx("option",{value:"bicicleta",children:"Bicicleta 🚲"}),e.jsx("option",{value:"tractor",children:"Tractor 🚜"}),e.jsx("option",{value:"ambulancia",children:"Ambulancia 🚑"}),e.jsx("option",{value:"policial",children:"Policial 🚓"}),e.jsx("option",{value:"bomberos",children:"Bomberos 🚒"})]}),e.jsx("label",{children:"Seleccione un Tipo"})]}),Ql=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState(!0),[g,x]=a.useState(""),[m,j]=a.useState(""),[u,p]=a.useState(!0),[c,b]=a.useState("asc"),[h,f]=a.useState(""),v=W(D,"db_vehiculos"),N=async()=>{d(!0);try{const C=(await re(v)).docs.map(E=>({...E.data(),id:E.id}));l(C),n(C)}catch(w){console.error("Error al obtener vehículos: ",w)}finally{d(!1)}},S=w=>w.sort((C,E)=>c==="asc"?(C.dominio||"").localeCompare(E.dominio||""):(E.dominio||"").localeCompare(C.dominio||""));a.useEffect(()=>{N()},[]),a.useEffect(()=>{const w=s.filter(E=>E.dominio&&E.dominio.toLowerCase().includes(g.toLowerCase())||E.marca&&E.marca.toLowerCase().includes(g.toLowerCase())).filter(E=>m?E.prioridad===parseInt(m,10):!0).filter(E=>h?E.tipo.toLowerCase()===h.toLowerCase():!0),C=S(w);n(C)},[g,s,m,h,c]);const k=w=>{r(C=>C.includes(w)?C.filter(E=>E!==w):[...C,w])},y=()=>{if(i.length===t.length)r([]);else{const w=t.map(C=>C.id);r(w)}};return e.jsxs("div",{className:"container-lg text-white",children:[e.jsxs("div",{className:"row mt-5",children:[e.jsx("h1",{className:"text-center my-5 animate__animated animate__bounce mt-sm-0 mt-5",children:"Listado de Vehículos"}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(ha,{searchTerm:g,setSearchTerm:x})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(xa,{tipoFilter:h,setTipoFilter:f})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(ua,{orden:c,setOrden:b})})]}),o?e.jsx(oe,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[i.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(Zl,{data1:i,data2:s,dataRefresh:N,setSelectedDocs:r}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>r([])})]}),u&&e.jsx(ma,{Date1:i,Date2:s,setSelectedDocs:r,onCerrar:()=>p(!1),color:"blueW2"}),!u&&i.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>p(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-light"})," ",e.jsxs("small",{className:"text-light",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-light",children:[i.length," 🚗"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5",children:e.jsxs("table",{className:"table table-striped table-hover text-center small rounded-pill",children:[e.jsx("thead",{className:"table-info",children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:i.length===t.length,onChange:y})}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Dominio"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Tipo"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Marca"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Modelo"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(w=>e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:i.includes(w.id),onChange:()=>k(w.id)})}),e.jsx("td",{children:e.jsx("span",{className:"text-capitalize",children:w.dominio})}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:w.tipo}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:w.marca}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:w.modelo}),e.jsxs("td",{children:[e.jsx(Yl,{data1:w,data2:N}),e.jsx(Jl,{data1:w,data2:N})]}),e.jsx("td",{})]},w.id))})]})})]})})]})},Xl=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1),[o,d]=a.useState(!1),g=()=>r(!0),x=()=>r(!1),m=()=>{n([])},u=(()=>{const c=localStorage.getItem("user");return c?JSON.parse(c):null})(),p=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas recuperar estos vehículos?"))){d(!0);try{const h=l.filter(f=>s.includes(f.id)).map(async f=>{const v=B(D,"db_vehiculos",f.id),N=new Date,S=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`;await Ne(v,{...f,recuperado:[...f.recuperado||[],{motivo:"recuperado manual",usuario:u.email,fecha:S,datos_resguardo_baja_previa:[{usuario_baja:f.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:f.usuario_baja_fecha||"fecha_no_disponible"}]}]});const k=B(D,"db_vehiculos_desactivados",f.id);await je(k)});await Promise.all(h),alert("Vehículos recuperados y eliminados de la colección de desactivados."),t(),m()}catch(b){console.error("Error al recuperar vehículos:",b),alert("Hubo un error al recuperar o eliminar algunas vehículos.")}d(!1),x()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:g,disabled:o,children:e.jsx("i",{className:"bi bi-recycle"})})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Recuperar Vehículos del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:x})]}),e.jsx("hr",{className:"border border-teal border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-greenW p-2 rounded-pill text-primary fw-bold",children:["Se reactivan ",s.length," vehículo",s.length!==1&&"s"," seleccionado",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(c=>s.includes(c.id)).map(c=>e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsxs("span",{className:"mx-1 text-capitalize",children:["  ",c.tipo||"NN","  "]})," -",e.jsxs("span",{className:"mx-1 text-capitalize",children:["  ",c.dominio||"NN","  "]}),e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(b=>b.filter(h=>h!==c.id)),title:"Quitar de la selección"})]},c.id))}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas reactivar estos vehículos?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:x,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:p,disabled:o,children:o?"Recuperando...":"Confirmar Recuperación"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Kl=({data1:s,data2:l})=>{const[t,n]=a.useState(!1),i=()=>n(!0),r=()=>n(!1),d=(()=>{const m=localStorage.getItem("user");return m?JSON.parse(m):null})(),g=async m=>{if(window.confirm("¿Estás seguro de que deseas recuperar este vehículo ?"))try{const j=B(D,"db_vehiculos",m.id),u=new Date,p=`${u.getDate().toString().padStart(2,"0")}/${(u.getMonth()+1).toString().padStart(2,"0")}/${u.getFullYear().toString().slice(-2)}`,c="campos_modificados_aqui";await Ne(j,{...m,recuperado:[...m.recuperado||[],{motivo:"recuperado manual",usuario:d.email,fecha:p,datos_resguardo_baja_previa:[{usuario_baja:m.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:m.usuario_baja_fecha||"fecha_no_disponible"}]}]});const b=B(D,"db_vehiculos_desactivados",m.id);await je(b),l(),alert("Vehículo recuperado y copiado a la colección de capturas.")}catch(j){console.error("Error al recuperar vehículo: ",j)}},x=m=>{g(m),r()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-recycle"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Recuperar Persona"}),e.jsx("button",{type:"button",className:"btn-close",onClick:r})]}),e.jsx("hr",{className:"border border-teal  border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo:"}),e.jsxs("span",{className:"text-capitalize mx-1",children:[(s==null?void 0:s.tipo)||"NN"," "]}),e.jsx("strong",{children:"Dominio:"}),e.jsxs("span",{className:"text-capitalize mx-1",children:[" ",(s==null?void 0:s.dominio)||"NN"," "]})]}),e.jsxs("p",{className:"text-primary bg-greenW2 p-1",children:[e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas recuperar esta persona?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:()=>x(s),children:"Confirmar Recuperación"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},er=()=>{const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState(!0),[g,x]=a.useState(""),[m,j]=a.useState(""),[u,p]=a.useState(""),[c,b]=a.useState(!0),[h,f]=a.useState("asc"),v=W(D,"db_vehiculos_desactivados"),N=async()=>{d(!0);try{const C=(await re(v)).docs.map(E=>({...E.data(),id:E.id}));l(C),n(C)}catch(w){console.error("Error al obtener vehículos: ",w)}finally{d(!1)}},S=w=>[...w].sort((C,E)=>h==="asc"?(C.dominio||"").localeCompare(E.dominio||""):(E.dominio||"").localeCompare(C.dominio||""));a.useEffect(()=>{N()},[]),a.useEffect(()=>{const w=s.filter(E=>E.dominio&&E.dominio.toLowerCase().includes(g.toLowerCase())||E.marca&&E.marca.toLowerCase().includes(g.toLowerCase())).filter(E=>m?E.prioridad===parseInt(m,10):!0).filter(E=>{var F;return u?((F=E.tipo)==null?void 0:F.toLowerCase())===u.toLowerCase():!0}),C=S(w);n(C)},[g,s,m,u,h]);const k=w=>{r(C=>C.includes(w)?C.filter(E=>E!==w):[...C,w])},y=()=>{if(i.length===t.length)r([]);else{const w=t.map(C=>C.id);r(w)}};return e.jsxs("div",{className:"container-lg text-white",children:[e.jsxs("div",{className:"row mt-5",children:[e.jsx("h1",{className:"text-center mb-5 animate__animated animate__bounce mt-sm-0",children:"Listado de Vehículos Desactivados"}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(ha,{searchTerm:g,setSearchTerm:x})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(xa,{tipoFilter:u,setTipoFilter:p})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(ua,{orden:h,setOrden:f})})]}),o?e.jsx(oe,{}):e.jsx(e.Fragment,{children:t.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[i.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(Xl,{data1:i,data2:s,dataRefresh:N,setSelectedDocs:r}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>r([])})]}),c&&e.jsx(ma,{Date1:i,Date2:s,setSelectedDocs:r,onCerrar:()=>b(!1),color:"blueW2"}),!c&&i.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>b(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-white"})," ",e.jsxs("small",{className:"text-white",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-white",children:[i.length," 🧑"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5",children:e.jsxs("table",{className:"table table-striped table-hover text-center small",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:i.length===t.length,onChange:y})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Dominio"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Tipo"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(w=>e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:i.includes(w.id),onChange:()=>k(w.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{className:"text-capitalize",children:w.dominio}),e.jsxs("span",{className:"text-capitalize",children:[w.marca," ",w.modelo]})]})}),e.jsx("td",{className:"d-none d-sm-table-cell",children:w.dominio}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:w.tipo}),e.jsx("td",{children:e.jsx(Kl,{data1:w,data2:N})}),e.jsx("td",{})]},w.id))})]})})]})})]})},sr=()=>{const[s,l]=a.useState("dashboard"),[t,n]=a.useState([]),[i,r]=a.useState(!1),o=async()=>{try{r(!0);const S=await re(W(D,"db_vehiculos")),k=[];S.forEach(y=>{k.push({id:y.id,...y.data()})}),n(k)}catch(S){console.error("Error al obtener los documentos: ",S)}finally{r(!1)}};a.useEffect(()=>{o()},[]);const d=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="auto"}).length,g=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="moto"}).length,x=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="cuatriciclo"}).length,m=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="camioneta"}).length,j=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="camion"}).length,u=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="colectivo"}).length,p=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="bicicleta"}).length,c=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="tractor"}).length,b=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="ambulancia"}).length,h=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="policial"}).length,f=t.filter(S=>{var k;return((k=S.tipo)==null?void 0:k.toLowerCase())==="bomberos"}).length,v=t.length,N=()=>{switch(s){case"dashboard":return e.jsx(Hl,{title:"vehículos",ImagenDash:"/gif/dash6.gif"});case"reportes":return e.jsx(Wl,{loading:i});case"graficos":return e.jsx(Gl,{totalAutos:d,totalMotos:g,totalCuatriciclos:x,totalCamionetas:m,totalCamiones:j,totalColectivos:u,totalBicicletas:p,totalTractores:c,totalAmbulancias:b,totalPoliciales:h,totalBomberos:f});case"Desactivados":return e.jsx(er,{});case"capturas":return e.jsx(Ql,{});default:return e.jsx("p",{children:"Selecciona una opción del menú."})}};return e.jsx("div",{className:"container-lg",children:e.jsxs("div",{className:"row ",children:[e.jsxs("div",{className:"col-12 col-md-4 col-lg-3 ",children:[e.jsx("div",{className:"text-center mb-4 text-light",children:e.jsxs("span",{className:"bg-dark bg-opacity-25 p-2 px-5 fs-6 rounded-5 ",children:[" ",e.jsx("i",{className:"mx-2 bi bi-menu-button-fill"}),"Menú Panel"]})}),e.jsxs("div",{className:"list-group p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="dashboard"?"active":""}`,onClick:()=>l("dashboard"),children:"Bienvenido"}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="reportes"?"active":""}`,onClick:()=>l("reportes"),children:"Exportación"}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="graficos"?"active":""}`,onClick:()=>l("graficos"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Graficos",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-teal rounded-pill",children:"Nuevo"})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="capturas"?"active":""}`,onClick:()=>l("capturas"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Vehiculos",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",v]})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="Desactivados"?"active":""}`,onClick:()=>l("Desactivados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Desactivados",i?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-cyan rounded-pill",children:"Reactivar"})]})})]})]}),e.jsx("div",{className:"col-12 col-md-8 col-lg-9",children:N()})]})})},ar=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Panel de Control"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5 animate__animated animate__lightSpeedInRight",children:["  ",e.jsx(Fe,{Promp:"Panel de Control ",Promp2:"bi bi-car-front-fill fs-4 "}),"   "]}),e.jsx(sr,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},tr=()=>e.jsx(e.Fragment,{children:e.jsx(ar,{})}),ir=({showModalNot:s,setShowModalNot:l})=>{const[t,n]=a.useState(""),[i,r]=a.useState(""),[o,d]=a.useState("1"),[g,x]=a.useState(""),[m,j]=a.useState(!1),u=()=>{const c=new Date,b=String(c.getDate()).padStart(2,"0"),h=String(c.getMonth()+1).padStart(2,"0"),f=c.getFullYear().toString().slice(-2);return`${b}/${h}/${f}`};a.useEffect(()=>{const c=b=>{b.key==="Escape"&&l(!1)};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[]),a.useEffect(()=>{s&&window.history.pushState({modalOpen:!0},"");const c=b=>{s&&l(!1)};return window.addEventListener("popstate",c),()=>window.removeEventListener("popstate",c)},[s]);const p=async c=>{if(c.preventDefault(),t.trim()===""){x("El mensaje no puede estar vacío.");return}if(t.length>280){x("El mensaje no puede exceder los 280 caracteres.");return}if(o===""){x("Por favor, selecciona una carátula.");return}x(""),j(!0);try{await Pe(W(D,"db_notificaciones"),{titulo:i,contenido:t,timestamp:Re(),leido:!1,fecha:u(),caratula:o}),r(""),n(""),d("1"),l()}catch(b){console.error("Error al enviar notificación: ",b),x("Error al enviar la notificación. Inténtalo de nuevo.")}finally{j(!1)}};return e.jsx("div",{className:`modal bg-dark text-white ${s?"show":""}`,tabIndex:"-1",role:"dialog","aria-labelledby":"modalTitle",style:{display:s?"block":"none"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header text-center  bg-gradiante2 bg-opacity-50 ",children:[e.jsxs("h3",{className:"modal-title text-center ",id:"modalTitle",children:["Crear Notificación  ",e.jsx("i",{className:"bi bi-envelope-plus ms-2 titilar ",style:{fontSize:"1.8rem"},children:" "})]}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:()=>l(!1)})]}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"text-center mt-2 mb-5",children:e.jsxs("form",{onSubmit:p,children:[e.jsx("div",{className:"mb-3 text-center",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control shadow-sm",placeholder:"Escribe el mensaje aquí",id:"titulo",value:i,onChange:c=>r(c.target.value)}),e.jsx("label",{className:"text-blue",children:"Titulo de la Notificación"})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsxs("div",{className:"form-floating",children:[e.jsx("textarea",{className:"form-control shadow-sm",placeholder:"Escribe el mensaje aquí",id:"mensaje",value:t,onChange:c=>n(c.target.value),style:{minHeight:"150px"}}),e.jsx("label",{className:"text-blue",children:"Mensaje"})]})}),e.jsx("div",{className:"mb-3 text-center",children:e.jsx("div",{className:"col-md",children:e.jsxs("div",{className:"form-floating shadow-sm",children:[e.jsxs("select",{className:"form-select text-center",id:"floatingSelectGrid",value:o,onChange:c=>d(c.target.value),children:[e.jsx("option",{value:"1",children:"Informativa "}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 👮🏻"}),e.jsx("option",{value:"4",children:"Prioritaria ⭐"})]}),e.jsx("label",{className:"text-blue",children:"Selecciona Tipo de Notificación"})]})})}),g&&e.jsx("div",{className:"alert alert-danger mt-5",children:g}),m?e.jsx(oe,{}):e.jsx("div",{className:"d-grid",children:e.jsx("button",{type:"submit",className:"btn bg-primary border-white border-3 text-white rounded-pill position-absolute top-100 start-50 shadow-sm translate-middle",children:e.jsxs("span",{children:["Crear Notificación ",e.jsx("i",{className:"bi bi-send-check-fill ms-2 text-white"})]})})})]})})})]})})})},Ke=s=>{switch(s){case 1:return"🕵🏻";case 2:return"🔎";case 3:return"👮🏻";case 4:return"⭐";default:return"🕵🏻"}},lr=({showModal:s,cerrarModal:l,selectedPersona:t,setSelectedPersona:n,searchQuery:i,setSearchQuery:r,personas:o,asociarCaptura:d,loading:g})=>{const[x,m]=a.useState(!1),j=async()=>{if(t)try{m(!0),await d(),n(null),r(""),l(!1)}finally{m(!1)}};return e.jsx("div",{className:`modal fade bg-dark ${s?"show d-block":""}`,tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!s,style:{backgroundColor:"rgba(0,0,0,0.5)"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content p-3 bg-gradient rounded-4 shadow-lg border-0",children:[e.jsxs("div",{className:"modal-header border-0 text-dark",children:[e.jsx("h5",{className:"modal-title",id:"modalLabel",children:"Asociar Persona a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>{n(null),r(""),l(!1)},"aria-label":"Cerrar",disabled:g})]}),e.jsxs("div",{className:"modal-body bg-light rounded-4 p-4 shadow-sm",children:[t&&e.jsxs("div",{className:"alert alert-primary d-flex align-items-center mb-4 rounded-4 shadow-sm",children:[e.jsx("i",{className:"bi bi-person-check-fill fs-4 me-2"}),e.jsx("strong",{className:"mb-0",children:"Seleccionado:"}),e.jsx("span",{className:"ms-2",children:t==null?void 0:t.nombre_apellido}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-primary ms-auto",onClick:()=>n(null),"aria-label":"Quitar selección",children:e.jsx("i",{className:"bi bi-x-lg"})})]}),e.jsx("label",{htmlFor:"persona",className:"form-label fw-semibold text-dark",children:"Buscar DNI o Nombre:"}),e.jsxs("div",{className:"d-flex mb-3",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Juan Pérez o 12345678",value:i,onChange:u=>r(u.target.value),disabled:g}),e.jsx("button",{className:"btn btn-outline-danger ms-2",onClick:()=>r(""),disabled:!i||g,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash"})})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"fw-bold text-start mb-2",children:"Resultados:"}),e.jsx("ul",{className:"list-group mb-3",style:{maxHeight:"180px",overflowY:"auto"},"aria-live":"polite",children:o.filter(u=>`${u.nombre_apellido} ${u.documento}`.toLowerCase().includes(i.toLowerCase())).map(u=>{var p;return e.jsxs("li",{className:"list-group-item d-flex align-items-center gap-3",onClick:()=>{n(u),r("")},style:{cursor:"pointer"},tabIndex:0,onKeyDown:c=>{c.key==="Enter"&&(n(u),r(""))},children:[e.jsx("img",{src:((p=u.base64)==null?void 0:p.trim())||"defaultSvgUrl",alt:u.nombre_apellido,className:"rounded-circle",style:{width:"45px",height:"45px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("p",{className:"mb-0 fw-semibold",children:u.nombre_apellido}),e.jsx("small",{className:"text-muted",children:u.documento})]}),e.jsx("span",{className:`badge rounded-pill border border-white border-2 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[u.prioridad]||"bg-warning text-dark"}`,children:Ke(u.prioridad)})]},u.id)})})]}),e.jsx("label",{htmlFor:"dropdownMenuButton",className:"form-label fw-semibold text-dark",children:"Buscar en lista:"}),e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{className:"btn btn-light dropdown-toggle w-100 text-truncate",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:g,children:(t==null?void 0:t.nombre_apellido)||"Selecciona una persona"}),e.jsx("ul",{className:"dropdown-menu w-100","aria-labelledby":"dropdownMenuButton",style:{maxHeight:"250px",overflowY:"auto"},children:o.map(u=>{var p;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>n(u),type:"button",children:[e.jsx("img",{src:((p=u.base64)==null?void 0:p.trim())||"defaultSvgUrl",alt:u.nombre_apellido,className:"rounded-circle",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1 text-truncate",children:[u.nombre_apellido," - ",u.documento]}),e.jsx("span",{className:`badge rounded-pill border border-white border-2 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[u.prioridad]||"bg-warning text-dark"}`,children:Ke(u.prioridad)})]})},u.id)})})]})]}),e.jsxs("div",{className:"modal-footer border-0 pt-0",children:[e.jsx("button",{type:"button",className:"btn btn-primary d-flex align-items-center gap-2",onClick:j,disabled:g||x||!t,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),e.jsx("span",{children:"Asociando..."})]}):e.jsxs(e.Fragment,{children:["Asociar Persona  ",e.jsx("i",{className:"bi bi-person-plus-fill"})]})}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{n(null),r(""),l(!1)},disabled:g||x,children:"Cerrar"})]})]})})})},rr=({notificaciones:s,personas:l,vehiculos:t,buscados:n,obtenerNombreCaratula:i,agregarProtocolo:r,abrirModalVehiculo:o,abrirModalBuscados:d,abrirModal:g,abrirModalLink:x,eliminarNotificacion:m,loading:j,eliminarEnlace:u,eliminarAsociacion:p,mostrarNotificacionesAsociadas:c,selectedNotifIdContenido:b,contenidoEditado:h,setContenidoEditado:f,editarContenido:v,setSelectedNotifIdContenido:N,selectedNotifIdTitulo:S,setSelectedNotifIdTitulo:k,setTituloEditado:y,tituloEditado:w,editarTitulo:C})=>{const[E,F]=a.useState(null);return e.jsx("div",{className:"accordion ",id:"accordionNotificaciones",children:s.map((_,I)=>{var P,U,K,G,A;return e.jsxs("div",{className:"accordion-item mb-3 shadow-sm rounded-1  ",children:[e.jsx("h2",{className:"accordion-header ",id:`heading-${I}`,children:e.jsxs("button",{className:"accordion-button collapsed bg-gradiante2   text-white fw-bold rounded-1",type:"button","data-bs-toggle":"collapse","data-bs-target":`#collapse-${I}`,"aria-expanded":"false","aria-controls":`collapse-${I}`,onClick:()=>F(E===I?null:I),children:[e.jsx("span",{className:`p-1 border border-light border-3 rounded-pill me-3 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[_.caratula]||"bg-warning text-dark"} ${E===I?"titilar":""}`,children:i(_.caratula)}),e.jsx("span",{className:"text-capitalize  ",children:_.titulo||"Sin título"})]})})," ",e.jsxs("div",{id:`collapse-${I}`,className:"accordion-collapse collapse","aria-labelledby":`heading-${I}`,"data-bs-parent":"#accordionNotificaciones",children:[e.jsxs("div",{className:"p-3 ",children:[e.jsx("h6",{className:"text-center bg-secondaryM fw-semibold shadow-sm text-white py-1 rounded ",children:"Título"}),_.id===S?e.jsxs("div",{children:[e.jsx("input",{type:"text",value:w,onChange:V=>y(V.target.value),className:"form-control"}),e.jsx("button",{className:"btn btn-primary mt-2",onClick:()=>C(_.id),disabled:j,children:j?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios"," ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1"})]})})]}):e.jsx("small",{className:"mb-2 text-muted",children:_.titulo}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${_.id===S?"btn-danger":"btn-primary"}`,onClick:()=>{_.id===S?k(null):(y(_.titulo),k(_.id))},children:e.jsx("i",{className:`bi ${_.id===S?"bi-x-circle":"bi-pencil"}`})})}),e.jsx("h6",{className:"text-center bg-primary fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Contenido"}),_.id===b?e.jsxs("div",{children:[e.jsx("textarea",{value:h,onChange:V=>f(V.target.value),className:"form-control",rows:"5"}),e.jsx("button",{className:"btn btn-primary mt-2",onClick:()=>v(_.id),disabled:j,children:j?e.jsx("i",{className:"bi bi-floppy2-fill spinner spinner-border-sm"}):e.jsxs(e.Fragment,{children:["Guardar cambios"," ",e.jsx("i",{className:"bi bi-floppy2-fill ms-1"})]})})]}):e.jsx("small",{className:"mb-2 text-muted",children:_.contenido}),e.jsx("div",{className:"d-flex justify-content-end gap-2 p-3",children:e.jsx("button",{className:`btn btn-sm rounded-circle text-white ${_.id===b?"btn-danger":"btn-primary"}`,onClick:()=>{_.id===b?N(null):(f(_.contenido),N(_.id))},children:e.jsx("i",{className:`bi ${_.id===b?"bi-x-circle":"bi-pencil"}`})})}),_.enlace&&_.enlace.length>0?e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-center bg-secondaryM fw-semibold shadow-sm text-white py-1 rounded mt-3",children:"Enlaces Asociados"}),e.jsx("ul",{className:"list-unstyled",children:_.enlace.map((V,H)=>e.jsxs("li",{className:"d-flex align-items-center justify-content-center gap-3 p-2 rounded-pill bg-light shadow-sm",children:[e.jsx("i",{className:"bi bi-browser-chrome text-primary girar",style:{fontSize:"20px"}}),e.jsx("a",{href:r(V),target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none text-primary text-center flex-grow-1",style:{maxWidth:"250px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:V}),e.jsx("button",{className:"btn btn-redUi1 btn-sm rounded-circle",onClick:()=>u(H,_.id),children:e.jsx("i",{className:"bi bi-trash text-white"})})]},H))})]}):e.jsx("p",{className:"text-danger mt-3 text-center"}),_.personas_asociadas&&Object.keys(_.personas_asociadas).length>0?e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{className:"text-center bg-primary fw-semibold shadow-sm text-white py-1 rounded",children:"Personas Asociadas"}),Object.entries(_.personas_asociadas).map(([V,H],Z)=>{var R,J;const z=l.find(ne=>ne.id===V)||H;return e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2 p-2 shadow-sm bg-primary rounded-4 bg-opacity-25",children:[e.jsx("img",{src:((R=z.base64)==null?void 0:R.trim())||"defaultSvgUrl",alt:z.nombre_apellido||"Imagen no disponible",className:"rounded-circle me-3",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1 text-center",children:[e.jsxs("span",{children:[Z+1,". ",z.nombre_apellido]}),((J=z.asociada_notificacion_id)==null?void 0:J.length)>0&&e.jsxs("span",{className:"badge bg-teal text-white ms-3",onClick:()=>c(z),style:{cursor:"pointer"},children:["Asociado ",z.asociada_notificacion_id.length]})]}),e.jsx("button",{className:"btn btn-sm btn-redUi1 text-white ms-3",onClick:()=>p(_.id,V,z.nombre_apellido),children:e.jsx("i",{className:"bi bi-trash"})})]},V)})]}):e.jsx("span",{className:"text-danger text-center d-block"}),_.buscados_asociados&&Object.keys(_.buscados_asociados).length>0?e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{className:"text-center bg-secondaryM fw-semibold shadow-sm text-white py-1 rounded",children:"Buscados SF"}),Object.entries(_.buscados_asociados).map(([V,H],Z)=>{var R,J;const z=n.find(ne=>ne.id===V)||H;return e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2 p-2 shadow-sm bg-secondaryM rounded-4 bg-opacity-25",children:[e.jsx("img",{src:((R=z.base64)==null?void 0:R.trim())||"defaultSvgUrl",alt:z.nombre_apellido||"Imagen no disponible",className:"rounded-circle me-3",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1 text-center",children:[e.jsxs("span",{children:[Z+1,". ",z.nombre_apellido]}),((J=z.asociada_notificacion_id)==null?void 0:J.length)>0&&e.jsxs("span",{className:"badge bg-teal text-white ms-3",onClick:()=>c(z),style:{cursor:"pointer"},children:["Asociado ",z.asociada_notificacion_id.length]})]}),e.jsx("button",{className:"btn btn-sm btn-redUi1 text-white ms-3",onClick:()=>p(_.id,V,z.nombre_apellido,"buscado"),children:e.jsx("i",{className:"bi bi-trash"})})]},V)})]}):e.jsx("span",{className:"text-danger text-center d-block"}),_.vehiculos_asociados&&Object.keys(_.vehiculos_asociados).length>0?e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{className:"text-center bg-orangeDb fw-semibold shadow-sm text-white py-1 rounded",children:"Vehículos Asociados"}),Object.entries(_.vehiculos_asociados).map(([V,H],Z)=>{var R,J;t.find(ne=>ne.id===V);const z=((R=H.tipo)==null?void 0:R.toLowerCase())==="auto"?e.jsx("i",{className:"bi bi-car-front-fill fs-4 me-3 text-orange"}):((J=H.tipo)==null?void 0:J.toLowerCase())==="moto"?e.jsx("i",{className:"bi bi-bicycle fs-4 me-3 text-orange"}):e.jsx("i",{className:"bi bi-truck fs-4 me-3 text-orange"});return e.jsxs("div",{className:"d-flex align-items-center justify-content-center mb-2 p-2 shadow-sm bg-orangeDb rounded-4 bg-opacity-25",children:[z,e.jsxs("div",{className:"flex-grow-1 text-center",children:[e.jsxs("span",{children:[Z+1,"."]}),e.jsxs("span",{children:[e.jsx("span",{className:"text-capitalize mx-1 fw-semibold",children:H.dominio||"SIN DOMINIO"}),"- ",H.marca||"Marca N/D"," ",H.modelo||""]}),(()=>{const ne=t.find(me=>me.dominio===V);return ne&&Array.isArray(ne.asociada_notificacion_id)&&ne.asociada_notificacion_id.length>0?e.jsxs("span",{className:"badge bg-orange text-white ms-3",onClick:()=>c(ne),style:{cursor:"pointer"},children:["Asociado ",ne.asociada_notificacion_id.length]}):null})()]}),e.jsx("button",{className:"btn btn-sm btn-redUi1 text-white ms-3",onClick:()=>p(_.id,V,H.dominio,"vehiculo"),children:e.jsx("i",{className:"bi bi-trash"})})]},V)})]}):e.jsx("span",{className:"text-danger text-center d-block"})]})," "]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center my-3 mx-4",children:[e.jsx("small",{className:"text-muted",children:new Date(((P=_.timestamp)==null?void 0:P.seconds)*1e3).toLocaleString()}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("div",{className:"position-relative d-inline-block",children:[e.jsx("button",{className:"btn btn-greenUi text-white btn-sm rounded-circle",onClick:()=>d(_.id),title:"Asociar Buscados",children:e.jsx("i",{className:"bi bi-cash-coin"})}),_.buscados_asociados&&((U=Object.keys(_.buscados_asociados))==null?void 0:U.length)>0&&e.jsxs("span",{className:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-secondary",style:{fontSize:"0.7rem"},children:[Object.keys(_.buscados_asociados).length,e.jsx("span",{className:"visually-hidden",children:"buscados asociados"})]})]}),e.jsxs("div",{className:"position-relative d-inline-block",children:[e.jsx("button",{className:"btn btn-orangeDb text-white btn-sm rounded-circle",onClick:()=>o(_.id),title:"Asociar Vehículos",children:e.jsx("i",{className:"bi bi-car-front"})}),_.vehiculos_asociados&&((K=Object.keys(_.vehiculos_asociados))==null?void 0:K.length)>0&&e.jsxs("span",{className:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-secondary",style:{fontSize:"0.7rem"},children:[Object.keys(_.vehiculos_asociados).length,e.jsx("span",{className:"visually-hidden",children:"vehículos asociados"})]})]}),e.jsxs("div",{className:"position-relative d-inline-block",children:[e.jsx("button",{className:"btn btn-cyan text-white btn-sm rounded-circle",onClick:()=>g(_.id),title:"Asociar Personas",children:e.jsx("i",{className:"bi bi-person-fill-add"})}),_.personas_asociadas&&((G=Object.keys(_.personas_asociadas))==null?void 0:G.length)>0&&e.jsxs("span",{className:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-secondary",style:{fontSize:"0.7rem"},children:[Object.keys(_.personas_asociadas).length,e.jsx("span",{className:"visually-hidden",children:"Personas asociadas"})]})]}),e.jsxs("div",{className:"position-relative d-inline-block",children:[e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle",onClick:()=>x(_.id),title:"Asociar Enlaces",children:e.jsx("i",{className:"bi bi-link-45deg"})}),((A=_.enlace)==null?void 0:A.length)>0&&e.jsxs("span",{className:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-secondary",style:{fontSize:"0.7rem"},children:[_.enlace.length,e.jsx("span",{className:"visually-hidden",children:"Enlaces asociados"})]})]}),e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:()=>m(_.id),disabled:j,title:"Eliminar Notificación",children:e.jsx("i",{className:"bi bi-trash3-fill"})})]})]})]},_.id)})})},nr=({showModal:s,cerrarModal:l,selectedVehiculo:t,setSelectedVehiculo:n,searchQuery:i,setSearchQuery:r,vehiculos:o,asociarVehiculo:d,loading:g})=>{const[x,m]=a.useState(!1),j=async()=>{try{m(!0),await d(),n(null),r(""),l(!1)}finally{m(!1)}};return e.jsx("div",{className:`modal fade bg-dark ${s?"show d-block":""}`,tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!s,style:{backgroundColor:"rgba(0,0,0,0.5)"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content p-3 bg-gradient rounded-4 shadow-lg border-0",children:[e.jsxs("div",{className:"modal-header border-0 text-dark",children:[e.jsx("h5",{className:"modal-title",id:"modalLabel",children:"Asociar Vehículo a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>{n(null),r(""),l(!1)},"aria-label":"Cerrar",disabled:g})]}),e.jsxs("div",{className:"modal-body bg-light rounded-4 p-4 shadow-sm",children:[t&&e.jsxs("div",{className:"alert alert-primary d-flex align-items-center mb-4 rounded-4 shadow-sm",children:[e.jsx("i",{className:"bi bi-car-front-fill fs-4 me-2"}),e.jsx("strong",{className:"mb-0 titilar",children:"Seleccionado:"}),e.jsxs("span",{className:"ms-2",children:[t.dominio," - ",t.marca,"  ",t.modelo]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-primary ms-auto",onClick:()=>n(null),"aria-label":"Quitar selección",children:e.jsx("i",{className:"bi bi-x-lg"})})]}),e.jsx("label",{htmlFor:"vehiculo",className:"form-label fw-semibold text-dark",children:"Buscar Dominio o Marca/Modelo:"}),e.jsxs("div",{className:"d-flex mb-3",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: ABC123 o Toyota Corolla",value:i,onChange:u=>r(u.target.value),disabled:g}),e.jsx("button",{className:"btn btn-outline-danger ms-2",onClick:()=>r(""),disabled:!i||g,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash"})})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"fw-bold text-start mb-2",children:"Resultados:"}),e.jsx("ul",{className:"list-group mb-3",style:{maxHeight:"180px",overflowY:"auto"},"aria-live":"polite",children:o.filter(u=>`${u.dominio} ${u.marca} ${u.modelo}`.toLowerCase().includes(i.toLowerCase())).map(u=>{var p;return e.jsxs("li",{className:"list-group-item d-flex align-items-center gap-3",onClick:()=>{n(u),r("")},style:{cursor:"pointer"},tabIndex:0,onKeyDown:c=>{c.key==="Enter"&&(n(u),r(""))},children:[e.jsx("i",{className:"bi bi-car-front-fill fs-3 text-primary"}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsxs("p",{className:"mb-0 fw-semibold",children:[u.marca," ",u.modelo]}),e.jsx("small",{className:"text-muted",children:u.dominio||"SIN DOMINIO"})]}),e.jsx("span",{className:`badge rounded-pill border border-white border-2 ${u.tipo==="moto"?"bg-teal":u.tipo==="auto"?"bg-primary":"bg-warning text-dark"}`,children:((p=u.tipo)==null?void 0:p.toUpperCase())||"SIN TIPO"})]},u.id)})})]}),e.jsx("label",{className:"form-label fw-semibold text-dark",children:"Buscar en lista:"}),e.jsxs("div",{className:"dropdown mb-3",children:[e.jsx("button",{className:"btn btn-light dropdown-toggle w-100 text-truncate",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:g,children:t?`${t.marca} ${t.modelo}`:"Selecciona un vehículo"}),e.jsx("ul",{className:"dropdown-menu w-100","aria-labelledby":"dropdownMenuButton",style:{maxHeight:"250px",overflowY:"auto"},children:o.map(u=>{var p;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",type:"button",onClick:()=>n(u),children:[e.jsx("i",{className:"bi bi-car-front-fill fs-3 text-primary"}),e.jsxs("div",{className:"flex-grow-1 text-truncate",children:[u.dominio," - ",u.marca," ",u.modelo]}),e.jsx("span",{className:`badge rounded-pill border border-white border-2 ${u.tipo==="moto"?"bg-teal":u.tipo==="auto"?"bg-primary":"bg-pink"}`,children:((p=u.tipo)==null?void 0:p.toUpperCase())||"SIN TIPO"})]})},u.id)})})]})]}),e.jsxs("div",{className:"modal-footer border-0 pt-0",children:[e.jsx("button",{type:"button",className:"btn btn-primary d-flex align-items-center gap-2",onClick:j,disabled:g||x||!t,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),e.jsx("span",{children:"Asociando..."})]}):e.jsxs(e.Fragment,{children:["Asociar Vehículo ",e.jsx("i",{className:"bi bi-car-front-fill"})]})}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{n(null),r(""),l(!1)},disabled:g||x,children:"Cerrar"})]})]})})})},or=({showModal:s,cerrarModal:l,selectedPersona:t,setSelectedPersona:n,searchQuery:i,setSearchQuery:r,personas:o,asociarCaptura:d,loading:g})=>{const[x,m]=a.useState(!1),j=async()=>{try{m(!0),await d(),n(null),r(""),l(!1)}finally{m(!1)}};return e.jsx("div",{className:`modal fade bg-dark ${s?"show d-block":""}`,tabIndex:"-1","aria-labelledby":"modalLabel","aria-hidden":!s,style:{backgroundColor:"rgba(0,0,0,0.5)"},children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content p-3 bg-gradient rounded-4 shadow-lg border-0 ",children:[e.jsxs("div",{className:"modal-header border-0 text-dark",children:[e.jsx("h5",{className:"modal-title",id:"modalLabel",children:"Asociar Buscados SF a la Notificación"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>{n(null),r(""),l(!1)},"aria-label":"Cerrar",disabled:g})]}),e.jsxs("div",{className:"modal-body bg-light rounded-4 p-4 shadow-sm",children:[t&&e.jsxs("div",{className:"alert alert-primary d-flex align-items-center mb-4 rounded-4 shadow-sm",children:[e.jsx("i",{className:"bi bi-person-check-fill fs-4 me-2"}),e.jsx("strong",{className:"mb-0",children:"Seleccionado:"}),e.jsx("span",{className:"ms-2",children:t.nombre_apellido}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-primary ms-auto",onClick:()=>n(null),"aria-label":"Quitar selección",children:e.jsx("i",{className:"bi bi-x-lg"})})]}),e.jsx("label",{htmlFor:"persona",className:"form-label fw-semibold text-dark",children:"Buscar DNI o Nombre:"}),e.jsxs("div",{className:"d-flex mb-3",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Ej: Juan Pérez o 12345678",value:i,onChange:u=>r(u.target.value),disabled:g}),e.jsx("button",{className:"btn btn-outline-danger ms-2",onClick:()=>r(""),disabled:!i||g,"aria-label":"Limpiar búsqueda",children:e.jsx("i",{className:"bi bi-trash"})})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"fw-bold text-start mb-2",children:"Resultados:"}),e.jsx("ul",{className:"list-group mb-3",style:{maxHeight:"180px",overflowY:"auto"},"aria-live":"polite",children:o.filter(u=>`${u.nombre_apellido} ${u.documento}`.toLowerCase().includes(i.toLowerCase())).map(u=>{var p;return e.jsxs("li",{className:"list-group-item d-flex align-items-center gap-3",onClick:()=>{n(u),r("")},style:{cursor:"pointer"},tabIndex:0,onKeyDown:c=>{c.key==="Enter"&&(n(u),r(""))},children:[e.jsx("img",{src:((p=u.base64)==null?void 0:p.trim())||"defaultSvgUrl",alt:u.nombre_apellido,className:"rounded-circle",style:{width:"45px",height:"45px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("p",{className:"mb-0 fw-semibold",children:u.nombre_apellido}),e.jsx("small",{className:"text-muted",children:u.documento})]}),e.jsx("span",{className:`badge rounded-pill border border-white border-2 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[u.prioridad]||"bg-warning text-dark"}`,children:Ke(u.prioridad)})]},u.id)})})]}),e.jsx("label",{htmlFor:"dropdownMenuButton",className:"form-label fw-semibold text-dark",children:"Buscar en lista:"}),e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{className:"btn btn-light dropdown-toggle w-100 text-truncate",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false",disabled:g,children:t?t.nombre_apellido:"Selecciona una persona"}),e.jsx("ul",{className:"dropdown-menu w-100","aria-labelledby":"dropdownMenuButton",style:{maxHeight:"250px",overflowY:"auto"},children:o.map(u=>{var p;return e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item d-flex align-items-center gap-2",onClick:()=>n(u),type:"button",children:[e.jsx("img",{src:((p=u.base64)==null?void 0:p.trim())||"imagen",alt:u.nombre_apellido,className:"rounded-circle",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsxs("div",{className:"flex-grow-1 text-truncate",children:[u.nombre_apellido," - ",u.documento]}),e.jsx("span",{className:`badge rounded-pill border border-white border-2 ${{1:"bg-teal",2:"bg-primaryMuiBlue",3:"bg-danger"}[u.prioridad]||"bg-warning text-dark"}`,children:Ke(u.prioridad)})]})},u.id)})})]})]}),e.jsxs("div",{className:"modal-footer border-0 pt-0",children:[e.jsx("button",{type:"button",className:"btn btn-primary d-flex align-items-center gap-2",onClick:j,disabled:g||x||!t,children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),e.jsx("span",{children:"Asociando..."})]}):e.jsxs(e.Fragment,{children:["Asociar Persona ",e.jsx("i",{className:"bi bi-person-plus-fill"})]})}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{n(null),r(""),l(!1)},disabled:g||x,children:"Cerrar"})]})]})})})};function cr(){const[s,l]=a.useState([]),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState([]),[g,x]=a.useState(!1),[m,j]=a.useState(!1),[u,p]=a.useState(!1),[c,b]=a.useState(!1),[h,f]=a.useState(null),[v,N]=a.useState(null),[S,k]=a.useState(null),[y,w]=a.useState(""),[C,E]=a.useState(""),[F,_]=a.useState(""),[I,P]=a.useState(!1),[U,K]=a.useState(""),[G,A]=a.useState(""),[V,H]=a.useState(""),[Z,z]=a.useState("desc"),[R,J]=a.useState(""),[ne,me]=a.useState(!1),he=Y=>{if(Y!=null&&Y.asociada_notificacion_id&&Array.isArray(Y.asociada_notificacion_id)){const ue=Y.asociada_notificacion_id.map((xe,pe)=>`🔹 ${pe+1}. ${xe}`).join(`
`);alert(`📌 Notificaciones asociadas  ${Y.nombre_apellido||""}:

${ue}`)}else alert(`❌ ${Y.nombre_apellido||"Esta persona"} no tiene notificaciones asociadas.`)},ae=Y=>{z(Y.target.value),T(Y.target.value)},T=(Y,ue)=>{let xe=[...s];Y==="asc"?xe.sort((pe,ge)=>{var Le,Ce;return((Le=pe.timestamp)==null?void 0:Le.seconds)-((Ce=ge.timestamp)==null?void 0:Ce.seconds)}):xe.sort((pe,ge)=>{var Le,Ce;return((Le=ge.timestamp)==null?void 0:Le.seconds)-((Ce=pe.timestamp)==null?void 0:Ce.seconds)}),l(xe)};a.useEffect(()=>{P(!0);const Y=_e(W(D,"db_notificaciones"),Be("timestamp","desc")),ue=He(Y,xe=>{const pe=xe.docs.map(ge=>({id:ge.id,...ge.data()}));l(pe),P(!1)},xe=>{console.error("Error al obtener notificaciones:",xe),P(!1)});return()=>ue()},[]),a.useEffect(()=>{(async()=>{const ue=_e(W(D,"db_buscados"),Be("nombre_apellido","asc")),pe=(await re(ue)).docs.map(ge=>({id:ge.id,...ge.data()}));r(pe)})()},[]),a.useEffect(()=>{(async()=>{const ue=_e(W(D,"db_personas"),Be("nombre_apellido","asc")),pe=(await re(ue)).docs.map(ge=>({id:ge.id,...ge.data()}));n(pe)})()},[]),a.useEffect(()=>{(async()=>{const ue=_e(W(D,"db_vehiculos"),Be("dominio","asc")),pe=(await re(ue)).docs.map(ge=>({id:ge.id,...ge.data()}));d(pe)})()},[]);const L=async(Y,ue)=>{try{if(!window.confirm("¿Desea eliminar este enlace?"))return;const pe=B(D,"db_notificaciones",ue),ge=await De(pe);if(ge.exists()){const Le=ge.data();if(Array.isArray(Le.enlace)){const Ce=Le.enlace.filter((ze,qe)=>qe!==Y);await le(pe,{enlace:Ce}),alert("Enlace eliminado con exito ")}else alert("El campo 'enlace' no existe o no es un array.")}else alert("No se encontró el documento con el ID proporcionado.")}catch(xe){alert.error("Error al eliminar el enlace:",xe)}},Q=async Y=>{if(window.confirm("¿Estás seguro de que deseas eliminar esta notificación?")){P(!0);try{const xe=B(D,"db_notificaciones",Y),pe=await De(xe);if(pe.exists()){const ge=pe.data();await Ne(B(D,"db_notificaciones_desactivados",Y),{...ge,desactivadoEn:new Date}),await je(xe),l(Le=>Le.filter(Ce=>Ce.id!==Y)),alert("Se eliminó la notificación y se archivó en desactivados.")}else alert("No se encontró la notificación para eliminar.")}catch(xe){console.error("Error al eliminar la notificación:",xe),alert("Hubo un error al eliminar la notificación.")}finally{P(!1)}}},X=Y=>{f(Y),p(!0)},se=Y=>{f(Y),x(!0)},M=Y=>{f(Y),j(!0)},ee=()=>{x(!1),f(null),w("")},te=Y=>{f(Y),b(!0)},$=async()=>{if(!h||!y){alert("Por favor, selecciona una persona para asociar.");return}try{const Y=y.id,{base64:ue,...xe}=y;await Promise.all([le(B(D,"db_notificaciones",h),{[`personas_asociadas.${Y}`]:{...xe,id:Y,asociadoEn:new Date}}),le(B(D,"db_personas",Y),{asociada_notificacion_id:Me(h)})]),alert(`La persona ${y.nombre_apellido} se asoció a la notificación.`),w(null),J(""),ee(!1)}catch(Y){console.error("Error al asociar persona:",Y),alert("Hubo un error al asociar la persona.")}},ie=async()=>{if(!h||!C){alert("Por favor, selecciona un buscado para asociar.");return}try{const Y=C.id,{base64:ue,...xe}=C;await Promise.all([le(B(D,"db_notificaciones",h),{[`buscados_asociados.${Y}`]:{...xe,id:Y,asociadoEn:new Date}}),le(B(D,"db_buscados",Y),{asociada_notificacion_id:Me(h)})]),alert(`La persona ${C.nombre_apellido} se asoció a la notificación.`),E(null),J(""),ee(!1)}catch(Y){console.error("Error al asociar persona:",Y),alert("Hubo un error al asociar la persona.")}},q=async()=>{if(h&&F)try{const Y=_e(W(D,"db_vehiculos"),Oe("dominio","==",F.dominio)),ue=await re(Y);if(ue.empty)alert("No se encontró el vehículo seleccionado.");else{const pe=ue.docs[0].id;await Promise.all([le(B(D,"db_notificaciones",h),{[`vehiculos_asociados.${F.id}`]:{...F,id:pe,asociadoEn:new Date}}),le(B(D,"db_vehiculos",pe),{asociada_notificacion_id:Me(h)})]),alert(`El vehículo ${F.dominio} se asoció a la notificación.`),ee(!1)}}catch(Y){console.error("Error al asociar vehículo:",Y),alert("Hubo un error al asociar el vehículo.")}else alert("Por favor, selecciona un vehículo para asociar.")},de=async(Y,ue,xe,pe="persona")=>{let ge="";switch(pe){case"persona":ge=`¿Estás seguro de que deseas eliminar la asociación de ${xe} con la notificación?`;break;case"vehiculo":ge=`¿Estás seguro de que deseas eliminar la asociación del vehículo  ${xe} con la notificación?`;break;case"buscado":ge=`¿Estás seguro de que deseas eliminar la asociación del buscado ${xe.nombre_apellido} con la notificación?`;break;case"link":ge=`¿Estás seguro de que deseas eliminar el enlace ${xe} de la notificación?`;break;default:alert("Tipo no reconocido.");return}if(!window.confirm(ge)){alert("La asociación no fue eliminada.");return}P(!0);try{const Ce=B(D,"db_notificaciones",Y);if(pe==="persona"){const ze=await De(Ce);if(ze.exists()){const Ue={...ze.data().personas_asociadas};delete Ue[ue],await le(Ce,{personas_asociadas:Ue})}const qe=B(D,"db_personas",ue);await le(qe,{asociada_notificacion_id:Ie(Y)}),alert(`Se eliminó la asociación de la persona ${xe} con la notificación.`)}else if(pe==="buscado"){const ze=await De(Ce);if(ze.exists()){const Ue={...ze.data().buscados_asociados};delete Ue[ue],await le(Ce,{buscados_asociados:Ue})}const qe=B(D,"db_buscados",ue);await le(qe,{asociada_notificacion_id:Ie(Y)}),alert(`Se eliminó la asociación del buscado ${xe} con la notificación.`)}else if(pe==="vehiculo"){const ze=await De(Ce);if(ze.exists()){const Ue={...ze.data().vehiculos_asociados};delete Ue[ue],await le(Ce,{vehiculos_asociados:Ue})}const qe=B(D,"db_vehiculos",ue);await le(qe,{asociada_notificacion_id:Ie(Y)})}else pe==="link"&&(await le(Ce,{enlace:Ie(xe)}),alert(`Se eliminó el enlace ${xe} de la notificación.`))}catch(Ce){console.error("Error al eliminar la asociación:",Ce),alert("Hubo un error al eliminar la asociación.")}finally{P(!1)}},O=Y=>{switch(Y){case"1":return"📢";case"2":return"🔎";case"3":return"👮🏻";case"4":return"⭐";default:return"No definida"}},ce=Y=>/^https?:\/\//.test(Y)?Y:`https://${Y}`,be=async Y=>{if(G.trim()){P(!0);try{const ue=B(D,"db_notificaciones",Y);await le(ue,{contenido:G}),alert("Contenido actualizado correctamente"),N(null)}catch(ue){console.error("Error al actualizar contenido:",ue),alert("Hubo un error al actualizar el contenido.")}finally{P(!1)}}else alert("El contenido no puede estar vacío")},Ae=async Y=>{if(V.trim()){P(!0);try{const ue=B(D,"db_notificaciones",Y);await le(ue,{titulo:V}),alert("titulo actualizado correctamente"),k(null)}catch(ue){console.error("Error al actualizar titulo:",ue),alert("Hubo un error al actualizar el titulo.")}finally{P(!1)}}else alert("El titulo no puede estar vacío")};return e.jsxs("div",{children:[e.jsxs("div",{className:"row g-3 justify-content-center align-items-center mt-1 animate__animated  animate__slideInUp",children:[e.jsxs("div",{className:"container",children:[ne&&e.jsx(sa,{Date1:"Ninguno",Date2:"Desactivar Busqueda",onCerrar:()=>me(!1),color:"info"}),!ne&&e.jsx("div",{className:"d-flex justify-content-end mb-1  ",children:e.jsxs("button",{className:"btn  fw-semibold",onClick:()=>me(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 titilar text-light "})," ",e.jsx("small",{className:"text-light",children:"Ayuda"})]})})]}),e.jsxs("div",{className:"input-group mb-4",children:[e.jsx("span",{className:"input-group-text bg-light bg-opacity-50 text-white fw-bold",children:"Orden"}),e.jsxs("select",{className:"form-select bg-light bg-opacity-75 text-center border-0 ",id:"floatingSelectOrder",value:Z,onChange:ae,children:[e.jsx("option",{value:"desc",children:"📥 Más recientes primero"}),e.jsx("option",{value:"asc",children:"📤 Más antiguos primero"})]})]})]}),I?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx("i",{className:"bi bi-gear-fill text-white girar display-1"})}):e.jsx(rr,{notificaciones:s,personas:t,vehiculos:o,buscados:i,obtenerNombreCaratula:O,agregarProtocolo:ce,abrirModal:se,abrirModalLink:te,eliminarNotificacion:Q,loading:I,eliminarEnlace:L,eliminarAsociacion:de,mostrarNotificacionesAsociadas:he,selectedNotifIdContenido:v,contenidoEditado:G,setContenidoEditado:A,editarContenido:be,setSelectedNotifIdContenido:N,selectedNotifIdTitulo:S,setSelectedNotifIdTitulo:k,setTituloEditado:H,tituloEditado:V,editarTitulo:Ae,abrirModalVehiculo:X,abrirModalBuscados:M}),e.jsx(lr,{showModal:g,cerrarModal:ee,selectedPersona:y,setSelectedPersona:w,searchQuery:R,setSearchQuery:J,personas:t,asociarCaptura:$,loading:I}),e.jsx(or,{showModal:m,cerrarModal:j,selectedPersona:C,setSelectedPersona:E,searchQuery:R,setSearchQuery:J,personas:i,asociarCaptura:ie,loading:I}),e.jsx(nr,{showModal:u,cerrarModal:p,selectedVehiculo:F,setSelectedVehiculo:_,searchQuery:R,setSearchQuery:J,vehiculos:o,asociarVehiculo:q,loading:I}),e.jsx(ea,{showModalLink:c,setShowModalLink:b,selectedNotifId:h,setNewLink:K,newLink:U,setNotificaciones:l})]})}const dr=()=>{const[s,l]=a.useState(!1);return e.jsx(e.Fragment,{children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row g-4 align-items-start",children:[e.jsxs("div",{className:"col-12 col-md-6 text-white",children:[e.jsxs("div",{className:"p-4 bg-dark bg-opacity-50 rounded-4 shadow-lg my-4 text-center text-capitalize",children:[e.jsx("h1",{className:"fw-bold display-6 animate__animated animate__backInDown",children:"Nueva Notificación"}),e.jsx("p",{className:"lead text-white text-center mt-4 animate__rollIn animate__animated",children:"¿Querés registrar una nueva Notificación? Comenzá completando los datos necesarios para dar inicio al proceso."}),e.jsx("div",{className:"text-center mt-4 animate__animated  animate__slideInUp",children:e.jsx("button",{className:"btn btn-light fw-semibold px-4 ",onClick:()=>l(!0),children:"Nueva Notificación"})})]}),e.jsx(ir,{showModalNot:s,setShowModalNot:l}),e.jsx("div",{className:"mt-3 small d-flex flex-column align-items-end",children:e.jsxs("p",{className:"mb-0",children:["Soporte: ",e.jsx("a",{href:"mailto:ticsdesarrollo2024@gmail.com",className:"text-white text-decoration-underline",children:"ticsdesarrollo2024@gmail.com"})]})})]}),e.jsx("div",{className:"col-12 col-md-6",children:e.jsx(cr,{})})]})})})},mr=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Crear Notificación - Cx2"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5 ",children:[e.jsx(Fe,{Promp:"Crear Notificación ",Promp2:" bi bi-megaphone fs-4 "}),e.jsx("p",{})]}),e.jsx("div",{className:"my-5",children:e.jsx(dr,{})})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},ur=()=>e.jsx(e.Fragment,{children:e.jsx(mr,{})}),hr="/gif/dash6.gif",xr=()=>e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center  mt-5 text-light",children:[e.jsx("span",{className:"display-4 mb-2 animate__rotateIn animate__animated ",children:"¡Bienvenido a Buscados SF!"}),e.jsx("span",{className:"mb-5 ",children:"Este panel de control te permite gestionar buscados SF, ver estadísticas y configurar las opciones del sistema."}),e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-md-6 d-flex flex-column justify-content-center align-items-center mb-4 mb-md-0",children:[e.jsxs("p",{className:"text-center d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"bi bi-asterisk p-3 rounded-circle me-3 bg-dark bg-opacity-25"}),e.jsx("span",{className:"p-2 animate__animated animate__lightSpeedInRight ",children:"Desde aquí podrás administrar los recursos del sistema de forma fácil y eficiente."})]}),e.jsxs("p",{className:"text-center d-flex align-items-center justify-content-center",children:[e.jsx("i",{className:"bi bi-lightbulb  p-3 rounded-circle me-3 bg-dark bg-opacity-25"}),e.jsx("span",{className:"p-2 animate__animated animate__lightSpeedInRight ",children:"Ante cualquier inconveniente, no dudes en solicitar asistencia técnica."})]})]}),e.jsx("div",{className:"col-md-6 d-flex justify-content-center align-items-center",children:e.jsx("img",{src:hr,alt:"Panel de control gráfico",className:"img-fluid p-2 rounded-circle shadow",style:{maxWidth:"300px",height:"auto"}})})]})]}),br=({loading:s,buscados:l})=>{const[t,n]=a.useState([]),[i,r]=a.useState([]);a.useEffect(()=>{Array.isArray(l)&&l.length>0?n(l):n([])},[l]);const o=["captura","date","descripcion_fisica","documento","entidad","motivo_captura","nombre_apellido","montoRecompensa","sexo","usuario"],d={captura:"Captura",date:"Fecha",descripcion_fisica:"Datos de la Persona",documento:"Documento",entidad:"Entidad",motivo_captura:"Motivo de Captura",nombre_apellido:"Nombre y Apellido",montoRecompensa:"Monto Recompensa",sexo:"Sexo",usuario:"Usuario"},g=u=>{r(p=>p.includes(u)?p.filter(c=>c!==u):[...p,u])},x=()=>r(o),m=()=>r([]),j=()=>{if(t.length===0||i.length===0)return;const u=t.map(b=>{const h={};return i.forEach(f=>{h[d[f]||f]=b[f]??""}),h}),p=ye.json_to_sheet(u),c=ye.book_new();ye.book_append_sheet(c,p,"Datos Seleccionados Buscados SF"),Ge(c,"Datos_Seleccionados_Buscados_SF.xlsx")};return e.jsx(e.Fragment,{children:s?e.jsx(oe,{leyendaSet:"Exportar - Cx2"}):e.jsx("div",{className:"container-lg mt-5 mt-md-0 text-white",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column text-center",children:[e.jsxs("span",{className:"mb-4 display-5",children:["Exportar Datos ",e.jsx("i",{className:"bi bi-filetype-xml"})]}),e.jsx("h5",{className:"mb-5 fw-light",children:"Selecciona los campos que deseas incluir en la exportación."}),e.jsxs("div",{className:"d-flex justify-content-center mb-4 flex-wrap gap-2",children:[e.jsx("button",{className:"btn btn-outline-light",onClick:x,children:"Seleccionar todos"}),e.jsx("button",{className:"btn btn-outline-light",onClick:m,children:"Limpiar selección"})]}),e.jsx("form",{className:"mb-4 w-100 px-3",children:e.jsx("div",{className:"row p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg border border-1",children:o.map(u=>e.jsx("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3 mb-3",children:e.jsxs("div",{className:"form-check w-100 d-flex align-items-center",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:u,value:u,onChange:()=>g(u),checked:i.includes(u)}),e.jsx("label",{className:"form-check-label ms-2",htmlFor:u,children:d[u]||u})]})},u))})}),i.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("button",{className:"btn bg-green bg-opacity-50 text-white fw-semibold",onClick:j,children:["Descargar datos seleccionados"," ",e.jsx("i",{className:"bi bi-file-earmark-arrow-down-fill ms-2"})]})})]})})})},ba=({data1:s,data2:l})=>{var u;const[t,n]=a.useState(!1),i=()=>n(!0),r=()=>n(!1),[o,d]=a.useState(""),x=(()=>{const p=localStorage.getItem("user");return p?JSON.parse(p):null})(),m=async p=>{if(window.confirm("¿Estás seguro de que deseas eliminar esta persona?"))try{const c=B(D,"db_buscados_desactivados",p.id),b=new Date,h=`${b.getDate().toString().padStart(2,"0")}/${(b.getMonth()+1).toString().padStart(2,"0")}/${b.getFullYear().toString().slice(-2)}`;await Ne(c,{...p,usuario_baja:x.email||"usuario_desconocido",usuario_baja_fecha:h});const f=B(D,"db_buscados",p.id);await je(f),l(),d("Persona eliminada y copiada a la colección de desactivados."),setTimeout(()=>d(""),3e3)}catch(c){console.error("Error al eliminar persona: ",c),d("Error al eliminar la persona. Inténtalo de nuevo."),setTimeout(()=>d(""),3e3)}},j=p=>{m(p),r()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-trash3-fill"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("h5",{className:"modal-title ",children:"Eliminar Persona"}),e.jsx("button",{type:"button",className:"btn-close ",onClick:r})]}),"  ",e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(u=s.base64)==null?void 0:u.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-danger  bg-redW rounded p-1",children:["      ",e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas eliminar esta persona?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:()=>{j(s)},children:"Confirmar Eliminación"})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},pr=({data1:s,data2:l})=>{const[t,n]=a.useState(!1),i=()=>n(!0),r=()=>n(!1),[o,d]=a.useState(!1),[g,x]=a.useState(s.descripcion_fisica),[m,j]=a.useState(s.documento),[u,p]=a.useState(s.entidad),[c,b]=a.useState(s.motivo_captura),[h,f]=a.useState(s.nombre_apellido),[v,N]=a.useState(s.prioridad),[S,k]=a.useState(s.sexo),[y,w]=a.useState(s.numero_contacto),[C,E]=a.useState(s.base64),[F,_]=a.useState("edicion desde menu de capturas"),[I,P]=a.useState(s.paradero),[U,K]=a.useState(s.alerta),[G,A]=a.useState(s.montoRecompensa||""),[V,H]=a.useState(!1),[Z,z]=a.useState(!1),[R,J]=a.useState(!1),ne=()=>{const M={nombre_apellido:h,documento:m,sexo:S,descripcion_fisica:g,entidad:u,motivo_captura:c,numero_contacto:y,prioridad:v,alerta:U,paradero:I,montoRecompensa:G};return["nombre_apellido","documento","sexo","descripcion_fisica","entidad","motivo_captura","numero_contacto","prioridad","alerta","paradero","montoRecompensa"].filter(te=>M[te]!==s[te])},me=()=>H(M=>!M),he=()=>z(M=>!M),ae=()=>J(M=>!M),T=M=>{const ee=M.target.files[0];if(ee){const te=new FileReader;te.onloadend=()=>E(te.result),te.readAsDataURL(ee)}else alert("Por favor, selecciona un archivo de imagen válido.")},Q=(()=>{const M=localStorage.getItem("user");return M?JSON.parse(M):null})(),X=async()=>{const M=G===""?null:Number(G),ee=B(D,"db_buscados",s.id),te=ne();try{d(!0);const $=new Date,ie=`${$.getDate().toString().padStart(2,"0")}/${($.getMonth()+1).toString().padStart(2,"0")}/${$.getFullYear().toString().slice(-2)}`;await le(ee,{descripcion_fisica:g,documento:m,entidad:u,motivo_captura:c,nombre_apellido:h,prioridad:v,sexo:S,numero_contacto:y,alerta:U,base64:C,paradero:I,montoRecompensa:M,ediciones:F.trim()?[...s.ediciones||[],{motivo:F,usuario:(Q==null?void 0:Q.email)||"usuario_desconocido",fecha:ie,campos:te}]:s.ediciones||[]}),l(),alert("Los cambios se han guardado correctamente.")}catch($){console.error("Error al actualizar la persona: ",$),alert("Error al guardar los cambios. Inténtalo de nuevo.")}finally{d(!1)}},se=M=>{const ee=parseInt(M.target.value,10);N(ee),ee===2?(P(!0),K(!1)):ee===1?(P(!1),K(!1)):ee===3?(K(!0),P(!1)):ee===4&&(P(!1),K(!1))};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-primary text-white btn-sm rounded-circle m-1",onClick:i,children:e.jsx("i",{className:"bi bi-pen"})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("img",{src:"img/asistente.gif",alt:"Asistente",style:{width:"60px",height:"60px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border"}),e.jsx("h5",{className:"modal-title mx-4",children:"Asistente de Edición"}),e.jsx("button",{type:"button",className:"btn-close",onClick:r})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:`col-3 mt-3 d-flex align-items-center ${V?"titilar":""}`,children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},onClick:me,children:[e.jsx("img",{src:C||"https://via.placeholder.com/40",alt:(C==null?void 0:C.nombre_apellido)||"Imagen no disponible",className:"img-fluid rounded-circle shadow-sm",style:{width:"100px",height:"auto",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:V?"Editando":"Editar"})]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end ",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"text",className:"form-control",value:h,onChange:M=>f(M.target.value)}),e.jsx("label",{className:" badgefw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{type:"number",className:"form-control",value:m,onChange:M=>j(M.target.value)}),e.jsx("label",{className:" fw-semibold opacity-75",children:"Documento"})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select text-center",value:S,onChange:M=>k(M.target.value),children:[e.jsx("option",{value:"",children:"Seleccione una Opción"}),e.jsx("option",{value:"masculino",children:"Masculino 👨"}),e.jsx("option",{value:"femenino",children:"Femenino 👩"}),e.jsx("option",{value:"otros",children:"Otros 👭🏻"})]}),e.jsx("label",{className:" fw-semibold opacity-75",children:"Sexo"})]})})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2",children:"Monto de Recompensa 💰"})}),e.jsx("input",{type:"number",className:"form-control bg-blueW2",value:G,onChange:M=>A(M.target.value),placeholder:"Ej: 50000"})]})}),e.jsxs("div",{className:"btn-group mt-3",role:"group","aria-label":"Basic example",children:[e.jsx("button",{type:"button",className:`btn btn-secondaryM text-white ${R?"titilar":""}`,onClick:ae,children:R?e.jsx(e.Fragment,{children:"Editando Datos de Captura "}):"Datos de Captura"}),e.jsx("button",{type:"button",className:`btn btn-primary text-white ${Z?"titilar":""}`,onClick:he,children:Z?e.jsx(e.Fragment,{children:"Editando Descripciones"}):"Descripciones"})]}),V&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 ",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Editar Fotografía ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:me})}),e.jsxs("div",{className:"my-3 text-center text-purple",children:[e.jsx("input",{type:"file",className:"form-control",onChange:T}),C&&e.jsx("img",{src:C,alt:"Imagen previa",className:"img-fluid mt-5",style:{maxWidth:"300px"}})]})]})]}),R&&e.jsxs("div",{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end  mt-4",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Datos de la Captura ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-2 text-center",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:ae})}),e.jsx("span",{className:"badge text-bg-secondaryM text-white me-2 ",children:"Atención "}),e.jsxs("small",{children:["La prioridad ",e.jsx("strong",{children:"modifica el contexto"})," de la captura"]})]}),e.jsxs("div",{className:"form-floating ",children:[e.jsxs("select",{className:"form-select text-center shadow-sm border border-secondaryM mb-3  border-opacity-50 ",disabled:!0,value:v,onChange:se,children:[e.jsx("option",{value:"",children:"Seleccione una Opción"}),e.jsx("option",{value:"1",children:"Normal"}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 🚨"}),e.jsx("option",{value:"4",children:"Prioridad ⭐"})]}),e.jsx("label",{className:"fw-semibold opacity-75 ms-2",children:"Prioridad"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Entidad que solicita captura"})}),e.jsx("input",{className:"form-control bg-blueW2",value:u,onChange:M=>p(M.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Numero de Contacto Entidad "})}),e.jsx("input",{className:"form-control bg-blueW2",value:y,onChange:M=>w(M.target.value)})]})]}),Z&&e.jsxs("div",{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end  mt-4",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM  "}),"Descripciones ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn-close mt-1","aria-label":"Close",onClick:he})}),e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-secondary me-2 ",children:"Descripción Fisica "})}),e.jsx("textarea",{className:"form-control bg-blueW2",value:g,onChange:M=>x(M.target.value),style:{minHeight:"160px"}})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-secondary me-2 ",children:"Motivo Captura "})}),e.jsx("textarea",{className:"form-control bg-blueW2",value:c,onChange:M=>b(M.target.value),style:{minHeight:"150px"}})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:r,children:e.jsx("i",{className:"bi bi-x-circle"})}),e.jsx("button",{className:"btn btn-primary text-white btn-sm rounded-circle",onClick:X,disabled:o,children:o?e.jsx("i",{className:"bi bi-floppy2 titilar"}):e.jsx("i",{className:"bi bi-floppy2"})})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},pa=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n,fetchBuscados:i})=>{const[r,o]=a.useState(!1),[d,g]=a.useState(""),[x,m]=a.useState(!1),j=()=>o(!0),u=()=>o(!1),p=()=>{n([])},b=(()=>{const f=localStorage.getItem("user");return f?JSON.parse(f):null})(),h=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas copiar estas personas a la colección de desactivados?"))){m(!0);try{const N=l.filter(S=>s.includes(S.id)).map(async S=>{const k=W(D,"db_buscados_desactivados"),y=new Date,w=`${y.getDate().toString().padStart(2,"0")}/${(y.getMonth()+1).toString().padStart(2,"0")}/${y.getFullYear().toString().slice(-2)}`;await Pe(k,{...S,usuario_baja:(b==null?void 0:b.email)||"usuario_desconocido",usuario_baja_fecha:w});const C=B(D,"db_buscados",S.id);await je(C)});await Promise.all(N),g("Personas copiadas a la colección de desactivados y eliminadas de la colección original."),i(),p()}catch(v){console.error("Error al eliminar personas:",v),g("Hubo un error al copiar o eliminar algunas personas.")}setTimeout(()=>g(""),3e3),m(!1),u()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-danger text-white btn-sm rounded-circle",onClick:j,disabled:x,children:e.jsx("i",{className:"bi bi-trash3-fill"})})}),r&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Eliminar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:u})]}),e.jsx("hr",{className:"border border-red border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-redW p-2 rounded-pill text-secondaryMuiRed fw-bold",children:["Se eliminarán ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(f=>s.includes(f.id)).map(f=>{var v;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(v=f.base64)==null?void 0:v.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),f.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(N=>N.filter(S=>S!==f.id)),title:"Quitar de la selección"})]},f.id)})}),e.jsxs("p",{className:"text-danger text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas eliminar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:u,children:"Cancelar"}),e.jsx("button",{className:"btn btn-danger text-white",onClick:h,disabled:x,children:x?"Eliminando...":"Confirmar Eliminación"})]})]})})}),r&&e.jsx("div",{className:"modal-backdrop fade show"}),d&&e.jsx("div",{className:"alert alert-success mt-2",children:d})]})},Fs=({Date1:s,Date2:l,setSelectedDocs:t,onCerrar:n,color:i})=>e.jsxs("div",{className:`card bg-${i} shadow my-4 position-relative text-dark d-flex align-items-start gap-3 p-4 card text-center p-2 bg-dark bg-opacity-75 rounded-4 shadow-lg`,style:{overflow:"visible"},children:[e.jsx("button",{type:"button",className:"btn-close position-absolute top-0 end-0 m-2","aria-label":"Cerrar",onClick:n}),e.jsx("img",{src:"img/Perfiles/9.png",alt:"Asistente",className:" position-absolute",style:{width:"120px",height:"200px",objectFit:"contain",top:"-30px",left:"-20px"}}),e.jsxs("div",{className:"w-100",style:{paddingLeft:"130px"},children:[e.jsx("h5",{children:e.jsx("strong",{children:"Asistente de Selección"})}),e.jsxs("p",{className:"mb-3",children:["Personas Seleccionadas: ",e.jsxs("strong",{children:[s.length," 🧑"]})]}),e.jsx("strong",{children:s.length>0?e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-start p-2 rounded mb-3  ",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(r=>s.includes(r.id)).map(r=>{var o;return e.jsxs("div",{className:"badge text-dark shadow d-flex align-items-center p-2 mx-2 position-relative bg-light bg-opacity-50 m-1",style:{fontSize:"0.75rem"},children:[e.jsx("img",{src:(o=r.base64)==null?void 0:o.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),r.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>t(d=>d.filter(g=>g!==r.id)),title:"Quitar de la selección"})]},r.id)})}):e.jsx("span",{className:"text-danger",children:"Ninguna"})})]})]}),Ds=({searchTerm:s,setSearchTerm:l})=>e.jsxs("div",{className:"form-floating mb-3 position-relative  ",children:[e.jsx("input",{type:"text",className:"form-control  shadow-sm pe-5 bg-dark bg-opacity-50 text-light",placeholder:"Buscar por nombre",value:s,onChange:t=>l(t.target.value)}),e.jsx("label",{children:"Buscar por Nombre"}),s&&e.jsx("button",{type:"button",className:"btn btn-link position-absolute top-50 end-0 translate-middle-y pe-3 ",onClick:()=>l(""),"aria-label":"Cancelar búsqueda",children:e.jsx("i",{className:"bi bi-x-circle text-light "})})]}),ga=({prioridadFilter:s,setPrioridadFilter:l})=>e.jsxs("div",{className:"form-floating mb-3  ",children:[e.jsxs("select",{className:"form-select shadow-sm ","aria-label":"Floating label select example",value:s,onChange:t=>l(t.target.value),disabled:!0,children:[e.jsx("option",{value:"",children:"Todas las Prioridades"}),e.jsx("option",{value:"1",children:"Normal"}),e.jsx("option",{value:"2",children:"Paradero 🔎"}),e.jsx("option",{value:"3",children:"Evadido 🚨"}),e.jsx("option",{value:"4",children:"Prioritaria ⭐"})]}),e.jsx("label",{children:"Seleccione una Prioridad"})]}),As=({orden:s,setOrden:l})=>e.jsxs("div",{className:"form-floating",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Ordenar alfabéticamente",value:s,onChange:t=>l(t.target.value),children:[e.jsx("option",{value:"asc",children:"Orden A-Z"}),e.jsx("option",{value:"desc",children:"Orden Z-A"})]}),e.jsxs("label",{children:["Ordenar ",e.jsx("i",{className:"bi bi-alphabet"})]})]}),gr=({buscados:s,setBuscados:l,fetchBuscados:t})=>{const[n,i]=a.useState([]),[r,o]=a.useState([]),[d,g]=a.useState(!0),[x,m]=a.useState(""),[j,u]=a.useState(""),[p,c]=a.useState(!0),[b,h]=a.useState("asc");a.useEffect(()=>{s&&g(!1)},[s]);const f=k=>[...k].sort((y,w)=>b==="asc"?y.nombre_apellido.localeCompare(w.nombre_apellido):w.nombre_apellido.localeCompare(y.nombre_apellido));a.useEffect(()=>{if(!s)return;const k=s.filter(w=>w.nombre_apellido&&w.nombre_apellido.toLowerCase().includes(x.toLowerCase())||w.documento&&w.documento.includes(x)).filter(w=>j?w.prioridad===parseInt(j,10):!0),y=f(k);i(y)},[x,s,j,b]);const v=k=>{o(y=>y.includes(k)?y.filter(w=>w!==k):[...y,k])},N=()=>{if(r.length===n.length)o([]);else{const k=n.map(y=>y.id);o(k)}},S=k=>{switch(Number(k)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});case 5:return e.jsx("span",{className:"badge bg-teal",children:"Buscado SF 👮🏻‍♂️ "});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}};return e.jsxs("div",{className:"container-lg text-white",children:[e.jsxs("div",{className:"row mt-5",children:[e.jsx("h1",{className:"text-center my-5 animate__animated animate__bounce mt-sm-0 mt-5",children:"Listado Buscados SF"}),e.jsx("div",{className:"col-12 col-sm-6 animate__lightSpeedInLeft animate__animated",children:e.jsx(Ds,{searchTerm:x,setSearchTerm:m})}),e.jsx("div",{className:"col-12 col-sm-4 animate__lightSpeedInLeft animate__animated",children:e.jsx(ga,{prioridadFilter:j,setPrioridadFilter:u})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(As,{orden:b,setOrden:h})})]}),d?e.jsx(oe,{}):e.jsx(e.Fragment,{children:n.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[r.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(pa,{data1:r,data2:s,setSelectedDocs:o,fetchBuscados:t}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>o([])})]}),p&&e.jsx(Fs,{Date1:r,Date2:s,setSelectedDocs:o,onCerrar:()=>c(!1),color:"blueW2"}),!p&&r.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>c(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-light"}),e.jsxs("small",{className:"text-light",children:["Ver Resumen (",e.jsxs("span",{className:"text-light",children:[r.length," 🧑"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5",children:e.jsxs("table",{className:"table table-striped table-hover text-center small rounded-pill ",children:[e.jsx("thead",{className:"table-info ",children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:r.length===n.length&&n.length>0,onChange:N})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Documento"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Prioridad"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:n.map(k=>{var y;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:r.includes(k.id),onChange:()=>v(k.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((y=k.base64)==null?void 0:y.trim())||"https://via.placeholder.com/40",alt:k.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize ",children:k.nombre_apellido})]})}),e.jsx("td",{className:"d-none d-sm-table-cell",children:k.documento}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:S(k.prioridad)}),e.jsxs("td",{children:[e.jsx(pr,{data1:k,data2:t}),e.jsx(ba,{data1:k,data2:t})]}),e.jsx("td",{})]},k.id)})})]})})]})})]})},jr=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n,fetchBuscados:i})=>{const[r,o]=a.useState(!1),[d,g]=a.useState(!1),x=()=>o(!0),m=()=>o(!1),j=()=>{n([])},p=(()=>{const b=localStorage.getItem("user");return b?JSON.parse(b):null})(),c=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas recuperar estas personas?"))){g(!0);try{const f=l.filter(v=>s.includes(v.id)).map(async v=>{const N=B(D,"db_buscados",v.id),S=new Date,k=`${S.getDate().toString().padStart(2,"0")}/${(S.getMonth()+1).toString().padStart(2,"0")}/${S.getFullYear().toString().slice(-2)}`;await Ne(N,{...v,recuperado:[...v.recuperado||[],{motivo:"recuperado manual",usuario:p.email,fecha:k,datos_resguardo_baja_previa:[{usuario_baja:v.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:v.usuario_baja_fecha||"fecha_no_disponible"}]}]});const y=B(D,"db_buscados_desactivados",v.id);await je(y)});await Promise.all(f),alert("Personas recuperadas y eliminadas de la colección de desactivados."),t(),i(),j()}catch(h){console.error("Error al recuperar personas:",h),alert("Hubo un error al recuperar o eliminar algunas personas.")}g(!1),m()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:x,disabled:d,children:e.jsx("i",{className:"bi bi-recycle"})})}),r&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-dark",children:"Recuperar Personas del Listado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:m})]}),e.jsx("hr",{className:"border border-teal border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"bg-greenW p-2 rounded-pill text-primary fw-bold",children:["Se reactivan ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(b=>s.includes(b.id)).map(b=>{var h;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(h=b.base64)==null?void 0:h.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),b.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(f=>f.filter(v=>v!==b.id)),title:"Quitar de la selección"})]},b.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas reactivar estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:m,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:c,disabled:d,children:d?"Recuperando...":"Confirmar Recuperación"})]})]})})}),r&&e.jsx("div",{className:"modal-backdrop fade show"})]})},fr=({data1:s,data2:l,dataRefresh:t})=>{var j;const[n,i]=a.useState(!1),r=()=>i(!0),o=()=>i(!1),g=(()=>{const u=localStorage.getItem("user");return u?JSON.parse(u):null})(),x=async u=>{if(window.confirm("¿Estás seguro de que deseas recuperar esta persona?"))try{const p=B(D,"db_buscados",u.id),c=new Date,b=`${c.getDate().toString().padStart(2,"0")}/${(c.getMonth()+1).toString().padStart(2,"0")}/${c.getFullYear().toString().slice(-2)}`,h="campos_modificados_aqui";await Ne(p,{...u,recuperado:[...u.recuperado||[],{motivo:"recuperado manual",usuario:g.email,fecha:b,datos_resguardo_baja_previa:[{usuario_baja:u.usuario_baja||"usuario_no_disponible",usuario_baja_fecha:u.usuario_baja_fecha||"fecha_no_disponible"}]}]});const f=B(D,"db_buscados_desactivados",u.id);await je(f),l(),t(),alert("Persona recuperada y copiada a la colección de capturas.")}catch(p){console.error("Error al eliminar persona: ",p)}},m=u=>{x(u),o()};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-teal text-white btn-sm rounded-circle m-1",onClick:r,children:e.jsx("i",{className:"bi bi-recycle"})}),n&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Recuperar Persona"}),e.jsx("button",{type:"button",className:"btn-close",onClick:o})]}),e.jsx("hr",{className:"border border-teal  border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("img",{src:(j=s.base64)==null?void 0:j.trim(),alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle mx-2",style:{width:"50px",height:"50px",objectFit:"cover"}}),e.jsx("strong",{children:"Nombre:"})," ",(s==null?void 0:s.nombre_apellido)||"NN"," - ",e.jsx("strong",{children:"DNI:"})," ",(s==null?void 0:s.documento)||"Sin documento"]}),e.jsxs("p",{className:"text-primary bg-greenW2 p-1",children:[e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas recuperar esta persona?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:o,children:"Cancelar"}),e.jsx("button",{className:"btn btn-teal text-white",onClick:()=>m(s),children:"Confirmar Recuperación"})]})]})})}),n&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Nr=({fetchBuscados:s})=>{const[l,t]=a.useState([]),[n,i]=a.useState([]),[r,o]=a.useState([]),[d,g]=a.useState(!0),[x,m]=a.useState(""),[j,u]=a.useState(""),[p,c]=a.useState(!0),[b,h]=a.useState("asc"),f=W(D,"db_buscados_desactivados"),v=async()=>{g(!0);try{const C=(await re(f)).docs.map(E=>({...E.data(),id:E.id}));t(C),i(C)}catch(w){console.error("Error al obtener personas: ",w)}finally{g(!1)}},N=w=>w.sort((C,E)=>b==="asc"?C.nombre_apellido.localeCompare(E.nombre_apellido):E.nombre_apellido.localeCompare(C.nombre_apellido));a.useEffect(()=>{v()},[]),a.useEffect(()=>{const w=l.filter(E=>E.nombre_apellido&&E.nombre_apellido.toLowerCase().includes(x.toLowerCase())||E.documento&&E.documento.includes(x)).filter(E=>j?E.prioridad===parseInt(j,10):!0),C=N(w);i(C)},[x,l,j,b]);const S=w=>{o(C=>C.includes(w)?C.filter(E=>E!==w):[...C,w])},k=()=>{if(r.length===n.length)o([]);else{const w=n.map(C=>C.id);o(w)}},y=w=>{switch(Number(w)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});case 5:return e.jsx("span",{className:"badge bg-teal",children:"Buscado SF 👮🏻‍♂️ "});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}};return e.jsxs("div",{className:"container-lg text-white ",children:[e.jsxs("div",{className:"row mt-5",children:[e.jsx("h1",{className:"text-center mb-5 animate__animated animate__bounce mt-sm-0  ",children:" Buscados SF  Desactivados"}),e.jsx("div",{className:"col-12 col-sm-6",children:e.jsx(Ds,{searchTerm:x,setSearchTerm:m})}),e.jsx("div",{className:"col-12 col-sm-4",children:e.jsx(ga,{prioridadFilter:j,setPrioridadFilter:u})}),e.jsx("div",{className:"col-12 col-sm-2",children:e.jsx(As,{orden:b,setOrden:h})})]}),d?e.jsx(oe,{}):e.jsx(e.Fragment,{children:n.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[r.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2  mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx(jr,{data1:r,data2:l,dataRefresh:v,setSelectedDocs:o,fetchBuscados:s}),e.jsx("button",{type:"button",className:"btn-close  btn-close-white mt-1","aria-label":"Close",onClick:()=>o([])})]}),p&&e.jsx(Fs,{Date1:r,Date2:l,setSelectedDocs:o,onCerrar:()=>c(!1),color:"blueW2"}),!p&&r.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>c(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-white"})," ",e.jsxs("small",{className:"text-white",children:["Ver Resumen ( ",e.jsxs("span",{className:"text-white",children:[r.length," 🧑"]}),")"]})]})})]}),e.jsx("div",{className:"table-responsive-sm mt-5",children:e.jsxs("table",{className:"table table-striped table-hover text-center small",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-light",children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:r.length===n.length,onChange:k})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"Documento"}),e.jsx("th",{className:"text-center d-none d-sm-table-cell",children:"Prioridad"}),e.jsx("th",{}),e.jsx("th",{})]})}),e.jsx("tbody",{children:n.map(w=>{var C;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:r.includes(w.id),onChange:()=>S(w.id)})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((C=w.base64)==null?void 0:C.trim())||"https://via.placeholder.com/40",alt:w.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize",children:w.nombre_apellido})]})}),e.jsx("td",{className:"d-none d-sm-table-cell",children:w.documento}),e.jsx("td",{className:"text-center d-none d-sm-table-cell",children:y(w.prioridad)}),e.jsx("td",{children:e.jsx(fr,{data1:w,data2:v,dataRefresh:s})}),e.jsx("td",{})]},w.id)})})]})})]})})]})},vr=({prioridadFilter:s,setPrioridadFilter:l,personas:t})=>{const n=[...new Set(t.map(i=>i.entidad))];return e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{className:"form-select shadow-sm","aria-label":"Floating label select example",value:s,onChange:i=>l(i.target.value),children:[e.jsx("option",{value:"",children:"Todas las Entidades"}),n.map((i,r)=>e.jsx("option",{value:i,children:i},r))]}),e.jsx("label",{children:"Seleccione una Entidad"})]})},yr=(s,l,t)=>s.filter(n=>{var i,r;return((i=n.nombre_apellido)==null?void 0:i.toLowerCase().includes(l.toLowerCase()))||((r=n.documento)==null?void 0:r.includes(l))}).filter(n=>!t||n.entidad===t),wr=(s,l)=>s.sort((t,n)=>l==="asc"?t.nombre_apellido.localeCompare(n.nombre_apellido):n.nombre_apellido.localeCompare(t.nombre_apellido)),Cr=(s,l)=>l?s.filter(t=>l==="capturado"?t.captura===!0:l==="evadido"?t.captura===!1:!0):s,Sr=(s,l,t,n)=>{s(""),l(""),t("asc"),n&&n("")},kr=({data1:s,data2:l})=>{const[t,n]=a.useState(!1),i=()=>n(!1),[r,o]=a.useState(!1),[d,g]=a.useState(""),[x,m]=a.useState(""),[j,u]=a.useState(""),c=(()=>{const v=localStorage.getItem("user");return v?JSON.parse(v):null})(),b=async()=>{if(window.confirm(`¿Estás seguro de que deseas ${j}?`)){o(!0);try{const v=B(D,"db_buscados",s.id),N=new Date,S=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`;await Ne(v,{...s,captura:!0,capturas_informacion_estados:[...s.capturas_informacion_estados||[],{captura_motivo:"informar captura",captura_informa_usuario:c.email,captura_fecha:S,captura_autor:x,captura_descripcion:d}]}),l(),o(!1),alert(`${j} realizado.`)}catch(v){console.error("Error al modificar persona: ",v),alert("Error al modificar la persona. Inténtalo de nuevo.")}}},h=()=>{n(!0),u("Informar Captura de Persona")},f=async()=>{if(window.confirm("¿Estás seguro de que deseas QUITAR EL ESTADO DE  CAPTURADO ?")){o(!0);try{const v=B(D,"db_personas",s.id),N=new Date,S=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`;await le(v,{...s,captura:!1,capturas_informacion_estados:[...s.capturas_informacion_estados||[],{captura_motivo:"quitar estado de captura",captura_quita_estado_usuario:c.email,captura_quita_fecha:S}]}),l(),alert("Captura quitada correctamente."),o(!1)}catch(v){console.error("Error al quitar la captura:",v),alert("No se pudo quitar la captura. Inténtalo de nuevo."),o(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsx("td",{className:s.captura?"bg-redW ":"",children:e.jsx("div",{className:"d-flex flex-column gap-1",children:s.captura?e.jsx("button",{className:"btn btn-pink text-white btn-sm w-100",onClick:()=>{f()},children:"Quitar Captura"}):e.jsx("button",{className:"btn btn-primary btn-sm w-100",onClick:h,disabled:r,children:"Marcar Capturado"})})}),t&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog ",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header  ",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsxs("h5",{className:"modal-title mx-3",children:[j," "]}),e.jsx("button",{type:"button",className:"btn-close ",onClick:i})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3 mt-3 d-flex align-items-center",children:e.jsxs("div",{className:"position-relative",style:{cursor:"pointer"},children:[e.jsx("img",{src:s.base64?s.base64.trim():"",alt:s.nombre_apellido||"Imagen no disponible",className:"img-fluid rounded-circle shadow-sm",style:{width:"100px",height:"auto",objectFit:"cover"}}),e.jsx("div",{className:"position-absolute bottom-0 start-50 translate-middle-x bg-secondary text-white text-center w-100 rounded-bottom small",style:{opacity:.8},children:e.jsx("span",{children:"Capturado  👮 "})})]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end ",children:["Datos Personales ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"form-floating mb-2",children:[e.jsx("input",{className:"form-control border-0 border text-capitalize",value:s.nombre_apellido,disabled:!0}),e.jsx("label",{className:"badgefw-semibold opacity-75",children:"Nombre y Apellido"})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2 ",children:[e.jsx("input",{className:"form-control border-0 border",value:s.documento,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Documento"})]})}),e.jsx("div",{className:"col",children:e.jsxs("div",{className:"form-floating mb-2 ",children:[e.jsx("input",{className:"form-control border-0 border text-capitalize",value:s.sexo,disabled:!0}),e.jsx("label",{className:"fw-semibold opacity-75",children:"Sexo"})]})})]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 justify-content-end mt-4 ",children:[e.jsx("small",{className:"spinner-grow spinner-grow-sm text-secondaryM"}),j," ",e.jsx("i",{className:"bi bi-files"})]}),e.jsx("hr",{className:"border border-secondaryM border-1 opacity-75"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Autor / Entidad que realizó la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:x,onChange:v=>m(v.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Breve relato de la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:d,onChange:v=>g(v.target.value)})]})]}),e.jsxs("p",{className:"text-primary bg-blueW rounded my-2 p-1",children:[e.jsx("i",{className:"bi bi-exclamation-triangle titilar mx-2 fs-4"})," ¿Estás seguro que deseas realizar el cambio?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:i,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary",onClick:b,disabled:!x||!d||r,children:j})]})]})})}),t&&e.jsx("div",{className:"modal-backdrop fade show"})]})},_r=({personas:s,selectedDocs:l,toggleSelectDoc:t,toggleSelectAll:n,getPrioridadLabel:i,fetchPersonas:r,isFiltered:o,color:d,prioridad:g})=>e.jsx("div",{className:"table-responsive-sm mt-5 ",children:e.jsxs("table",{className:"table table-striped table-hover  text-center small ",children:[e.jsx("thead",{className:"table-primary",children:e.jsxs("tr",{className:"bg-light",children:[!o&&e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:l.length===s.length,onChange:n})}),e.jsx("th",{}),e.jsx("th",{className:"d-none d-sm-table-cell ",children:"Entidad"}),e.jsx("th",{className:"d-none d-sm-table-cell",children:"DNI"}),g===5?e.jsx("th",{className:"d-none d-sm-table-cell",children:"Fecha"}):null,e.jsx("th",{className:"d-none d-sm-table-cell",children:"Prioridad"}),g===5?e.jsx("th",{}):null,e.jsx("th",{})]})}),e.jsx("tbody",{children:s.map(x=>{var m;return e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{className:x.captura?"bg-redW":"",children:e.jsx("input",{type:"checkbox",checked:l.includes(x.id),onChange:()=>t(x.id)})}),e.jsx("td",{className:x.captura?"bg-redW ":"",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("img",{src:((m=x.base64)==null?void 0:m.trim())||$e,alt:x.nombre_apellido,className:"img-fluid rounded-circle me-2",style:{width:"40px",height:"40px",objectFit:"cover"}}),e.jsx("span",{className:"text-capitalize d-inline-block text-truncate",children:x.nombre_apellido})]})}),e.jsx("td",{className:`d-none d-sm-table-cell text-dark ${x.captura?"bg-redW":d}`,children:x.entidad}),e.jsx("td",{className:x.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:x.documento}),g===5?e.jsx("th",{className:x.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:x.date}):null,e.jsx("td",{className:x.captura?"bg-redW d-none d-sm-table-cell":"d-none d-sm-table-cell",children:x.captura?e.jsx("span",{className:"badge bg-dark",children:"Capturado 👮"}):i(x.prioridad)}),g===5?e.jsx(kr,{data1:x,data2:r}):null,e.jsx("td",{className:x.captura?"bg-redW":"",children:e.jsx(ba,{data1:x,data2:r})})]},x.id)})})]})}),Er=s=>{switch(Number(s)){case 1:return e.jsx("span",{className:"badge bg-teal",children:"Normal"});case 2:return e.jsx("span",{className:"badge bg-primary",children:"Paradero 🔎"});case 3:return e.jsx("span",{className:"badge bg-danger titilar",children:"Evadido 🚨"});case 4:return e.jsx("span",{className:"badge bg-orangeDb",children:"Prioritaria ⭐"});case 5:return e.jsx("span",{className:"badge bg-teal",children:"Buscados SF 👮🏻‍♂️"});default:return e.jsx("span",{className:"badge bg-dark",children:"Desconocida"})}},Fr=s=>{const[l,t]=a.useState([]),[n,i]=a.useState(!0),r=W(D,"db_buscados"),o=async()=>{i(!0);try{let g=(await re(r)).docs.map(x=>({...x.data(),id:x.id}));g=g.filter(x=>x.prioridad===s),t(g)}catch(d){console.error("Error al obtener personas: ",d)}finally{i(!1)}};return a.useEffect(()=>{o()},[]),{personas:l,loading:n,fetchPersonas:o}},Dr=s=>{const[l,t]=a.useState([]);return{selectedDocs:l,setSelectedDocs:t,toggleSelectDoc:r=>{t(o=>o.includes(r)?o.filter(d=>d!==r):[...o,r])},toggleSelectAll:()=>{if(s&&s.length>0)if(l.length===s.length)t([]);else{const r=s.map(o=>o.id);t(r)}}}},Ar=({alertaFilter:s,setAlertaFilter:l})=>e.jsxs("div",{className:"form-floating mb-3",children:[e.jsxs("select",{disabled:!0,className:"form-select shadow-sm","aria-label":"Floating label select example",value:s,onChange:t=>l(t.target.value),children:[e.jsx("option",{value:"",children:"Todos los Estados"}),e.jsx("option",{value:"capturado",children:"Capturado"}),e.jsx("option",{value:"evadido",children:"Evadido"})]}),e.jsx("label",{children:"Seleccione un Estado"})]}),Mr=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1);a.useState("");const[o,d]=a.useState(!1),[g,x]=a.useState(""),[m,j]=a.useState(""),u=()=>r(!0),p=()=>r(!1),c=()=>{n([])},h=(()=>{const v=localStorage.getItem("user");return v?JSON.parse(v):null})(),f=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas dar por CAPTURADOS 👮 a este grupo personas ?"))){d(!0);try{const S=l.filter(k=>s.includes(k.id)).map(async k=>{const y=B(D,"db_buscados",k.id),w=new Date,C=`${w.getDate().toString().padStart(2,"0")}/${(w.getMonth()+1).toString().padStart(2,"0")}/${w.getFullYear().toString().slice(-2)}`;await le(y,{...k,captura:!0,capturas_informacion_estados:[...k.capturas_informacion_estados||[],{captura_motivo:"informar captura",captura_informa_usuario:h.email,captura_fecha:C,captura_autor:m,captura_descripcion:g}]})});await Promise.all(S),alert("Capturas Exitosas"),t(),c()}catch(N){console.error("Error al modificar personas:",N),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}d(!1),p()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-primary btn-sm w-100",onClick:u,disabled:o,children:["Marcar Capturas (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsx("h5",{className:"modal-title ms-3 text-dark",children:"Marcar Grupo como Capturado"}),e.jsx("button",{type:"button",className:"btn-close",onClick:p})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(v=>s.includes(v.id)).map(v=>{var N;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(N=v.base64)==null?void 0:N.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),v.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(S=>S.filter(k=>k!==v.id)),title:"Quitar de la selección"})]},v.id)})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Autor / Entidad que realizó la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:m,onChange:v=>j(v.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"mb-2 text-start",children:e.jsx("span",{className:"badge text-bg-primary me-2 ",children:"Breve relato de la captura "})}),e.jsx("input",{className:"form-control bg-blueW2",value:g,onChange:v=>x(v.target.value)})]}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas marcar como capturados estas personas?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:p,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:f,disabled:!m||!g||o,children:o?"Trabajando...":"Confirmar Captura"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Pr=({data1:s,data2:l,dataRefresh:t,setSelectedDocs:n})=>{const[i,r]=a.useState(!1);a.useState("");const[o,d]=a.useState(!1);a.useState(""),a.useState("");const g=()=>r(!0),x=()=>r(!1),m=()=>{n([])},u=(()=>{const c=localStorage.getItem("user");return c?JSON.parse(c):null})(),p=async()=>{if(!(!s||s.length===0||!l||l.length===0||!window.confirm("¿Estás seguro de que deseas QUITAR LOS ESTADOS DE CAPTURA 👮 a estas personas ?"))){d(!0);try{const h=l.filter(f=>s.includes(f.id)).map(async f=>{const v=B(D,"db_buscados",f.id),N=new Date,S=`${N.getDate().toString().padStart(2,"0")}/${(N.getMonth()+1).toString().padStart(2,"0")}/${N.getFullYear().toString().slice(-2)}`;await le(v,{...f,captura:!1,capturas_informacion_estados:[...f.capturas_informacion_estados||[],{captura_motivo:"quitar captura",captura_informa_usuario:u.email,captura_fecha:S}]})});await Promise.all(h),alert("Se quito las capturas de forma Exitosa"),t(),m()}catch(b){console.error("Error al modificar personas:",b),alert("Hubo un error al cambiar el estado de algunas personas - Comunique su error a Tics DG OJO.")}d(!1),x()}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsxs("button",{className:"btn btn-pink btn-sm w-100",onClick:g,disabled:o,children:["Quitar Capturas (",s.length,")"]})}),i&&e.jsx("div",{className:"modal fade show d-block bg-dark",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog",role:"document",children:e.jsxs("div",{className:"modal-content shadow",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{style:{width:"50px",height:"50px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"25px",objectFit:"contain"},className:"rounded-circle p-0 shadow border-dark border",children:"👮"}),e.jsx("h5",{className:"modal-title ms-3 text-dark",children:"Quitar Estado de Capturados a Grupo "}),e.jsx("button",{type:"button",className:"btn-close",onClick:x})]}),e.jsx("hr",{className:"border border-secondaryM border-2 opacity-50 m-0 mb-4"}),e.jsxs("div",{className:"modal-body text-center",children:[e.jsxs("p",{className:"text-primary bg-blueW p-2 rounded-pill  fw-bold",children:["Grupo de  ",s.length," persona",s.length!==1&&"s"," seleccionada",s.length!==1&&"s","."]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 justify-content-center   p-2 rounded mb-3",style:{maxHeight:"200px",overflowY:"auto"},children:l.filter(c=>s.includes(c.id)).map(c=>{var b;return e.jsxs("div",{className:"badge text-dark shadow  d-flex align-items-center p-2 mx-2 position-relative",style:{fontSize:"0.70rem"},children:[e.jsx("img",{src:(b=c.base64)==null?void 0:b.trim(),alt:"",className:"rounded-circle me-2",style:{width:"25px",height:"25px",objectFit:"cover"}}),c.nombre_apellido||"NN",e.jsx("button",{className:"btn-close btn ms-2",style:{fontSize:"0.6rem"},onClick:()=>n(h=>h.filter(f=>f!==c.id)),title:"Quitar de la selección"})]},c.id)})}),e.jsxs("p",{className:"text-primary text-center titilar ",children:[e.jsx("i",{className:"bi bi-exclamation-triangle  mx-2 fs-4 "}),"¿Estás seguro que deseas quitar estado de captura ?"]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:x,children:"Cancelar"}),e.jsx("button",{className:"btn btn-primary text-white",onClick:p,disabled:o,children:o?"Trabajando...":"Quitar Captura"})]})]})})}),i&&e.jsx("div",{className:"modal-backdrop fade show"})]})},Ir=({buscados:s,setBuscados:l,fetchBuscados:t})=>{const[n,i]=a.useState(5),{personas:r,loading:o,fetchPersonas:d}=Fr(n),[g,x]=a.useState([]),[m,j]=a.useState(""),[u,p]=a.useState(""),[c,b]=a.useState(!0),[h,f]=a.useState("asc"),{selectedDocs:v,setSelectedDocs:N,toggleSelectDoc:S,toggleSelectAll:k}=Dr(g||[]),y=m||u,[w,C]=a.useState(""),E=v.every(I=>{const P=r.find(U=>U.id===I);return(P==null?void 0:P.captura)===!0}),F=v.every(I=>{const P=r.find(U=>U.id===I);return(P==null?void 0:P.captura)===!1||(P==null?void 0:P.captura)===void 0}),_=!E&&!F;return a.useEffect(()=>{let I=yr(r,m,u);I=Cr(I,w);const P=wr(I,h);x(P)},[m,r,u,h,w]),e.jsxs("div",{className:"container-lg my-5 text-light",children:[e.jsx("h1",{className:"text-center mb-4 animate__animated animate__bounce mt-sm-0  ",children:"Buscados SF Captura"}),e.jsxs("div",{className:"card my-5  bg-dark bg-opacity-50 p-4 rounded-4",children:[e.jsx("div",{className:"card-header bg-light bg-opacity-75 rounded-2",children:e.jsx("div",{children:"Filtros"})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"row",children:e.jsxs("div",{className:"d-flex justify-content-center flex-wrap gap-3",children:[e.jsx("div",{className:"col-12 col-sm-4 col-md-8 col-lg-4",children:e.jsx(vr,{prioridadFilter:u,setPrioridadFilter:p,personas:r})}),e.jsx("div",{className:"col-12 col-sm-4 col-md-8 col-lg-4",children:e.jsx(Ar,{alertaFilter:w,setAlertaFilter:C})}),e.jsx("div",{className:"col-12 col-sm-3 col-md-8 col-lg-2",children:e.jsx(As,{orden:h,setOrden:f})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{onClick:()=>Sr(j,p,f,C),className:"btn bg-white bg-opacity-25 btn-sm text-light",children:"Limpiar Filtros"})})]})]}),e.jsx("div",{className:"col-12 ",children:e.jsx(Ds,{searchTerm:m,setSearchTerm:j})}),o?e.jsx(oe,{}):e.jsx(e.Fragment,{children:g.length===0?e.jsx("div",{className:"alert alert-warning mt-3",children:"Sin registro encontrado."}):e.jsxs(e.Fragment,{children:[v.length>1&&e.jsxs(e.Fragment,{children:[e.jsxs("small",{className:"d-flex gap-2 mb-2 mt-sm-2 mt-5 justify-content-end titilar",children:["Acciones Grupales ",e.jsx("i",{className:"bi bi-collection"})]}),e.jsx("hr",{}),e.jsxs("div",{className:"d-flex gap-2 justify-content-end mb-2",children:[e.jsx("div",{className:"d-flex gap-2 mb-2 justify-content-end mb-2",children:!_&&e.jsxs(e.Fragment,{children:[E&&e.jsx(Pr,{data1:v,data2:r,dataRefresh:d,setSelectedDocs:N}),F&&e.jsx(Mr,{data1:v,data2:r,dataRefresh:d,setSelectedDocs:N})]})}),e.jsx(pa,{data1:v,data2:r,dataRefresh:d,setSelectedDocs:N}),e.jsx("button",{type:"button",className:"btn-close btn-close-white mt-1","aria-label":"Close",onClick:()=>N([])})]}),c&&e.jsx(Fs,{Date1:v,Date2:r,setSelectedDocs:N,onCerrar:()=>b(!1),color:"blueW2"}),!c&&v.length>1&&e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs("button",{className:"btn fw-semibold",onClick:()=>b(!0),children:[e.jsx("i",{className:"bi bi-info-circle me-2 text-light"})," ",e.jsxs("small",{className:"text-light",children:["Ver Resumen ("," ",e.jsxs("span",{className:"text-ligh",children:[v.length," 🧑"]}),")"]})]})})]}),e.jsx(_r,{personas:g,selectedDocs:v,toggleSelectDoc:S,toggleSelectAll:k,getPrioridadLabel:Er,fetchPersonas:d,isFiltered:y,color:"bg-secondaryM text-white",prioridad:n})]})})]})},Lr=()=>{const[s,l]=a.useState("dashboard"),[t,n]=a.useState([]),[i,r]=a.useState([]),[o,d]=a.useState(!1),g=localStorage.getItem("user");g&&JSON.parse(g);const x=async()=>{try{d(!0);const u=await re(W(D,"db_buscados")),p=[];r(p),u.forEach(c=>{p.push({id:c.id,...c.data()})}),n(p)}catch(u){console.error("Error al obtener los documentos: ",u)}finally{d(!1)}};a.useEffect(()=>{x()},[]),t.filter(u=>u.prioridad===3).length;const m=t.length,j=()=>{switch(s){case"dashboard":return e.jsx(xr,{});case"reportes":return e.jsx(br,{loading:o,buscados:i});case"Desactivados":return e.jsx(Nr,{fetchBuscados:x});case"capturas":return e.jsx(gr,{buscados:i,setBuscados:r,fetchBuscados:x});case"evasiones":return e.jsx(Ir,{buscados:i,setBuscados:r,fetchBuscados:x});default:return e.jsx("p",{children:"Selecciona una opción del menú."})}};return e.jsx("div",{className:"container-lg",children:e.jsxs("div",{className:"row ",children:[e.jsxs("div",{className:"col-12 col-md-4 col-lg-3 ",children:[e.jsx("div",{className:"text-center mb-4 text-light",children:e.jsxs("span",{className:"bg-dark bg-opacity-25 p-2 px-5 fs-6 rounded-5 ",children:[" ",e.jsx("i",{className:"mx-2 bi bi-menu-button-fill "}),"Menú Panel"]})}),e.jsxs("div",{className:"list-group p-3 bg-transparent bg-opacity-50 rounded-4 shadow-lg",children:[e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="dashboard"?"active":""}`,onClick:()=>l("dashboard"),children:"Bienvenido"}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="reportes"?"active":""}`,onClick:()=>l("reportes"),children:"Exportación"}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="capturas"?"active":""}`,onClick:()=>l("capturas"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Buscados SF",o?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-pink rounded-pill",children:["Activas ",m]})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="evasiones"?"active":""}`,onClick:()=>l("evasiones"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Capturas",o?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsxs("span",{className:"badge bg-teal rounded-pill",children:["Activas ",m]})]})}),e.jsx("button",{className:`list-group-item bg-light bg-opacity-50 border-0 list-group-item-action ${s==="Desactivados"?"active":""}`,onClick:()=>l("Desactivados"),children:e.jsxs("li",{className:"d-flex justify-content-between align-items-center",children:["Desactivados",o?e.jsx("div",{className:"spinner-border spinner-border-sm text-purple",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Cargando..."})}):e.jsx("span",{className:"badge bg-cyan rounded-pill",children:"Reactivar"})]})})]})]}),e.jsx("div",{className:"col-12 col-md-8 col-lg-9",children:j()})]})})},$r=()=>{const[s,l]=a.useState(!0),[t,n]=a.useState(()=>localStorage.getItem("bg-gradiante3")||"#f73378");return a.useEffect(()=>{const i=setTimeout(()=>l(!1),1e3);return()=>clearTimeout(i)},[]),e.jsx(e.Fragment,{children:s?e.jsx("div",{className:"min-vh-100 d-flex justify-content-center align-items-center bg-dark text-white",children:e.jsx(oe,{leyendaSet:"Panel de Control"})}):e.jsxs("div",{style:{background:t,transition:"background 0.8s ease-in-out"},children:[e.jsxs("div",{className:"min-vh-100",children:[e.jsx(ke,{}),e.jsxs("div",{className:"my-5",children:["  ",e.jsx(Fe,{Promp:"Panel de Control ",Promp2:"bi bi-code-slash fs-4 "}),"   "]}),e.jsx(Lr,{})]}),e.jsx(we,{}),e.jsx(Ee,{setThemeBackgroundColor:n})]})})},Rr=()=>e.jsx(e.Fragment,{children:e.jsx($r,{})}),zr=()=>e.jsx(Fa,{children:e.jsx(Sa,{children:e.jsx("main",{children:e.jsxs(ka,{children:[e.jsx(fe,{path:"/",element:e.jsx(La,{})}),e.jsx(fe,{path:"/about",element:e.jsx($a,{})}),e.jsx(fe,{path:"/dashboard",element:e.jsx(Se,{children:e.jsx(tt,{})})}),e.jsx(fe,{path:"/galeriacx2",element:e.jsx(Se,{children:e.jsx(dt,{})})}),e.jsx(fe,{path:"/validaringreso10Bis",element:e.jsx(Se,{children:e.jsx(bt,{})})}),e.jsx(fe,{path:"/validarsalida10Bis",element:e.jsx(Se,{children:e.jsx(vt,{})})}),e.jsx(fe,{path:"/notificaciones",element:e.jsx(Se,{children:e.jsx(Ct,{})})}),e.jsx(fe,{path:"/FormularioPageDev2",element:e.jsx(Se,{children:e.jsx(Et,{})})}),e.jsx(fe,{path:"/FormularioVehiculo",element:e.jsx(Se,{children:e.jsx(_l,{})})}),e.jsx(fe,{path:"/Formulariobuscados",element:e.jsx(Se,{children:e.jsx(Ll,{})})}),e.jsx(fe,{path:"/notificaionesNew",element:e.jsx(Se,{children:e.jsx(ur,{})})}),e.jsx(fe,{path:"/GaleriaBuscados",element:e.jsx(Se,{children:e.jsx(ql,{})})}),e.jsx(fe,{path:"/GaleriaVehiculos",element:e.jsx(Se,{children:e.jsx(Dl,{})})}),e.jsx(fe,{path:"/panelcontrol10dev2",element:e.jsx(Se,{children:e.jsx(Bi,{})})}),e.jsx(fe,{path:"/panelcontroldev2",element:e.jsx(Se,{children:e.jsx(li,{})})}),e.jsx(fe,{path:"/panelcontrolvehiculos",element:e.jsx(Se,{children:e.jsx(tr,{})})}),e.jsx(fe,{path:"/panelcontrolbuscados",element:e.jsx(Se,{children:e.jsx(Rr,{})})}),e.jsx(fe,{path:"/informes",element:e.jsx(Se,{children:e.jsx(al,{})})}),e.jsx(fe,{path:"/informespost",element:e.jsx(Se,{children:e.jsx(xl,{})})}),e.jsx(fe,{path:"/denuncia",element:e.jsx(Se,{children:e.jsx(Gi,{})})}),e.jsx(fe,{path:"/denunciasimple",element:e.jsx(Se,{children:e.jsx(Cl,{})})}),e.jsx(fe,{path:"*",element:e.jsx(Ra,{})})]})})})});_a(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(zr,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(s=>console.log("SW registrado:",s)).catch(s=>console.error("Error SW:",s))});
